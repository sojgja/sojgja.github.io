{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"blog/","title":"Blog","text":""},{"location":"blog/setup/","title":"Setup","text":"<ol> <li>t\u1ea1o repository tr\u00ean github sojgja.github.io v\u00e0 t\u1ea1o branch main \u0111\u1ec3 deploy</li> <li>t\u1ea1o folders www</li> <li>clone mkdocs-material v\u1ec1 th\u01b0 m\u1ee5c www</li> <li>copy to\u00e0n b\u1ed9 file v\u00e0 folder trong mkdocs-material ra th\u01b0 m\u1ee5c g\u1ed1c</li> <li>v\u00e0o \u0111\u01b0\u1eddng d\u1eabn v\u00e0 thi\u1ebft l\u1eadp     https://github.com/sojgja/sojgja.github.io/settings/actions     ch\u1ecdn Read and write permissions</li> <li>v\u00e0o \u0111\u01b0\u1eddng d\u1eabn v\u00e0 thi\u1ebft l\u1eadp     https://github.com/sojgja/sojgja.github.io/settings/pages     ch\u1ecdn deploy from a branch     ch\u1ecdn gh-pages</li> <li>ch\u1ec9nh s\u1eeda c\u00e1c file c\u1ea7n thi\u1ebft      https://github.com/sojgja/sojgja.github.io/blob/dev/.github/workflows/ci.yml<ul> <li>run: pip install mkdocs-material mkdocs-minify-plugin</li> </ul> </li> <li>push code l\u00ean nh\u00e1nh main \u0111\u1ec3 th\u1ef1c hi\u1ec7n deploy</li> </ol>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/","title":"Backtesting Trading Strategies v\u1edbi Python","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a algorithmic trading v\u00e0 quantitative finance, backtesting \u0111\u00f3ng vai tr\u00f2 nh\u01b0 m\u1ed9t c\u00e1nh c\u1eeda quan tr\u1ecdng gi\u00fap c\u00e1c nh\u00e0 giao d\u1ecbch v\u00e0 qu\u1ef9 \u0111\u1ea7u t\u01b0 \u0111\u00e1nh gi\u00e1 t\u00ednh kh\u1ea3 thi c\u1ee7a m\u1ed9t chi\u1ebfn l\u01b0\u1ee3c trading tr\u01b0\u1edbc khi \u0111\u1ed1i m\u1eb7t v\u1edbi r\u1ee7i ro th\u1ef1c t\u1ebf c\u1ee7a th\u1ecb tr\u01b0\u1eddng. Backtesting kh\u00f4ng ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 vi\u1ec7c ch\u1ea1y m\u1ed9t chi\u1ebfn l\u01b0\u1ee3c tr\u00ean d\u1eef li\u1ec7u l\u1ecbch s\u1eed \u0111\u1ec3 xem n\u00f3 c\u00f3 l\u00e3i hay kh\u00f4ng, m\u00e0 l\u00e0 m\u1ed9t quy tr\u00ecnh khoa h\u1ecdc v\u00e0 to\u00e0n di\u1ec7n \u0111\u1ec3 validate, optimize, v\u00e0 \u0111\u00e1nh gi\u00e1 r\u1ee7i ro c\u1ee7a m\u1ed9t trading strategy. Qua vi\u1ec7c m\u00f4 ph\u1ecfng c\u00e1c \u0111i\u1ec1u ki\u1ec7n th\u1ecb tr\u01b0\u1eddng trong qu\u00e1 kh\u1ee9, ch\u00fang ta c\u00f3 th\u1ec3 hi\u1ec3u \u0111\u01b0\u1ee3c c\u00e1ch chi\u1ebfn l\u01b0\u1ee3c c\u1ee7a m\u00ecnh s\u1ebd ph\u1ea3n \u1ee9ng v\u1edbi c\u00e1c bi\u1ebfn \u0111\u1ed9ng gi\u00e1 kh\u00e1c nhau, t\u1eeb nh\u1eefng xu h\u01b0\u1edbng m\u1ea1nh m\u1ebd \u0111\u1ebfn nh\u1eefng giai \u0111o\u1ea1n sideways market \u0111\u1ea7y th\u00e1ch th\u1ee9c.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng m\u1ed9t backtesting engine ho\u00e0n ch\u1ec9nh t\u1eeb \u0111\u1ea7u, s\u1eed d\u1ee5ng Python - ng\u00f4n ng\u1eef \u0111\u01b0\u1ee3c \u01b0a chu\u1ed9ng nh\u1ea5t trong l\u0129nh v\u1ef1c quantitative trading nh\u1edd v\u00e0o s\u1ef1 linh ho\u1ea1t, hi\u1ec7u n\u0103ng cao, v\u00e0 h\u1ec7 sinh th\u00e1i th\u01b0 vi\u1ec7n phong ph\u00fa. Engine m\u00e0 ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng s\u1ebd kh\u00f4ng ch\u1ec9 c\u00f3 kh\u1ea3 n\u0103ng m\u00f4 ph\u1ecfng c\u00e1c giao d\u1ecbch m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c, m\u00e0 c\u00f2n t\u00edch h\u1ee3p c\u00e1c c\u00f4ng c\u1ee5 ph\u00e2n t\u00edch hi\u1ec7u su\u1ea5t nh\u01b0 Sharpe Ratio, Maximum Drawdown, Win Rate, Profit Factor, v\u00e0 nhi\u1ec1u metrics quan tr\u1ecdng kh\u00e1c. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch x\u1eed l\u00fd d\u1eef li\u1ec7u l\u1ecbch s\u1eed t\u1eeb nhi\u1ec1u ngu\u1ed3n kh\u00e1c nhau, implement c\u00e1c ch\u1ec9 b\u00e1o k\u1ef9 thu\u1eadt ph\u1ed5 bi\u1ebfn, qu\u1ea3n l\u00fd portfolio v\u00e0 risk management, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 tr\u00e1nh c\u00e1c l\u1ed7i ph\u1ed5 bi\u1ebfn trong backtesting nh\u01b0 look-ahead bias, survivorship bias, v\u00e0 overfitting.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c thi\u1ebft k\u1ebf ki\u1ebfn tr\u00fac c\u1ee7a backtesting engine, x\u00e2y d\u1ef1ng data loader \u0111\u1ec3 import d\u1eef li\u1ec7u t\u1eeb c\u00e1c ngu\u1ed3n kh\u00e1c nhau, implement c\u00e1c strategy base class v\u00e0 concrete strategies, \u0111\u1ebfn vi\u1ec7c t\u00ednh to\u00e1n c\u00e1c metrics hi\u1ec7u su\u1ea5t v\u00e0 visualize k\u1ebft qu\u1ea3. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c best practices trong backtesting, c\u00e1ch x\u1eed l\u00fd transaction costs v\u00e0 slippage, v\u00e0 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o k\u1ebft qu\u1ea3 backtest g\u1ea7n v\u1edbi th\u1ef1c t\u1ebf nh\u1ea5t c\u00f3 th\u1ec3. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t c\u00f4ng c\u1ee5 m\u1ea1nh m\u1ebd \u0111\u1ec3 \u0111\u00e1nh gi\u00e1 v\u00e0 c\u1ea3i thi\u1ec7n c\u00e1c trading strategies c\u1ee7a m\u00ecnh m\u1ed9t c\u00e1ch khoa h\u1ecdc v\u00e0 c\u00f3 h\u1ec7 th\u1ed1ng.</p> <p></p>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#tai-sao-can-backtesting","title":"T\u1ea1i sao c\u1ea7n Backtesting?","text":"<ol> <li>Validate Strategy: Ki\u1ec3m tra xem strategy c\u00f3 ho\u1ea1t \u0111\u1ed9ng kh\u00f4ng</li> <li>Risk Assessment: \u0110\u00e1nh gi\u00e1 r\u1ee7i ro v\u00e0 drawdown</li> <li>Optimization: T\u00ecm parameters t\u1ed1t nh\u1ea5t</li> <li>Confidence: T\u0103ng t\u1ef1 tin tr\u01b0\u1edbc khi trade th\u1eadt</li> </ol>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#kien-truc-backtesting-engine","title":"Ki\u1ebfn tr\u00fac Backtesting Engine","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Historical   \u2502\n\u2502 Data         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Data Loader        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Strategy Engine    \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Portfolio Manager  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Performance        \u2502\n\u2502  Analyzer           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#buoc-1-data-loader","title":"B\u01b0\u1edbc 1: Data Loader","text":"<pre><code># backtesting/data_loader.py\nimport pandas as pd\nimport yfinance as yf\nfrom typing import Optional\nimport logging\n\nclass DataLoader:\n    def __init__(self):\n        self.logger = logging.getLogger(__name__)\n\n    def load_from_yahoo(self, symbol: str, period: str = \"1y\") -&gt; Optional[pd.DataFrame]:\n        \"\"\"Load data t\u1eeb Yahoo Finance\"\"\"\n        try:\n            ticker = yf.Ticker(symbol)\n            df = ticker.history(period=period)\n\n            if df.empty:\n                return None\n\n            # Rename columns\n            df.columns = [col.lower() for col in df.columns]\n            df.reset_index(inplace=True)\n\n            return df\n        except Exception as e:\n            self.logger.error(f\"Error loading data: {e}\")\n            return None\n\n    def load_from_csv(self, filepath: str) -&gt; Optional[pd.DataFrame]:\n        \"\"\"Load data t\u1eeb CSV file\"\"\"\n        try:\n            df = pd.read_csv(filepath)\n\n            # Ensure required columns\n            required_cols = ['date', 'open', 'high', 'low', 'close', 'volume']\n            if not all(col in df.columns for col in required_cols):\n                raise ValueError(f\"Missing required columns. Need: {required_cols}\")\n\n            df['date'] = pd.to_datetime(df['date'])\n            df.set_index('date', inplace=True)\n\n            return df\n        except Exception as e:\n            self.logger.error(f\"Error loading CSV: {e}\")\n            return None\n\n    def load_from_binance(self, symbol: str, interval: str = '1h', limit: int = 1000):\n        \"\"\"Load data t\u1eeb Binance API\"\"\"\n        from binance.client import Client\n\n        try:\n            client = Client()\n            klines = client.get_historical_klines(\n                symbol, interval, limit=limit\n            )\n\n            df = pd.DataFrame(klines, columns=[\n                'timestamp', 'open', 'high', 'low', 'close', 'volume',\n                'close_time', 'quote_volume', 'trades', 'taker_buy_base',\n                'taker_buy_quote', 'ignore'\n            ])\n\n            # Convert to numeric\n            numeric_cols = ['open', 'high', 'low', 'close', 'volume']\n            for col in numeric_cols:\n                df[col] = pd.to_numeric(df[col])\n\n            # Convert timestamp\n            df['date'] = pd.to_datetime(df['timestamp'], unit='ms')\n            df.set_index('date', inplace=True)\n\n            return df[['open', 'high', 'low', 'close', 'volume']]\n        except Exception as e:\n            self.logger.error(f\"Error loading from Binance: {e}\")\n            return None\n</code></pre>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#buoc-2-strategy-base-class","title":"B\u01b0\u1edbc 2: Strategy Base Class","text":"<pre><code># backtesting/strategy.py\nfrom abc import ABC, abstractmethod\nimport pandas as pd\nfrom typing import Optional, Dict\nfrom dataclasses import dataclass\n\n@dataclass\nclass Signal:\n    action: str  # 'BUY', 'SELL', 'HOLD'\n    strength: float  # 0-1\n    price: float\n    timestamp: pd.Timestamp\n\nclass BaseStrategy(ABC):\n    \"\"\"Base class cho t\u1ea5t c\u1ea3 strategies\"\"\"\n\n    def __init__(self, name: str):\n        self.name = name\n        self.parameters = {}\n\n    @abstractmethod\n    def generate_signals(self, data: pd.DataFrame) -&gt; pd.DataFrame:\n        \"\"\"Generate trading signals t\u1eeb data\"\"\"\n        pass\n\n    def calculate_indicators(self, data: pd.DataFrame) -&gt; pd.DataFrame:\n        \"\"\"Calculate technical indicators\"\"\"\n        return data\n</code></pre>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#buoc-3-implement-moving-average-strategy","title":"B\u01b0\u1edbc 3: Implement Moving Average Strategy","text":"<pre><code># backtesting/strategies/ma_strategy.py\nfrom backtesting.strategy import BaseStrategy\nimport pandas as pd\nimport numpy as np\n\nclass MovingAverageStrategy(BaseStrategy):\n    def __init__(self, short_window=10, long_window=30):\n        super().__init__(\"Moving Average Crossover\")\n        self.short_window = short_window\n        self.long_window = long_window\n\n    def calculate_indicators(self, data: pd.DataFrame) -&gt; pd.DataFrame:\n        \"\"\"Calculate moving averages\"\"\"\n        df = data.copy()\n\n        df['sma_short'] = df['close'].rolling(window=self.short_window).mean()\n        df['sma_long'] = df['close'].rolling(window=self.long_window).mean()\n\n        # Calculate RSI\n        delta = df['close'].diff()\n        gain = (delta.where(delta &gt; 0, 0)).rolling(window=14).mean()\n        loss = (-delta.where(delta &lt; 0, 0)).rolling(window=14).mean()\n        rs = gain / loss\n        df['rsi'] = 100 - (100 / (1 + rs))\n\n        return df\n\n    def generate_signals(self, data: pd.DataFrame) -&gt; pd.DataFrame:\n        \"\"\"Generate buy/sell signals\"\"\"\n        df = self.calculate_indicators(data.copy())\n        df['signal'] = 0\n        df['position'] = 0\n\n        # Golden Cross: Buy signal\n        df.loc[\n            (df['sma_short'] &gt; df['sma_long']) &amp; \n            (df['sma_short'].shift(1) &lt;= df['sma_long'].shift(1)) &amp;\n            (df['rsi'] &lt; 70),\n            'signal'\n        ] = 1\n\n        # Death Cross: Sell signal\n        df.loc[\n            (df['sma_short'] &lt; df['sma_long']) &amp; \n            (df['sma_short'].shift(1) &gt;= df['sma_long'].shift(1)) &amp;\n            (df['rsi'] &gt; 30),\n            'signal'\n        ] = -1\n\n        # Forward fill position\n        df['position'] = df['signal'].replace(0, np.nan).ffill().fillna(0)\n\n        return df\n</code></pre>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#buoc-4-portfolio-manager","title":"B\u01b0\u1edbc 4: Portfolio Manager","text":"<pre><code># backtesting/portfolio.py\nimport pandas as pd\nimport numpy as np\nfrom typing import Dict, List\nfrom dataclasses import dataclass\n\n@dataclass\nclass Trade:\n    entry_time: pd.Timestamp\n    exit_time: Optional[pd.Timestamp]\n    entry_price: float\n    exit_price: Optional[float]\n    quantity: float\n    side: str  # 'LONG' or 'SHORT'\n    pnl: Optional[float] = None\n    pnl_pct: Optional[float] = None\n\nclass Portfolio:\n    def __init__(self, initial_capital: float = 10000):\n        self.initial_capital = initial_capital\n        self.cash = initial_capital\n        self.positions = {}  # {symbol: quantity}\n        self.trades: List[Trade] = []\n        self.equity_curve = []\n        self.current_trade: Optional[Trade] = None\n\n    def execute_trade(self, signal: int, price: float, timestamp: pd.Timestamp, \n                     symbol: str = 'ASSET', position_size: float = 0.1):\n        \"\"\"Execute a trade based on signal\"\"\"\n\n        # Close existing position if opposite signal\n        if self.current_trade:\n            if (signal == 1 and self.current_trade.side == 'SHORT') or \\\n               (signal == -1 and self.current_trade.side == 'LONG'):\n                self.close_position(price, timestamp)\n\n        # Open new position\n        if signal == 1:  # Buy signal\n            if not self.current_trade or self.current_trade.side != 'LONG':\n                self.open_long(price, timestamp, symbol, position_size)\n        elif signal == -1:  # Sell signal\n            if not self.current_trade or self.current_trade.side != 'SHORT':\n                self.open_short(price, timestamp, symbol, position_size)\n\n    def open_long(self, price: float, timestamp: pd.Timestamp, \n                 symbol: str, position_size: float):\n        \"\"\"Open long position\"\"\"\n        investment = self.cash * position_size\n        quantity = investment / price\n\n        if investment &lt;= self.cash:\n            self.cash -= investment\n            self.positions[symbol] = quantity\n\n            self.current_trade = Trade(\n                entry_time=timestamp,\n                exit_time=None,\n                entry_price=price,\n                exit_price=None,\n                quantity=quantity,\n                side='LONG'\n            )\n\n    def open_short(self, price: float, timestamp: pd.Timestamp,\n                  symbol: str, position_size: float):\n        \"\"\"Open short position (simplified - assumes we can short)\"\"\"\n        investment = self.cash * position_size\n        quantity = investment / price\n\n        # For short, we \"borrow\" and sell\n        self.cash += investment\n        self.positions[symbol] = -quantity\n\n        self.current_trade = Trade(\n            entry_time=timestamp,\n            exit_time=None,\n            entry_price=price,\n            exit_price=None,\n            quantity=quantity,\n            side='SHORT'\n        )\n\n    def close_position(self, price: float, timestamp: pd.Timestamp):\n        \"\"\"Close current position\"\"\"\n        if not self.current_trade:\n            return\n\n        self.current_trade.exit_time = timestamp\n        self.current_trade.exit_price = price\n\n        # Calculate PnL\n        if self.current_trade.side == 'LONG':\n            pnl = (price - self.current_trade.entry_price) * self.current_trade.quantity\n            self.cash += price * self.current_trade.quantity\n        else:  # SHORT\n            pnl = (self.current_trade.entry_price - price) * self.current_trade.quantity\n            self.cash -= price * self.current_trade.quantity\n\n        self.current_trade.pnl = pnl\n        self.current_trade.pnl_pct = (\n            (price - self.current_trade.entry_price) / self.current_trade.entry_price * 100\n            if self.current_trade.side == 'LONG'\n            else (self.current_trade.entry_price - price) / self.current_trade.entry_price * 100\n        )\n\n        self.trades.append(self.current_trade)\n        self.current_trade = None\n\n    def get_portfolio_value(self, current_price: float) -&gt; float:\n        \"\"\"Calculate total portfolio value\"\"\"\n        position_value = sum(\n            qty * current_price for qty in self.positions.values()\n        )\n        return self.cash + position_value\n\n    def update_equity_curve(self, current_price: float):\n        \"\"\"Update equity curve\"\"\"\n        total_value = self.get_portfolio_value(current_price)\n        self.equity_curve.append(total_value)\n</code></pre>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#buoc-5-backtesting-engine","title":"B\u01b0\u1edbc 5: Backtesting Engine","text":"<pre><code># backtesting/engine.py\nimport pandas as pd\nfrom backtesting.portfolio import Portfolio\nfrom backtesting.strategy import BaseStrategy\nfrom typing import Dict\nimport logging\n\nclass BacktestEngine:\n    def __init__(self, strategy: BaseStrategy, initial_capital: float = 10000):\n        self.strategy = strategy\n        self.portfolio = Portfolio(initial_capital)\n        self.logger = logging.getLogger(__name__)\n\n    def run(self, data: pd.DataFrame, position_size: float = 0.1) -&gt; Dict:\n        \"\"\"Run backtest\"\"\"\n        self.logger.info(f\"Starting backtest with {self.strategy.name}\")\n\n        # Generate signals\n        df = self.strategy.generate_signals(data.copy())\n\n        # Run simulation\n        for idx, row in df.iterrows():\n            signal = row['signal']\n            price = row['close']\n\n            # Update equity curve\n            self.portfolio.update_equity_curve(price)\n\n            # Execute trade if signal\n            if signal != 0:\n                self.portfolio.execute_trade(\n                    signal, price, idx, \n                    position_size=position_size\n                )\n\n        # Close any open positions at the end\n        if self.portfolio.current_trade:\n            final_price = df.iloc[-1]['close']\n            self.portfolio.close_position(final_price, df.index[-1])\n\n        # Calculate performance metrics\n        results = self.calculate_performance(df)\n\n        return results\n\n    def calculate_performance(self, data: pd.DataFrame) -&gt; Dict:\n        \"\"\"Calculate performance metrics\"\"\"\n        equity_series = pd.Series(self.portfolio.equity_curve, index=data.index)\n\n        # Total return\n        total_return = (\n            (equity_series.iloc[-1] - self.portfolio.initial_capital) / \n            self.portfolio.initial_capital * 100\n        )\n\n        # Calculate returns\n        returns = equity_series.pct_change().dropna()\n\n        # Sharpe ratio (assuming 252 trading days)\n        sharpe_ratio = (returns.mean() / returns.std()) * (252 ** 0.5) if returns.std() &gt; 0 else 0\n\n        # Max drawdown\n        cumulative = (1 + returns).cumprod()\n        running_max = cumulative.expanding().max()\n        drawdown = (cumulative - running_max) / running_max\n        max_drawdown = drawdown.min() * 100\n\n        # Win rate\n        winning_trades = [t for t in self.portfolio.trades if t.pnl and t.pnl &gt; 0]\n        win_rate = len(winning_trades) / len(self.portfolio.trades) * 100 if self.portfolio.trades else 0\n\n        # Average win/loss\n        wins = [t.pnl for t in winning_trades if t.pnl]\n        losses = [t.pnl for t in self.portfolio.trades if t.pnl and t.pnl &lt; 0]\n\n        avg_win = sum(wins) / len(wins) if wins else 0\n        avg_loss = sum(losses) / len(losses) if losses else 0\n        profit_factor = abs(sum(wins) / sum(losses)) if losses and sum(losses) != 0 else 0\n\n        return {\n            'strategy': self.strategy.name,\n            'total_return': total_return,\n            'sharpe_ratio': sharpe_ratio,\n            'max_drawdown': max_drawdown,\n            'win_rate': win_rate,\n            'total_trades': len(self.portfolio.trades),\n            'avg_win': avg_win,\n            'avg_loss': avg_loss,\n            'profit_factor': profit_factor,\n            'final_value': equity_series.iloc[-1],\n            'equity_curve': equity_series,\n            'trades': self.portfolio.trades\n        }\n\n# Usage\nif __name__ == '__main__':\n    from backtesting.data_loader import DataLoader\n    from backtesting.strategies.ma_strategy import MovingAverageStrategy\n\n    # Load data\n    loader = DataLoader()\n    data = loader.load_from_yahoo('BTC-USD', period='1y')\n\n    if data is not None:\n        # Create strategy\n        strategy = MovingAverageStrategy(short_window=10, long_window=30)\n\n        # Run backtest\n        engine = BacktestEngine(strategy, initial_capital=10000)\n        results = engine.run(data)\n\n        print(f\"Strategy: {results['strategy']}\")\n        print(f\"Total Return: {results['total_return']:.2f}%\")\n        print(f\"Sharpe Ratio: {results['sharpe_ratio']:.2f}\")\n        print(f\"Max Drawdown: {results['max_drawdown']:.2f}%\")\n        print(f\"Win Rate: {results['win_rate']:.2f}%\")\n        print(f\"Total Trades: {results['total_trades']}\")\n</code></pre>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#visualization","title":"Visualization","text":"<pre><code># backtesting/visualizer.py\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\ndef plot_backtest_results(results: Dict, data: pd.DataFrame):\n    \"\"\"Visualize backtest results\"\"\"\n    fig, axes = plt.subplots(3, 1, figsize=(12, 10))\n\n    # Price and signals\n    axes[0].plot(data.index, data['close'], label='Price', alpha=0.7)\n\n    buy_signals = data[data['signal'] == 1]\n    sell_signals = data[data['signal'] == -1]\n\n    axes[0].scatter(buy_signals.index, buy_signals['close'], \n                   color='green', marker='^', s=100, label='Buy')\n    axes[0].scatter(sell_signals.index, sell_signals['close'],\n                   color='red', marker='v', s=100, label='Sell')\n    axes[0].set_title('Price and Trading Signals')\n    axes[0].legend()\n    axes[0].grid(True)\n\n    # Equity curve\n    equity = results['equity_curve']\n    axes[1].plot(equity.index, equity.values, label='Equity Curve')\n    axes[1].axhline(y=results['initial_capital'], color='r', \n                   linestyle='--', label='Initial Capital')\n    axes[1].set_title('Equity Curve')\n    axes[1].legend()\n    axes[1].grid(True)\n\n    # Drawdown\n    cumulative = (1 + equity.pct_change()).cumprod()\n    running_max = cumulative.expanding().max()\n    drawdown = (cumulative - running_max) / running_max * 100\n\n    axes[2].fill_between(drawdown.index, drawdown.values, 0, \n                        color='red', alpha=0.3)\n    axes[2].set_title('Drawdown')\n    axes[2].set_ylabel('Drawdown %')\n    axes[2].grid(True)\n\n    plt.tight_layout()\n    plt.show()\n</code></pre>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#best-practices","title":"Best Practices","text":"<ol> <li>Survivorship Bias: Ch\u1ec9 test tr\u00ean assets c\u00f2n t\u1ed3n t\u1ea1i</li> <li>Look-ahead Bias: Kh\u00f4ng d\u00f9ng th\u00f4ng tin t\u01b0\u01a1ng lai</li> <li>Transaction Costs: T\u00ednh ph\u00ed giao d\u1ecbch</li> <li>Slippage: Gi\u00e1 th\u1ef1c t\u1ebf kh\u00e1c gi\u00e1 l\u00fd thuy\u1ebft</li> <li>Overfitting: Tr\u00e1nh optimize qu\u00e1 m\u1ee9c</li> </ol>"},{"location":"blog/2025/01/25/backtesting-trading-strategies-v%E1%BB%9Bi-python---t%E1%BB%AB-zero-%C4%91%E1%BA%BFn-hero/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>V\u1edbi backtesting engine n\u00e0y, b\u1ea1n c\u00f3 th\u1ec3: - Test nhi\u1ec1u strategies kh\u00e1c nhau - Optimize parameters - \u0110\u00e1nh gi\u00e1 risk v\u00e0 performance - So s\u00e1nh strategies</p> <p>Trong b\u00e0i ti\u1ebfp theo, ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng optimization framework \u0111\u1ec3 t\u00ecm parameters t\u1ed1t nh\u1ea5t.</p>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/","title":"X\u00e2y d\u1ef1ng Trading Bot v\u1edbi Binance API","text":"<p>Trong th\u1eddi \u0111\u1ea1i c\u1ee7a cryptocurrency v\u00e0 algorithmic trading, vi\u1ec7c t\u1ef1 \u0111\u1ed9ng h\u00f3a qu\u00e1 tr\u00ecnh giao d\u1ecbch \u0111\u00e3 tr\u1edf th\u00e0nh m\u1ed9t xu h\u01b0\u1edbng kh\u00f4ng th\u1ec3 ph\u1ee7 nh\u1eadn. Trading bot kh\u00f4ng ch\u1ec9 gi\u00fap ch\u00fang ta lo\u1ea1i b\u1ecf nh\u1eefng quy\u1ebft \u0111\u1ecbnh c\u1ea3m t\u00ednh - nguy\u00ean nh\u00e2n ch\u00ednh d\u1eabn \u0111\u1ebfn thua l\u1ed7 trong trading, m\u00e0 c\u00f2n cho ph\u00e9p ch\u00fang ta th\u1ef1c hi\u1ec7n c\u00e1c chi\u1ebfn l\u01b0\u1ee3c giao d\u1ecbch m\u1ed9t c\u00e1ch nh\u1ea5t qu\u00e1n, 24/7, m\u00e0 kh\u00f4ng c\u1ea7n ph\u1ea3i ng\u1ed3i tr\u01b0\u1edbc m\u00e0n h\u00ecnh li\u00ean t\u1ee5c. Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng m\u1ed9t trading bot ho\u00e0n ch\u1ec9nh t\u1eeb \u0111\u1ea7u \u0111\u1ebfn cu\u1ed1i, s\u1eed d\u1ee5ng Binance API - m\u1ed9t trong nh\u1eefng s\u00e0n giao d\u1ecbch cryptocurrency l\u1edbn nh\u1ea5t v\u00e0 uy t\u00edn nh\u1ea5t th\u1ebf gi\u1edbi v\u1edbi h\u01a1n 100 tri\u1ec7u ng\u01b0\u1eddi d\u00f9ng v\u00e0 kh\u1ed1i l\u01b0\u1ee3ng giao d\u1ecbch h\u00e0ng ng\u00e0y l\u00ean \u0111\u1ebfn h\u00e0ng ch\u1ee5c t\u1ef7 USD.</p> <p>Binance kh\u00f4ng ch\u1ec9 n\u1ed5i ti\u1ebfng v\u1edbi thanh kho\u1ea3n kh\u1ed5ng l\u1ed3 v\u00e0 ph\u00ed giao d\u1ecbch c\u1ea1nh tranh, m\u00e0 c\u00f2n cung c\u1ea5p m\u1ed9t API m\u1ea1nh m\u1ebd v\u00e0 \u0111\u01b0\u1ee3c document r\u1ea5t t\u1ed1t, cho ph\u00e9p c\u00e1c nh\u00e0 ph\u00e1t tri\u1ec3n t\u00edch h\u1ee3p s\u00e2u v\u00e0o h\u1ec7 sinh th\u00e1i c\u1ee7a h\u1ecd. Trading bot m\u00e0 ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng s\u1ebd c\u00f3 kh\u1ea3 n\u0103ng theo d\u00f5i th\u1ecb tr\u01b0\u1eddng real-time, ph\u00e2n t\u00edch c\u00e1c ch\u1ec9 b\u00e1o k\u1ef9 thu\u1eadt nh\u01b0 Moving Average, RSI, v\u00e0 Volume Profile, t\u1ef1 \u0111\u1ed9ng t\u1ea1o ra c\u00e1c t\u00edn hi\u1ec7u mua/b\u00e1n d\u1ef1a tr\u00ean chi\u1ebfn l\u01b0\u1ee3c \u0111\u00e3 \u0111\u01b0\u1ee3c \u0111\u1ecbnh ngh\u0129a, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 th\u1ef1c hi\u1ec7n giao d\u1ecbch m\u1ed9t c\u00e1ch t\u1ef1 \u0111\u1ed9ng v\u1edbi risk management \u0111\u01b0\u1ee3c t\u00edch h\u1ee3p s\u1eb5n. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng Python - ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh ph\u1ed5 bi\u1ebfn nh\u1ea5t trong l\u0129nh v\u1ef1c algorithmic trading nh\u1edd v\u00e0o h\u1ec7 sinh th\u00e1i th\u01b0 vi\u1ec7n phong ph\u00fa v\u00e0 c\u1ed9ng \u0111\u1ed3ng h\u1ed7 tr\u1ee3 m\u1ea1nh m\u1ebd.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup m\u00f4i tr\u01b0\u1eddng ph\u00e1t tri\u1ec3n, c\u1ea5u h\u00ecnh k\u1ebft n\u1ed1i v\u1edbi Binance API, x\u00e2y d\u1ef1ng c\u00e1c module x\u1eed l\u00fd d\u1eef li\u1ec7u v\u00e0 ph\u00e2n t\u00edch k\u1ef9 thu\u1eadt, \u0111\u1ebfn vi\u1ec7c implement chi\u1ebfn l\u01b0\u1ee3c trading v\u00e0 qu\u1ea3n l\u00fd r\u1ee7i ro. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch x\u1eed l\u00fd c\u00e1c edge cases, error handling, logging, v\u00e0 best practices \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o bot ho\u1ea1t \u0111\u1ed9ng \u1ed5n \u0111\u1ecbnh v\u00e0 an to\u00e0n. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t trading bot ho\u00e0n ch\u1ec9nh, c\u00f3 th\u1ec3 ch\u1ea1y tr\u00ean testnet \u0111\u1ec3 test tr\u01b0\u1edbc khi tri\u1ec3n khai v\u1edbi ti\u1ec1n th\u1eadt. H\u00e3y c\u00f9ng b\u1eaft \u0111\u1ea7u h\u00e0nh tr\u00ecnh x\u00e2y d\u1ef1ng trading bot chuy\u00ean nghi\u1ec7p n\u00e0y!</p> <p></p>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#tong-quan","title":"T\u1ed5ng quan","text":"<p>Trading bot l\u00e0 m\u1ed9t c\u00f4ng c\u1ee5 m\u1ea1nh m\u1ebd gi\u00fap t\u1ef1 \u0111\u1ed9ng h\u00f3a qu\u00e1 tr\u00ecnh giao d\u1ecbch, lo\u1ea1i b\u1ecf c\u1ea3m x\u00fac v\u00e0 th\u1ef1c hi\u1ec7n c\u00e1c chi\u1ebfn l\u01b0\u1ee3c m\u1ed9t c\u00e1ch nh\u1ea5t qu\u00e1n. V\u1edbi Binance API, ch\u00fang ta c\u00f3 th\u1ec3 truy c\u1eadp v\u00e0o m\u1ed9t trong nh\u1eefng s\u00e0n giao d\u1ecbch l\u1edbn nh\u1ea5t th\u1ebf gi\u1edbi v\u1edbi thanh kho\u1ea3n kh\u1ed5ng l\u1ed3 v\u00e0 ph\u00ed giao d\u1ecbch c\u1ea1nh tranh.</p>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#yeu-cau","title":"Y\u00eau c\u1ea7u","text":"<ul> <li>Python 3.8+</li> <li>T\u00e0i kho\u1ea3n Binance (testnet ho\u1eb7c real)</li> <li>API Key v\u00e0 Secret Key t\u1eeb Binance</li> <li>Ki\u1ebfn th\u1ee9c c\u01a1 b\u1ea3n v\u1ec1 Python v\u00e0 trading</li> </ul>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#buoc-1-setup-moi-truong","title":"B\u01b0\u1edbc 1: Setup m\u00f4i tr\u01b0\u1eddng","text":"<p>\u0110\u1ea7u ti\u00ean, ch\u00fang ta c\u1ea7n c\u00e0i \u0111\u1eb7t c\u00e1c th\u01b0 vi\u1ec7n c\u1ea7n thi\u1ebft:</p> <pre><code>pip install python-binance pandas python-dotenv\n</code></pre> <p>T\u1ea1o file <code>.env</code> \u0111\u1ec3 l\u01b0u tr\u1eef API keys:</p> <pre><code>BINANCE_API_KEY=your_api_key_here\nBINANCE_SECRET_KEY=your_secret_key_here\nBINANCE_TESTNET=True\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#buoc-2-tao-cau-truc-project","title":"B\u01b0\u1edbc 2: T\u1ea1o c\u1ea5u tr\u00fac project","text":"<pre><code>trading-bot/\n\u251c\u2500\u2500 config/\n\u2502   \u2514\u2500\u2500 settings.py\n\u251c\u2500\u2500 strategies/\n\u2502   \u2514\u2500\u2500 simple_strategy.py\n\u251c\u2500\u2500 utils/\n\u2502   \u251c\u2500\u2500 logger.py\n\u2502   \u2514\u2500\u2500 risk_manager.py\n\u251c\u2500\u2500 bot.py\n\u2514\u2500\u2500 requirements.txt\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#buoc-3-implement-binance-client","title":"B\u01b0\u1edbc 3: Implement Binance Client","text":"<pre><code># bot.py\nimport os\nfrom binance.client import Client\nfrom binance.exceptions import BinanceAPIException\nfrom dotenv import load_dotenv\nimport logging\n\nload_dotenv()\n\nclass BinanceTradingBot:\n    def __init__(self):\n        self.api_key = os.getenv('BINANCE_API_KEY')\n        self.secret_key = os.getenv('BINANCE_SECRET_KEY')\n        self.testnet = os.getenv('BINANCE_TESTNET', 'True').lower() == 'true'\n\n        # Kh\u1edfi t\u1ea1o client\n        if self.testnet:\n            self.client = Client(\n                self.api_key,\n                self.secret_key,\n                testnet=True\n            )\n        else:\n            self.client = Client(self.api_key, self.secret_key)\n\n        # Setup logger\n        logging.basicConfig(\n            level=logging.INFO,\n            format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'\n        )\n        self.logger = logging.getLogger(__name__)\n\n    def get_account_balance(self):\n        \"\"\"L\u1ea5y s\u1ed1 d\u01b0 t\u00e0i kho\u1ea3n\"\"\"\n        try:\n            account = self.client.get_account()\n            balances = {b['asset']: float(b['free']) \n                       for b in account['balances'] \n                       if float(b['free']) &gt; 0}\n            return balances\n        except BinanceAPIException as e:\n            self.logger.error(f\"Error getting balance: {e}\")\n            return {}\n\n    def get_ticker_price(self, symbol):\n        \"\"\"L\u1ea5y gi\u00e1 hi\u1ec7n t\u1ea1i c\u1ee7a symbol\"\"\"\n        try:\n            ticker = self.client.get_symbol_ticker(symbol=symbol)\n            return float(ticker['price'])\n        except BinanceAPIException as e:\n            self.logger.error(f\"Error getting price for {symbol}: {e}\")\n            return None\n\n    def place_market_order(self, symbol, side, quantity):\n        \"\"\"\u0110\u1eb7t l\u1ec7nh market\"\"\"\n        try:\n            if side.upper() == 'BUY':\n                order = self.client.order_market_buy(\n                    symbol=symbol,\n                    quantity=quantity\n                )\n            else:\n                order = self.client.order_market_sell(\n                    symbol=symbol,\n                    quantity=quantity\n                )\n            self.logger.info(f\"Order placed: {order}\")\n            return order\n        except BinanceAPIException as e:\n            self.logger.error(f\"Error placing order: {e}\")\n            return None\n\n    def get_klines(self, symbol, interval, limit=100):\n        \"\"\"L\u1ea5y d\u1eef li\u1ec7u kline (candlestick)\"\"\"\n        try:\n            klines = self.client.get_klines(\n                symbol=symbol,\n                interval=interval,\n                limit=limit\n            )\n            return klines\n        except BinanceAPIException as e:\n            self.logger.error(f\"Error getting klines: {e}\")\n            return []\n\nif __name__ == '__main__':\n    bot = BinanceTradingBot()\n    balance = bot.get_account_balance()\n    print(f\"Account balance: {balance}\")\n\n    price = bot.get_ticker_price('BTCUSDT')\n    print(f\"BTC Price: ${price}\")\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#buoc-4-implement-strategy","title":"B\u01b0\u1edbc 4: Implement Strategy","text":"<pre><code># strategies/simple_strategy.py\nimport pandas as pd\nfrom typing import Dict, Optional\n\nclass SimpleMovingAverageStrategy:\n    def __init__(self, short_window=10, long_window=30):\n        self.short_window = short_window\n        self.long_window = long_window\n\n    def calculate_indicators(self, klines):\n        \"\"\"T\u00ednh to\u00e1n c\u00e1c ch\u1ec9 b\u00e1o k\u1ef9 thu\u1eadt\"\"\"\n        df = pd.DataFrame(klines, columns=[\n            'timestamp', 'open', 'high', 'low', 'close', 'volume',\n            'close_time', 'quote_volume', 'trades', 'taker_buy_base',\n            'taker_buy_quote', 'ignore'\n        ])\n\n        # Convert to numeric\n        df['close'] = pd.to_numeric(df['close'])\n        df['high'] = pd.to_numeric(df['high'])\n        df['low'] = pd.to_numeric(df['low'])\n\n        # Calculate moving averages\n        df['sma_short'] = df['close'].rolling(window=self.short_window).mean()\n        df['sma_long'] = df['close'].rolling(window=self.long_window).mean()\n\n        # Calculate RSI\n        delta = df['close'].diff()\n        gain = (delta.where(delta &gt; 0, 0)).rolling(window=14).mean()\n        loss = (-delta.where(delta &lt; 0, 0)).rolling(window=14).mean()\n        rs = gain / loss\n        df['rsi'] = 100 - (100 / (1 + rs))\n\n        return df\n\n    def generate_signal(self, df) -&gt; Optional[str]:\n        \"\"\"T\u1ea1o t\u00edn hi\u1ec7u mua/b\u00e1n\"\"\"\n        if len(df) &lt; self.long_window:\n            return None\n\n        latest = df.iloc[-1]\n        prev = df.iloc[-2]\n\n        # Golden Cross: SMA ng\u1eafn c\u1eaft l\u00ean SMA d\u00e0i\n        if (prev['sma_short'] &lt;= prev['sma_long'] and \n            latest['sma_short'] &gt; latest['sma_long'] and\n            latest['rsi'] &lt; 70):\n            return 'BUY'\n\n        # Death Cross: SMA ng\u1eafn c\u1eaft xu\u1ed1ng SMA d\u00e0i\n        if (prev['sma_short'] &gt;= prev['sma_long'] and \n            latest['sma_short'] &lt; latest['sma_long'] and\n            latest['rsi'] &gt; 30):\n            return 'SELL'\n\n        return None\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#buoc-5-risk-management","title":"B\u01b0\u1edbc 5: Risk Management","text":"<pre><code># utils/risk_manager.py\nclass RiskManager:\n    def __init__(self, max_position_size=0.1, stop_loss_pct=0.02, take_profit_pct=0.04):\n        self.max_position_size = max_position_size  # 10% c\u1ee7a balance\n        self.stop_loss_pct = stop_loss_pct  # 2%\n        self.take_profit_pct = take_profit_pct  # 4%\n\n    def calculate_position_size(self, balance, price):\n        \"\"\"T\u00ednh to\u00e1n k\u00edch th\u01b0\u1edbc position\"\"\"\n        max_investment = balance * self.max_position_size\n        quantity = max_investment / price\n        return round(quantity, 6)\n\n    def should_place_order(self, current_price, entry_price, side):\n        \"\"\"Ki\u1ec3m tra xem c\u00f3 n\u00ean \u0111\u1eb7t l\u1ec7nh kh\u00f4ng\"\"\"\n        if side == 'SELL':\n            # Check stop loss\n            if current_price &lt;= entry_price * (1 - self.stop_loss_pct):\n                return True, 'STOP_LOSS'\n            # Check take profit\n            if current_price &gt;= entry_price * (1 + self.take_profit_pct):\n                return True, 'TAKE_PROFIT'\n\n        return False, None\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#buoc-6-ket-hop-tat-ca-lai","title":"B\u01b0\u1edbc 6: K\u1ebft h\u1ee3p t\u1ea5t c\u1ea3 l\u1ea1i","text":"<pre><code># bot.py (updated)\nimport time\nfrom strategies.simple_strategy import SimpleMovingAverageStrategy\nfrom utils.risk_manager import RiskManager\n\nclass TradingBot(BinanceTradingBot):\n    def __init__(self, symbol='BTCUSDT'):\n        super().__init__()\n        self.symbol = symbol\n        self.strategy = SimpleMovingAverageStrategy()\n        self.risk_manager = RiskManager()\n        self.position = None  # {'side': 'BUY', 'price': 50000, 'quantity': 0.001}\n\n    def run(self):\n        \"\"\"Ch\u1ea1y bot ch\u00ednh\"\"\"\n        self.logger.info(\"Starting trading bot...\")\n\n        while True:\n            try:\n                # L\u1ea5y d\u1eef li\u1ec7u kline\n                klines = self.get_klines(self.symbol, '1h', 100)\n\n                if not klines:\n                    time.sleep(60)\n                    continue\n\n                # T\u00ednh to\u00e1n indicators\n                df = self.strategy.calculate_indicators(klines)\n\n                # T\u1ea1o signal\n                signal = self.strategy.generate_signal(df)\n\n                if signal:\n                    self.logger.info(f\"Signal generated: {signal}\")\n                    self.handle_signal(signal, df)\n\n                # Ki\u1ec3m tra position hi\u1ec7n t\u1ea1i\n                if self.position:\n                    self.check_position()\n\n                # \u0110\u1ee3i 1 ph\u00fat tr\u01b0\u1edbc khi check l\u1ea1i\n                time.sleep(60)\n\n            except KeyboardInterrupt:\n                self.logger.info(\"Bot stopped by user\")\n                break\n            except Exception as e:\n                self.logger.error(f\"Error in main loop: {e}\")\n                time.sleep(60)\n\n    def handle_signal(self, signal, df):\n        \"\"\"X\u1eed l\u00fd t\u00edn hi\u1ec7u trading\"\"\"\n        balance = self.get_account_balance()\n        current_price = float(df.iloc[-1]['close'])\n\n        if signal == 'BUY' and not self.position:\n            # T\u00ednh to\u00e1n quantity\n            usdt_balance = balance.get('USDT', 0)\n            if usdt_balance &gt; 10:  # Minimum $10\n                quantity = self.risk_manager.calculate_position_size(\n                    usdt_balance, current_price\n                )\n\n                order = self.place_market_order(\n                    self.symbol, 'BUY', quantity\n                )\n\n                if order:\n                    self.position = {\n                        'side': 'BUY',\n                        'price': current_price,\n                        'quantity': quantity,\n                        'order_id': order['orderId']\n                    }\n                    self.logger.info(f\"Position opened: {self.position}\")\n\n        elif signal == 'SELL' and self.position:\n            if self.position['side'] == 'BUY':\n                order = self.place_market_order(\n                    self.symbol, 'SELL', self.position['quantity']\n                )\n\n                if order:\n                    profit = (current_price - self.position['price']) * self.position['quantity']\n                    profit_pct = ((current_price - self.position['price']) / self.position['price']) * 100\n                    self.logger.info(f\"Position closed. Profit: ${profit:.2f} ({profit_pct:.2f}%)\")\n                    self.position = None\n\n    def check_position(self):\n        \"\"\"Ki\u1ec3m tra v\u00e0 qu\u1ea3n l\u00fd position hi\u1ec7n t\u1ea1i\"\"\"\n        current_price = self.get_ticker_price(self.symbol)\n\n        if not current_price or not self.position:\n            return\n\n        should_close, reason = self.risk_manager.should_place_order(\n            current_price,\n            self.position['price'],\n            'SELL'\n        )\n\n        if should_close:\n            self.logger.info(f\"Closing position due to: {reason}\")\n            order = self.place_market_order(\n                self.symbol, 'SELL', self.position['quantity']\n            )\n            if order:\n                self.position = None\n\nif __name__ == '__main__':\n    bot = TradingBot(symbol='BTCUSDT')\n    bot.run()\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#best-practices","title":"Best Practices","text":"<ol> <li>Lu\u00f4n test tr\u00ean testnet tr\u01b0\u1edbc: Binance cung c\u1ea5p testnet mi\u1ec5n ph\u00ed</li> <li>Implement logging: Ghi l\u1ea1i t\u1ea5t c\u1ea3 c\u00e1c ho\u1ea1t \u0111\u1ed9ng \u0111\u1ec3 debug</li> <li>Error handling: X\u1eed l\u00fd l\u1ed7i m\u1ed9t c\u00e1ch graceful</li> <li>Rate limiting: Binance c\u00f3 gi\u1edbi h\u1ea1n s\u1ed1 request, c\u1ea7n implement rate limiting</li> <li>Backtesting: Test strategy tr\u00ean d\u1eef li\u1ec7u l\u1ecbch s\u1eed tr\u01b0\u1edbc khi trade th\u1eadt</li> </ol>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-trading-bot-v%E1%BB%9Bi-binance-api---h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-t%E1%BB%AB-a-%C4%91%E1%BA%BFn-z/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta \u0111\u00e3 x\u00e2y d\u1ef1ng m\u1ed9t trading bot c\u01a1 b\u1ea3n v\u1edbi Binance API. Bot n\u00e0y c\u00f3 th\u1ec3: - K\u1ebft n\u1ed1i v\u1edbi Binance API - Ph\u00e2n t\u00edch th\u1ecb tr\u01b0\u1eddng v\u1edbi moving averages - T\u1ef1 \u0111\u1ed9ng \u0111\u1eb7t l\u1ec7nh mua/b\u00e1n - Qu\u1ea3n l\u00fd risk v\u1edbi stop loss v\u00e0 take profit</p> <p>Trong c\u00e1c b\u00e0i vi\u1ebft ti\u1ebfp theo, ch\u00fang ta s\u1ebd n\u00e2ng c\u1ea5p bot v\u1edbi c\u00e1c t\u00ednh n\u0103ng n\u00e2ng cao h\u01a1n nh\u01b0 backtesting, multiple strategies, v\u00e0 real-time monitoring.</p> <p>L\u01b0u \u00fd: Trading c\u00f3 r\u1ee7i ro. Lu\u00f4n test k\u1ef9 tr\u00ean testnet v\u00e0 ch\u1ec9 \u0111\u1ea7u t\u01b0 s\u1ed1 ti\u1ec1n b\u1ea1n c\u00f3 th\u1ec3 ch\u1ea5p nh\u1eadn m\u1ea5t.</p>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/","title":"Caching Strategies cho Trading Systems","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a trading systems, n\u01a1i m\u00e0 m\u1ed7i microsecond \u0111\u1ec1u c\u00f3 gi\u00e1 tr\u1ecb v\u00e0 vi\u1ec7c query database c\u00f3 th\u1ec3 m\u1ea5t h\u00e0ng ch\u1ee5c milliseconds, caching kh\u00f4ng ch\u1ec9 l\u00e0 m\u1ed9t optimization technique - n\u00f3 l\u00e0 m\u1ed9t requirement thi\u1ebft y\u1ebfu \u0111\u1ec3 \u0111\u1ea1t \u0111\u01b0\u1ee3c performance c\u1ea7n thi\u1ebft. Caching cho ph\u00e9p ch\u00fang ta l\u01b0u tr\u1eef d\u1eef li\u1ec7u th\u01b0\u1eddng xuy\u00ean \u0111\u01b0\u1ee3c truy c\u1eadp trong memory (RAM), gi\u1ea3m latency t\u1eeb milliseconds xu\u1ed1ng microseconds, gi\u1ea3m load l\u00ean database, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 cung c\u1ea5p d\u1eef li\u1ec7u ngay l\u1eadp t\u1ee9c cho c\u00e1c trading decisions. Tuy nhi\u00ean, caching trong trading systems c\u00f3 nh\u1eefng th\u00e1ch th\u1ee9c \u0111\u1eb7c bi\u1ec7t: d\u1eef li\u1ec7u trading thay \u0111\u1ed5i li\u00ean t\u1ee5c (market data, order status, account balance), c\u1ea7n \u0111\u1ea3m b\u1ea3o data consistency, v\u00e0 ph\u1ea3i handle cache invalidation m\u1ed9t c\u00e1ch th\u00f4ng minh \u0111\u1ec3 kh\u00f4ng serve stale data c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn quy\u1ebft \u0111\u1ecbnh trading sai l\u1ea7m.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau kh\u00e1m ph\u00e1 c\u00e1c caching strategies v\u00e0 patterns ph\u00f9 h\u1ee3p cho trading systems, t\u1eeb vi\u1ec7c l\u1ef1a ch\u1ecdn caching solution (Redis cho distributed caching, Memcached cho simple use cases, in-memory caching cho single-server scenarios), thi\u1ebft k\u1ebf cache keys v\u00e0 data structures, implement c\u00e1c caching patterns ph\u1ed5 bi\u1ebfn (Cache-Aside, Write-Through, Write-Behind, Refresh-Ahead), \u0111\u1ebfn vi\u1ec7c x\u1eed l\u00fd cache invalidation, consistency, v\u00e0 expiration strategies. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch cache c\u00e1c lo\u1ea1i d\u1eef li\u1ec7u kh\u00e1c nhau: static data nh\u01b0 exchange information, semi-static data nh\u01b0 historical OHLCV, v\u00e0 dynamic data nh\u01b0 real-time prices v\u00e0 order book. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c trade-offs gi\u1eefa cache hit rate, memory usage, v\u00e0 data freshness.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup caching infrastructure, thi\u1ebft k\u1ebf cache architecture, implement caching layers trong application code, \u0111\u1ebfn vi\u1ec7c monitor cache performance, optimize cache hit rates, v\u00e0 handle edge cases nh\u01b0 cache stampede v\u00e0 thundering herd problems. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch implement distributed caching, cache warming strategies, v\u00e0 integrate caching v\u1edbi trading systems. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay ki\u1ebfn th\u1ee9c v\u00e0 tools c\u1ea7n thi\u1ebft \u0111\u1ec3 implement caching m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, gi\u00fap trading systems c\u1ee7a b\u1ea1n \u0111\u1ea1t \u0111\u01b0\u1ee3c performance t\u1ed1i \u01b0u.</p>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#tai-sao-can-caching","title":"T\u1ea1i sao c\u1ea7n Caching?","text":"<ol> <li>Latency: Gi\u1ea3m latency t\u1eeb milliseconds xu\u1ed1ng microseconds</li> <li>Load Reduction: Gi\u1ea3m load l\u00ean database</li> <li>Cost: Gi\u1ea3m cost c\u1ee7a database queries</li> <li>Availability: Serve data ngay c\u1ea3 khi database ch\u1eadm</li> </ol>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#cache-patterns","title":"Cache Patterns","text":""},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#1-cache-aside-lazy-loading","title":"1. Cache-Aside (Lazy Loading)","text":""},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#2-write-through","title":"2. Write-Through","text":""},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#3-write-behind-write-back","title":"3. Write-Behind (Write-Back)","text":""},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#4-refresh-ahead","title":"4. Refresh-Ahead","text":""},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#buoc-1-redis-setup-va-configuration","title":"B\u01b0\u1edbc 1: Redis Setup v\u00e0 Configuration","text":"<pre><code># cache/redis_config.py\nimport redis\nfrom redis.sentinel import Sentinel\nfrom typing import Optional\nimport json\nimport logging\n\nclass RedisCache:\n    \"\"\"Redis cache with connection pooling\"\"\"\n\n    def __init__(self, host: str = 'localhost', port: int = 6379,\n                 db: int = 0, password: Optional[str] = None,\n                 max_connections: int = 50):\n        self.pool = redis.ConnectionPool(\n            host=host,\n            port=port,\n            db=db,\n            password=password,\n            max_connections=max_connections,\n            decode_responses=True\n        )\n        self.redis = redis.Redis(connection_pool=self.pool)\n        self.logger = logging.getLogger(__name__)\n\n    def get(self, key: str) -&gt; Optional[str]:\n        \"\"\"Get value from cache\"\"\"\n        try:\n            return self.redis.get(key)\n        except Exception as e:\n            self.logger.error(f\"Cache get error: {e}\")\n            return None\n\n    def set(self, key: str, value: str, ttl: int = 3600):\n        \"\"\"Set value in cache\"\"\"\n        try:\n            self.redis.setex(key, ttl, value)\n        except Exception as e:\n            self.logger.error(f\"Cache set error: {e}\")\n\n    def delete(self, key: str):\n        \"\"\"Delete key from cache\"\"\"\n        try:\n            self.redis.delete(key)\n        except Exception as e:\n            self.logger.error(f\"Cache delete error: {e}\")\n\n    def exists(self, key: str) -&gt; bool:\n        \"\"\"Check if key exists\"\"\"\n        try:\n            return self.redis.exists(key) &gt; 0\n        except Exception as e:\n            self.logger.error(f\"Cache exists error: {e}\")\n            return False\n</code></pre>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#buoc-2-market-data-cache","title":"B\u01b0\u1edbc 2: Market Data Cache","text":"<pre><code># cache/market_data_cache.py\nfrom cache.redis_config import RedisCache\nfrom typing import Optional, Dict, List\nimport json\nfrom datetime import datetime\n\nclass MarketDataCache:\n    \"\"\"Cache for market data\"\"\"\n\n    def __init__(self, redis_cache: RedisCache):\n        self.cache = redis_cache\n        self.ticker_ttl = 60  # 1 minute\n        self.ohlcv_ttl = 3600  # 1 hour\n        self.orderbook_ttl = 5  # 5 seconds\n\n    def cache_ticker(self, symbol: str, exchange: str, price: float,\n                    volume: Optional[float] = None, change: Optional[float] = None):\n        \"\"\"Cache ticker data\"\"\"\n        key = f\"ticker:{exchange}:{symbol}\"\n        data = {\n            'price': price,\n            'timestamp': datetime.now().isoformat()\n        }\n\n        if volume is not None:\n            data['volume'] = volume\n        if change is not None:\n            data['change'] = change\n\n        self.cache.set(key, json.dumps(data), ttl=self.ticker_ttl)\n\n    def get_ticker(self, symbol: str, exchange: str) -&gt; Optional[Dict]:\n        \"\"\"Get cached ticker\"\"\"\n        key = f\"ticker:{exchange}:{symbol}\"\n        data = self.cache.get(key)\n\n        if data:\n            return json.loads(data)\n        return None\n\n    def cache_ohlcv(self, symbol: str, exchange: str, interval: str,\n                   ohlcv_data: List[Dict], ttl: Optional[int] = None):\n        \"\"\"Cache OHLCV data\"\"\"\n        key = f\"ohlcv:{exchange}:{symbol}:{interval}\"\n        ttl = ttl or self.ohlcv_ttl\n\n        self.cache.set(key, json.dumps(ohlcv_data), ttl=ttl)\n\n    def get_ohlcv(self, symbol: str, exchange: str, interval: str) -&gt; Optional[List[Dict]]:\n        \"\"\"Get cached OHLCV\"\"\"\n        key = f\"ohlcv:{exchange}:{symbol}:{interval}\"\n        data = self.cache.get(key)\n\n        if data:\n            return json.loads(data)\n        return None\n\n    def cache_orderbook(self, symbol: str, exchange: str, bids: List, asks: List):\n        \"\"\"Cache order book\"\"\"\n        key = f\"orderbook:{exchange}:{symbol}\"\n        data = {\n            'bids': bids,\n            'asks': asks,\n            'timestamp': datetime.now().isoformat()\n        }\n\n        self.cache.set(key, json.dumps(data), ttl=self.orderbook_ttl)\n\n    def get_orderbook(self, symbol: str, exchange: str) -&gt; Optional[Dict]:\n        \"\"\"Get cached order book\"\"\"\n        key = f\"orderbook:{exchange}:{symbol}\"\n        data = self.cache.get(key)\n\n        if data:\n            return json.loads(data)\n        return None\n</code></pre>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#buoc-3-cache-aside-pattern","title":"B\u01b0\u1edbc 3: Cache-Aside Pattern","text":"<pre><code># cache/cache_aside.py\nfrom typing import Callable, Optional, TypeVar\nimport json\nimport logging\n\nT = TypeVar('T')\n\nclass CacheAside:\n    \"\"\"Cache-Aside pattern implementation\"\"\"\n\n    def __init__(self, cache: RedisCache):\n        self.cache = cache\n        self.logger = logging.getLogger(__name__)\n\n    def get_or_set(\n        self,\n        key: str,\n        loader: Callable[[], T],\n        ttl: int = 3600,\n        serializer: Optional[Callable] = None,\n        deserializer: Optional[Callable] = None\n    ) -&gt; T:\n        \"\"\"\n        Get from cache or load from source\n\n        Args:\n            key: Cache key\n            loader: Function to load data if not in cache\n            ttl: Time to live in seconds\n            serializer: Function to serialize data\n            deserializer: Function to deserialize data\n        \"\"\"\n        # Try to get from cache\n        cached = self.cache.get(key)\n\n        if cached:\n            try:\n                if deserializer:\n                    return deserializer(cached)\n                return json.loads(cached)\n            except Exception as e:\n                self.logger.warning(f\"Cache deserialize error: {e}\")\n\n        # Load from source\n        data = loader()\n\n        # Store in cache\n        try:\n            if serializer:\n                serialized = serializer(data)\n            else:\n                serialized = json.dumps(data)\n\n            self.cache.set(key, serialized, ttl=ttl)\n        except Exception as e:\n            self.logger.warning(f\"Cache set error: {e}\")\n\n        return data\n\n    def invalidate(self, key: str):\n        \"\"\"Invalidate cache key\"\"\"\n        self.cache.delete(key)\n\n    def invalidate_pattern(self, pattern: str):\n        \"\"\"Invalidate all keys matching pattern\"\"\"\n        # Note: This requires SCAN which can be slow\n        # Better to use specific keys or tags\n        pass\n</code></pre>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#buoc-4-write-through-cache","title":"B\u01b0\u1edbc 4: Write-Through Cache","text":"<pre><code># cache/write_through.py\nfrom cache.redis_config import RedisCache\nfrom typing import Callable, Optional\nimport json\nimport logging\n\nclass WriteThroughCache:\n    \"\"\"Write-Through cache pattern\"\"\"\n\n    def __init__(self, cache: RedisCache, writer: Callable):\n        \"\"\"\n        Args:\n            cache: Redis cache instance\n            writer: Function to write to persistent storage\n        \"\"\"\n        self.cache = cache\n        self.writer = writer\n        self.logger = logging.getLogger(__name__)\n\n    def write(self, key: str, value: any, ttl: int = 3600):\n        \"\"\"Write to both cache and storage\"\"\"\n        # Write to storage first\n        try:\n            self.writer(key, value)\n        except Exception as e:\n            self.logger.error(f\"Storage write error: {e}\")\n            raise\n\n        # Then write to cache\n        try:\n            serialized = json.dumps(value) if not isinstance(value, str) else value\n            self.cache.set(key, serialized, ttl=ttl)\n        except Exception as e:\n            self.logger.warning(f\"Cache write error: {e}\")\n            # Don't fail if cache write fails\n</code></pre>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#buoc-5-cache-warming","title":"B\u01b0\u1edbc 5: Cache Warming","text":"<pre><code># cache/cache_warmer.py\nfrom cache.market_data_cache import MarketDataCache\nfrom database.market_data_db import MarketDataDB\nfrom typing import List\nimport logging\nfrom datetime import datetime, timedelta\n\nclass CacheWarmer:\n    \"\"\"Warm up cache with frequently accessed data\"\"\"\n\n    def __init__(self, cache: MarketDataCache, db: MarketDataDB):\n        self.cache = cache\n        self.db = db\n        self.logger = logging.getLogger(__name__)\n\n    def warm_tickers(self, symbols: List[tuple]):\n        \"\"\"Warm ticker cache\"\"\"\n        for symbol, exchange in symbols:\n            try:\n                price = self.db.get_latest_price(symbol, exchange)\n                if price:\n                    self.cache.cache_ticker(symbol, exchange, price)\n                    self.logger.info(f\"Warmed ticker: {exchange}:{symbol}\")\n            except Exception as e:\n                self.logger.error(f\"Error warming ticker {symbol}: {e}\")\n\n    def warm_ohlcv(self, symbols: List[tuple], interval: str = '1h'):\n        \"\"\"Warm OHLCV cache\"\"\"\n        end_time = datetime.now()\n        start_time = end_time - timedelta(days=7)  # Last 7 days\n\n        for symbol, exchange in symbols:\n            try:\n                data = self.db.get_ohlcv(\n                    symbol, exchange, interval, start_time, end_time\n                )\n                if data:\n                    self.cache.cache_ohlcv(symbol, exchange, interval, data)\n                    self.logger.info(f\"Warmed OHLCV: {exchange}:{symbol}:{interval}\")\n            except Exception as e:\n                self.logger.error(f\"Error warming OHLCV {symbol}: {e}\")\n</code></pre>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#buoc-6-distributed-cache-voi-redis-cluster","title":"B\u01b0\u1edbc 6: Distributed Cache v\u1edbi Redis Cluster","text":"<pre><code># cache/redis_cluster.py\nfrom redis.cluster import RedisCluster\nfrom typing import Optional\nimport json\n\nclass RedisClusterCache:\n    \"\"\"Redis Cluster for distributed caching\"\"\"\n\n    def __init__(self, startup_nodes: List[dict], password: Optional[str] = None):\n        \"\"\"\n        Args:\n            startup_nodes: [{\"host\": \"127.0.0.1\", \"port\": \"7000\"}, ...]\n        \"\"\"\n        self.cluster = RedisCluster(\n            startup_nodes=startup_nodes,\n            password=password,\n            decode_responses=True,\n            skip_full_coverage_check=True\n        )\n\n    def get(self, key: str) -&gt; Optional[str]:\n        \"\"\"Get from cluster\"\"\"\n        try:\n            return self.cluster.get(key)\n        except Exception:\n            return None\n\n    def set(self, key: str, value: str, ttl: int = 3600):\n        \"\"\"Set in cluster\"\"\"\n        self.cluster.setex(key, ttl, value)\n\n    def delete(self, key: str):\n        \"\"\"Delete from cluster\"\"\"\n        self.cluster.delete(key)\n</code></pre>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#best-practices","title":"Best Practices","text":"<ol> <li>TTL Strategy: Set appropriate TTLs based on data freshness needs</li> <li>Cache Keys: Use consistent, hierarchical key naming</li> <li>Serialization: Use efficient serialization (MessagePack, Protocol Buffers)</li> <li>Monitoring: Monitor cache hit rates</li> <li>Eviction Policy: Configure appropriate eviction (LRU, LFU)</li> <li>Warming: Pre-warm frequently accessed data</li> <li>Invalidation: Invalidate carefully to avoid stale data</li> </ol>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#cache-metrics","title":"Cache Metrics","text":"<pre><code># cache/metrics.py\nclass CacheMetrics:\n    \"\"\"Track cache performance\"\"\"\n\n    def __init__(self):\n        self.hits = 0\n        self.misses = 0\n        self.errors = 0\n\n    def record_hit(self):\n        self.hits += 1\n\n    def record_miss(self):\n        self.misses += 1\n\n    def record_error(self):\n        self.errors += 1\n\n    def get_hit_rate(self) -&gt; float:\n        total = self.hits + self.misses\n        return (self.hits / total * 100) if total &gt; 0 else 0\n\n    def get_stats(self) -&gt; dict:\n        return {\n            'hits': self.hits,\n            'misses': self.misses,\n            'errors': self.errors,\n            'hit_rate': self.get_hit_rate()\n        }\n</code></pre>"},{"location":"blog/2025/01/25/caching-strategies-cho-trading-systems---redis-memcached-v%C3%A0-beyond/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Caching l\u00e0 essential cho trading systems: - Gi\u1ea3m latency - Gi\u1ea3m database load - Improve availability - Better user experience</p> <p>Ch\u1ecdn caching strategy ph\u00f9 h\u1ee3p v\u1edbi use case c\u1ee7a b\u1ea1n!</p>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/","title":"Case Study: Backtesting Chi\u1ebfn L\u01b0\u1ee3c Futures BTC tr\u00ean Binance","text":"<p>Trong th\u1ebf gi\u1edbi giao d\u1ecbch cryptocurrency, vi\u1ec7c ki\u1ec3m th\u1eed m\u1ed9t chi\u1ebfn l\u01b0\u1ee3c trading tr\u01b0\u1edbc khi tri\u1ec3n khai v\u1edbi ti\u1ec1n th\u1eadt l\u00e0 \u0111i\u1ec1u v\u00f4 c\u00f9ng quan tr\u1ecdng. Backtesting kh\u00f4ng ch\u1ec9 gi\u00fap ch\u00fang ta \u0111\u00e1nh gi\u00e1 hi\u1ec7u qu\u1ea3 c\u1ee7a chi\u1ebfn l\u01b0\u1ee3c tr\u00ean d\u1eef li\u1ec7u l\u1ecbch s\u1eed, m\u00e0 c\u00f2n cho ph\u00e9p ch\u00fang ta hi\u1ec3u r\u00f5 v\u1ec1 r\u1ee7i ro, drawdown, v\u00e0 c\u00e1c \u0111i\u1ec3m y\u1ebfu ti\u1ec1m \u1ea9n tr\u01b0\u1edbc khi \u0111\u1ed1i m\u1eb7t v\u1edbi th\u1ecb tr\u01b0\u1eddng th\u1ef1c t\u1ebf. Trong case study chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau th\u1ef1c hi\u1ec7n m\u1ed9t ph\u00e2n t\u00edch backtesting to\u00e0n di\u1ec7n cho chi\u1ebfn l\u01b0\u1ee3c giao d\u1ecbch futures BTC tr\u00ean s\u00e0n Binance - m\u1ed9t trong nh\u1eefng s\u00e0n giao d\u1ecbch cryptocurrency l\u1edbn nh\u1ea5t th\u1ebf gi\u1edbi v\u1edbi thanh kho\u1ea3n kh\u1ed5ng l\u1ed3 v\u00e0 ph\u00ed giao d\u1ecbch c\u1ea1nh tranh.</p> <p>Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng th\u01b0 vi\u1ec7n Backtrader - m\u1ed9t trong nh\u1eefng framework backtesting m\u1ea1nh m\u1ebd v\u00e0 linh ho\u1ea1t nh\u1ea5t cho Python, \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng r\u1ed9ng r\u00e3i b\u1edfi c\u00e1c nh\u00e0 giao d\u1ecbch chuy\u00ean nghi\u1ec7p v\u00e0 qu\u1ef9 \u0111\u1ea7u t\u01b0. Backtrader kh\u00f4ng ch\u1ec9 cung c\u1ea5p c\u00e1c c\u00f4ng c\u1ee5 \u0111\u1ec3 m\u00f4 ph\u1ecfng giao d\u1ecbch m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c, m\u00e0 c\u00f2n t\u00edch h\u1ee3p s\u1eb5n h\u00e0ng tr\u0103m ch\u1ec9 b\u00e1o k\u1ef9 thu\u1eadt, c\u00e1c analyzer \u0111\u1ec3 \u0111\u00e1nh gi\u00e1 hi\u1ec7u su\u1ea5t, v\u00e0 kh\u1ea3 n\u0103ng visualize k\u1ebft qu\u1ea3 m\u1ed9t c\u00e1ch tr\u1ef1c quan. Case study n\u00e0y s\u1ebd \u0111i s\u00e2u v\u00e0o t\u1eebng b\u01b0\u1edbc: t\u1eeb vi\u1ec7c l\u1ea5y d\u1eef li\u1ec7u l\u1ecbch s\u1eed t\u1eeb Binance Futures API, x\u00e2y d\u1ef1ng chi\u1ebfn l\u01b0\u1ee3c k\u1ebft h\u1ee3p Moving Average Crossover v\u1edbi RSI v\u00e0 Volume Confirmation, \u0111\u1ebfn vi\u1ec7c ph\u00e2n t\u00edch k\u1ebft qu\u1ea3 chi ti\u1ebft v\u00e0 \u0111\u01b0a ra c\u00e1c khuy\u1ebfn ngh\u1ecb th\u1ef1c t\u1ebf cho vi\u1ec7c tri\u1ec3n khai.</p> <p>\u0110i\u1ec1u \u0111\u1eb7c bi\u1ec7t c\u1ee7a case study n\u00e0y l\u00e0 ch\u00fang ta s\u1ebd kh\u00f4ng ch\u1ec9 d\u1eebng l\u1ea1i \u1edf vi\u1ec7c ch\u1ea1y backtest v\u00e0 xem k\u1ebft qu\u1ea3. Ch\u00fang ta s\u1ebd ph\u00e2n t\u00edch s\u00e2u c\u00e1c metrics nh\u01b0 Sharpe Ratio, Maximum Drawdown, Win Rate, Profit Factor, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 \u0111\u00e1nh gi\u00e1 xem chi\u1ebfn l\u01b0\u1ee3c n\u00e0y c\u00f3 th\u1ef1c s\u1ef1 robust v\u00e0 c\u00f3 th\u1ec3 tri\u1ec3n khai trong th\u1ef1c t\u1ebf hay kh\u00f4ng. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c \u0111i\u1ec3m y\u1ebfu ti\u1ec1m \u1ea9n, c\u00e1ch t\u1ed1i \u01b0u h\u00f3a parameters, v\u00e0 roadmap \u0111\u1ec3 c\u1ea3i thi\u1ec7n chi\u1ebfn l\u01b0\u1ee3c trong t\u01b0\u01a1ng lai. H\u00e3y c\u00f9ng b\u1eaft \u0111\u1ea7u h\u00e0nh tr\u00ecnh kh\u00e1m ph\u00e1 n\u00e0y!</p> <p></p>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#tong-quan-case-study","title":"T\u1ed5ng quan Case Study","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#muc-tieu","title":"M\u1ee5c ti\u00eau","text":"<ul> <li>\u0110\u00e1nh gi\u00e1 hi\u1ec7u qu\u1ea3 c\u1ee7a chi\u1ebfn l\u01b0\u1ee3c Moving Average Crossover k\u1ebft h\u1ee3p RSI v\u00e0 Volume Profile cho futures BTC</li> <li>Ph\u00e2n t\u00edch r\u1ee7i ro v\u00e0 drawdown</li> <li>T\u1ed1i \u01b0u h\u00f3a tham s\u1ed1</li> <li>\u0110\u01b0a ra khuy\u1ebfn ngh\u1ecb v\u1ec1 vi\u1ec7c tri\u1ec3n khai th\u1ef1c t\u1ebf</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#pham-vi-nghien-cuu","title":"Ph\u1ea1m vi nghi\u00ean c\u1ee9u","text":"<ul> <li>S\u1ea3n ph\u1ea9m: BTCUSDT Perpetual Futures (Binance)</li> <li>Th\u1eddi gian: 01/01/2023 - 31/12/2024 (2 n\u0103m)</li> <li>Timeframe: 4 gi\u1edd (4h)</li> <li>V\u1ed1n ban \u0111\u1ea7u: $10,000</li> <li>Leverage: 3x (conservative)</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#thu-vien-su-dung","title":"Th\u01b0 vi\u1ec7n s\u1eed d\u1ee5ng","text":"<ul> <li>Backtrader: Framework backtesting ch\u00ednh</li> <li>Pandas: X\u1eed l\u00fd d\u1eef li\u1ec7u</li> <li>NumPy: T\u00ednh to\u00e1n s\u1ed1 h\u1ecdc</li> <li>Matplotlib/Plotly: Visualization</li> <li>python-binance: L\u1ea5y d\u1eef li\u1ec7u t\u1eeb Binance</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#chien-luoc-trading","title":"Chi\u1ebfn l\u01b0\u1ee3c Trading","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#mo-ta-chien-luoc","title":"M\u00f4 t\u1ea3 chi\u1ebfn l\u01b0\u1ee3c","text":"<p>Chi\u1ebfn l\u01b0\u1ee3c c\u1ee7a ch\u00fang ta k\u1ebft h\u1ee3p 3 ch\u1ec9 b\u00e1o k\u1ef9 thu\u1eadt ph\u1ed5 bi\u1ebfn v\u00e0 hi\u1ec7u qu\u1ea3 trong trading:</p> <ol> <li>Moving Average Crossover</li> <li>SMA 20 (ng\u1eafn h\u1ea1n)</li> <li>SMA 50 (d\u00e0i h\u1ea1n)</li> <li>T\u00edn hi\u1ec7u mua khi SMA 20 c\u1eaft l\u00ean SMA 50 (Golden Cross)</li> <li> <p>T\u00edn hi\u1ec7u b\u00e1n khi SMA 20 c\u1eaft xu\u1ed1ng SMA 50 (Death Cross)</p> </li> <li> <p>RSI (Relative Strength Index)</p> </li> <li>Period: 14</li> <li>Filter: Ch\u1ec9 mua khi RSI &lt; 70, ch\u1ec9 b\u00e1n khi RSI &gt; 30</li> <li> <p>Tr\u00e1nh overbought/oversold extremes</p> </li> <li> <p>Volume Confirmation</p> </li> <li>Ch\u1ec9 th\u1ef1c hi\u1ec7n giao d\u1ecbch khi volume &gt; 1.2x volume trung b\u00ecnh 20 k\u1ef3</li> <li>\u0110\u1ea3m b\u1ea3o c\u00f3 thanh kho\u1ea3n \u0111\u1ee7</li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#quy-tac-entryexit","title":"Quy t\u1eafc Entry/Exit","text":"<p>LONG Entry: - SMA 20 &gt; SMA 50 (Golden Cross) - RSI &lt; 70 (kh\u00f4ng qu\u00e1 overbought) - Volume &gt; 1.2x SMA(volume, 20) - Stop Loss: -2% t\u1eeb entry price - Take Profit: +4% t\u1eeb entry price</p> <p>SHORT Entry: - SMA 20 &lt; SMA 50 (Death Cross) - RSI &gt; 30 (kh\u00f4ng qu\u00e1 oversold) - Volume &gt; 1.2x SMA(volume, 20) - Stop Loss: +2% t\u1eeb entry price - Take Profit: -4% t\u1eeb entry price</p>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#risk-management","title":"Risk Management","text":"<ul> <li>Position Size: 30% v\u1ed1n m\u1ed7i l\u1ec7nh</li> <li>Max Drawdown: D\u1eebng trading n\u1ebfu drawdown &gt; 20%</li> <li>Leverage: 3x (conservative cho futures)</li> <li>Commission: 0.04% m\u1ed7i l\u1ec7nh (Binance futures fee)</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#implementation-voi-backtrader","title":"Implementation v\u1edbi Backtrader","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#buoc-1-setup-moi-truong","title":"B\u01b0\u1edbc 1: Setup m\u00f4i tr\u01b0\u1eddng","text":"<pre><code>pip install backtrader pandas numpy matplotlib python-binance ta-lib\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#buoc-2-tai-du-lieu-tu-binance","title":"B\u01b0\u1edbc 2: T\u1ea3i d\u1eef li\u1ec7u t\u1eeb Binance","text":"<pre><code># data_fetcher.py\nfrom binance.client import Client\nimport pandas as pd\nfrom datetime import datetime, timedelta\nimport os\n\nclass BinanceDataFetcher:\n    def __init__(self, api_key=None, api_secret=None):\n        \"\"\"Kh\u1edfi t\u1ea1o Binance client\"\"\"\n        if api_key and api_secret:\n            self.client = Client(api_key, api_secret)\n        else:\n            # Public API kh\u00f4ng c\u1ea7n key \u0111\u1ec3 l\u1ea5y historical data\n            self.client = Client()\n\n    def fetch_futures_klines(self, symbol='BTCUSDT', interval='4h', \n                            start_date=None, end_date=None, limit=1000):\n        \"\"\"\n        L\u1ea5y d\u1eef li\u1ec7u kline t\u1eeb Binance Futures\n\n        Args:\n            symbol: Trading pair (default: BTCUSDT)\n            interval: Timeframe (1m, 5m, 15m, 1h, 4h, 1d, etc.)\n            start_date: Ng\u00e0y b\u1eaft \u0111\u1ea7u (datetime ho\u1eb7c string)\n            end_date: Ng\u00e0y k\u1ebft th\u00fac (datetime ho\u1eb7c string)\n            limit: S\u1ed1 l\u01b0\u1ee3ng kline t\u1ed1i \u0111a m\u1ed7i request (max 1000)\n        \"\"\"\n        try:\n            # Convert dates to timestamps\n            if isinstance(start_date, str):\n                start_date = datetime.strptime(start_date, '%Y-%m-%d')\n            if isinstance(end_date, str):\n                end_date = datetime.strptime(end_date, '%Y-%m-%d')\n\n            # Fetch klines\n            klines = self.client.futures_klines(\n                symbol=symbol,\n                interval=interval,\n                startTime=int(start_date.timestamp() * 1000) if start_date else None,\n                endTime=int(end_date.timestamp() * 1000) if end_date else None,\n                limit=limit\n            )\n\n            # Convert to DataFrame\n            df = pd.DataFrame(klines, columns=[\n                'timestamp', 'open', 'high', 'low', 'close', 'volume',\n                'close_time', 'quote_volume', 'trades', 'taker_buy_base',\n                'taker_buy_quote', 'ignore'\n            ])\n\n            # Convert to numeric\n            numeric_cols = ['open', 'high', 'low', 'close', 'volume', \n                          'quote_volume', 'trades']\n            for col in numeric_cols:\n                df[col] = pd.to_numeric(df[col])\n\n            # Convert timestamp to datetime\n            df['datetime'] = pd.to_datetime(df['timestamp'], unit='ms')\n            df.set_index('datetime', inplace=True)\n\n            # Select OHLCV columns\n            df = df[['open', 'high', 'low', 'close', 'volume']]\n            df.columns = ['Open', 'High', 'Low', 'Close', 'Volume']\n\n            return df\n\n        except Exception as e:\n            print(f\"Error fetching data: {e}\")\n            return None\n\n    def fetch_historical_data(self, symbol='BTCUSDT', interval='4h',\n                            start_date='2023-01-01', end_date='2024-12-31'):\n        \"\"\"\n        L\u1ea5y to\u00e0n b\u1ed9 d\u1eef li\u1ec7u l\u1ecbch s\u1eed (x\u1eed l\u00fd pagination)\n        \"\"\"\n        all_data = []\n        current_start = datetime.strptime(start_date, '%Y-%m-%d')\n        end = datetime.strptime(end_date, '%Y-%m-%d')\n\n        print(f\"Fetching data from {start_date} to {end_date}...\")\n\n        while current_start &lt; end:\n            # Fetch 1000 klines (kho\u1ea3ng 166 ng\u00e0y v\u1edbi 4h interval)\n            batch = self.fetch_futures_klines(\n                symbol=symbol,\n                interval=interval,\n                start_date=current_start,\n                end_date=min(current_start + timedelta(days=166), end),\n                limit=1000\n            )\n\n            if batch is not None and not batch.empty:\n                all_data.append(batch)\n                # Move to next batch (1000 klines * 4h = 4000 hours)\n                current_start = batch.index[-1] + timedelta(hours=4)\n                print(f\"Fetched data up to {current_start}\")\n            else:\n                break\n\n        if all_data:\n            df = pd.concat(all_data)\n            df = df[~df.index.duplicated(keep='first')]\n            df.sort_index(inplace=True)\n            print(f\"Total data points: {len(df)}\")\n            return df\n        else:\n            return None\n\n# Usage\nif __name__ == '__main__':\n    fetcher = BinanceDataFetcher()\n    data = fetcher.fetch_historical_data(\n        symbol='BTCUSDT',\n        interval='4h',\n        start_date='2023-01-01',\n        end_date='2024-12-31'\n    )\n\n    if data is not None:\n        data.to_csv('btcusdt_4h_2023_2024.csv')\n        print(\"Data saved successfully!\")\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#buoc-3-implement-strategy-voi-backtrader","title":"B\u01b0\u1edbc 3: Implement Strategy v\u1edbi Backtrader","text":"<pre><code># btc_futures_strategy.py\nimport backtrader as bt\nimport pandas as pd\nimport numpy as np\n\nclass BTCFuturesStrategy(bt.Strategy):\n    \"\"\"\n    Chi\u1ebfn l\u01b0\u1ee3c Futures BTC k\u1ebft h\u1ee3p MA Crossover, RSI v\u00e0 Volume\n    \"\"\"\n\n    params = (\n        ('sma_short', 20),      # SMA ng\u1eafn h\u1ea1n\n        ('sma_long', 50),       # SMA d\u00e0i h\u1ea1n\n        ('rsi_period', 14),     # RSI period\n        ('rsi_upper', 70),      # RSI upper threshold\n        ('rsi_lower', 30),      # RSI lower threshold\n        ('volume_factor', 1.2), # Volume multiplier\n        ('volume_period', 20),  # Volume SMA period\n        ('stop_loss', 0.02),    # Stop loss 2%\n        ('take_profit', 0.04),  # Take profit 4%\n        ('position_size', 0.30), # 30% v\u1ed1n m\u1ed7i l\u1ec7nh\n        ('printlog', False),\n    )\n\n    def __init__(self):\n        \"\"\"Kh\u1edfi t\u1ea1o indicators\"\"\"\n        # Moving Averages\n        self.sma_short = bt.indicators.SMA(\n            self.datas[0].close, period=self.params.sma_short\n        )\n        self.sma_long = bt.indicators.SMA(\n            self.datas[0].close, period=self.params.sma_long\n        )\n\n        # RSI\n        self.rsi = bt.indicators.RSI(\n            self.datas[0].close, period=self.params.rsi_period\n        )\n\n        # Volume SMA\n        self.volume_sma = bt.indicators.SMA(\n            self.datas[0].volume, period=self.params.volume_period\n        )\n\n        # Crossovers\n        self.crossover = bt.indicators.CrossOver(self.sma_short, self.sma_long)\n\n        # Track orders\n        self.order = None\n        self.buyprice = None\n        self.buycomm = None\n        self.sellprice = None\n        self.sellcomm = None\n\n        # Statistics\n        self.trade_count = 0\n        self.win_count = 0\n        self.loss_count = 0\n\n    def log(self, txt, dt=None):\n        \"\"\"Logging function\"\"\"\n        if self.params.printlog:\n            dt = dt or self.datas[0].datetime.date(0)\n            print(f'{dt.isoformat()}, {txt}')\n\n    def notify_order(self, order):\n        \"\"\"X\u1eed l\u00fd th\u00f4ng b\u00e1o order\"\"\"\n        if order.status in [order.Submitted, order.Accepted]:\n            return\n\n        if order.status in [order.Completed]:\n            if order.isbuy():\n                self.log(\n                    f'BUY EXECUTED, Price: {order.executed.price:.2f}, '\n                    f'Cost: {order.executed.value:.2f}, Comm: {order.executed.comm:.2f}'\n                )\n                self.buyprice = order.executed.price\n                self.buycomm = order.executed.comm\n            else:\n                self.log(\n                    f'SELL EXECUTED, Price: {order.executed.price:.2f}, '\n                    f'Cost: {order.executed.value:.2f}, Comm: {order.executed.comm:.2f}'\n                )\n                self.sellprice = order.executed.price\n                self.sellcomm = order.executed.comm\n\n        elif order.status in [order.Canceled, order.Margin, order.Rejected]:\n            self.log('Order Canceled/Margin/Rejected')\n\n        self.order = None\n\n    def notify_trade(self, trade):\n        \"\"\"X\u1eed l\u00fd th\u00f4ng b\u00e1o trade\"\"\"\n        if not trade.isclosed:\n            return\n\n        self.trade_count += 1\n        pnl = trade.pnl\n        pnl_pct = (trade.pnl / trade.value) * 100 if trade.value &gt; 0 else 0\n\n        if pnl &gt; 0:\n            self.win_count += 1\n        else:\n            self.loss_count += 1\n\n        self.log(\n            f'OPERATION PROFIT, GROSS: {trade.pnl:.2f}, NET: {trade.pnlcomm:.2f}, '\n            f'PCT: {pnl_pct:.2f}%'\n        )\n\n    def next(self):\n        \"\"\"Logic ch\u00ednh c\u1ee7a strategy - ch\u1ea1y m\u1ed7i bar\"\"\"\n        # Skip n\u1ebfu ch\u01b0a \u0111\u1ee7 data\n        if len(self.datas[0]) &lt; self.params.sma_long:\n            return\n\n        # Ki\u1ec3m tra n\u1ebfu c\u00f3 order pending\n        if self.order:\n            return\n\n        # L\u1ea5y gi\u00e1 tr\u1ecb hi\u1ec7n t\u1ea1i\n        current_price = self.datas[0].close[0]\n        current_volume = self.datas[0].volume[0]\n        volume_threshold = self.volume_sma[0] * self.params.volume_factor\n\n        # Ki\u1ec3m tra volume\n        volume_ok = current_volume &gt; volume_threshold\n\n        # LONG Logic\n        if not self.position:\n            # Golden Cross + RSI filter + Volume confirmation\n            if (self.crossover[0] &gt; 0 and  # SMA short crosses above SMA long\n                self.rsi[0] &lt; self.params.rsi_upper and\n                volume_ok):\n\n                # Calculate position size\n                size = int((self.broker.getcash() * self.params.position_size) / current_price)\n\n                if size &gt; 0:\n                    self.log(f'BUY CREATE, Price: {current_price:.2f}, Size: {size}')\n                    self.order = self.buy(size=size)\n\n                    # Set stop loss and take profit\n                    stop_price = current_price * (1 - self.params.stop_loss)\n                    take_profit_price = current_price * (1 + self.params.take_profit)\n                    self.order = self.buy(exectype=bt.Order.StopTrail, \n                                        trailpercent=self.params.stop_loss)\n\n        # SHORT Logic (for futures)\n        elif self.position.size == 0:\n            # Death Cross + RSI filter + Volume confirmation\n            if (self.crossover[0] &lt; 0 and  # SMA short crosses below SMA long\n                self.rsi[0] &gt; self.params.rsi_lower and\n                volume_ok):\n\n                # Calculate position size\n                size = int((self.broker.getcash() * self.params.position_size) / current_price)\n\n                if size &gt; 0:\n                    self.log(f'SELL CREATE, Price: {current_price:.2f}, Size: {size}')\n                    self.order = self.sell(size=size)\n\n        # Exit Logic v\u1edbi Stop Loss v\u00e0 Take Profit\n        else:\n            if self.position.size &gt; 0:  # Long position\n                # Stop Loss\n                if current_price &lt;= self.buyprice * (1 - self.params.stop_loss):\n                    self.log(f'STOP LOSS, Price: {current_price:.2f}')\n                    self.order = self.sell(size=self.position.size)\n                # Take Profit\n                elif current_price &gt;= self.buyprice * (1 + self.params.take_profit):\n                    self.log(f'TAKE PROFIT, Price: {current_price:.2f}')\n                    self.order = self.sell(size=self.position.size)\n                # Death Cross exit\n                elif self.crossover[0] &lt; 0:\n                    self.log(f'DEATH CROSS EXIT, Price: {current_price:.2f}')\n                    self.order = self.sell(size=self.position.size)\n\n            elif self.position.size &lt; 0:  # Short position\n                # Stop Loss (inverse for short)\n                if current_price &gt;= abs(self.sellprice) * (1 + self.params.stop_loss):\n                    self.log(f'STOP LOSS (SHORT), Price: {current_price:.2f}')\n                    self.order = self.buy(size=abs(self.position.size))\n                # Take Profit\n                elif current_price &lt;= abs(self.sellprice) * (1 - self.params.take_profit):\n                    self.log(f'TAKE PROFIT (SHORT), Price: {current_price:.2f}')\n                    self.order = self.buy(size=abs(self.position.size))\n                # Golden Cross exit\n                elif self.crossover[0] &gt; 0:\n                    self.log(f'GOLDEN CROSS EXIT (SHORT), Price: {current_price:.2f}')\n                    self.order = self.buy(size=abs(self.position.size))\n\n    def stop(self):\n        \"\"\"Ch\u1ea1y khi backtest k\u1ebft th\u00fac\"\"\"\n        self.log(\n            f'(SMA Short: {self.params.sma_short}, SMA Long: {self.params.sma_long}) '\n            f'Total Trades: {self.trade_count}, Wins: {self.win_count}, Losses: {self.loss_count}',\n            dt=None\n        )\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#buoc-4-chay-backtest","title":"B\u01b0\u1edbc 4: Ch\u1ea1y Backtest","text":"<pre><code># run_backtest.py\nimport backtrader as bt\nimport pandas as pd\nfrom datetime import datetime\nfrom btc_futures_strategy import BTCFuturesStrategy\nfrom data_fetcher import BinanceDataFetcher\n\ndef run_backtest():\n    \"\"\"Ch\u1ea1y backtest ho\u00e0n ch\u1ec9nh\"\"\"\n\n    # 1. Load data\n    print(\"=\" * 50)\n    print(\"Loading historical data...\")\n    print(\"=\" * 50)\n\n    try:\n        # Load from CSV n\u1ebfu \u0111\u00e3 c\u00f3\n        data = pd.read_csv('btcusdt_4h_2023_2024.csv', index_col=0, parse_dates=True)\n        print(f\"Loaded {len(data)} data points from CSV\")\n    except FileNotFoundError:\n        # Fetch t\u1eeb Binance n\u1ebfu ch\u01b0a c\u00f3\n        fetcher = BinanceDataFetcher()\n        data = fetcher.fetch_historical_data(\n            symbol='BTCUSDT',\n            interval='4h',\n            start_date='2023-01-01',\n            end_date='2024-12-31'\n        )\n        if data is not None:\n            data.to_csv('btcusdt_4h_2023_2024.csv')\n            print(f\"Fetched and saved {len(data)} data points\")\n        else:\n            print(\"Error fetching data!\")\n            return\n\n    # 2. Setup Backtrader\n    cerebro = bt.Cerebro()\n\n    # Add data\n    datafeed = bt.feeds.PandasData(\n        dataname=data,\n        datetime=None,\n        open=0,\n        high=1,\n        low=2,\n        close=3,\n        volume=4,\n        openinterest=-1\n    )\n    cerebro.adddata(datafeed)\n\n    # Add strategy\n    cerebro.addstrategy(BTCFuturesStrategy, printlog=False)\n\n    # Set initial capital\n    initial_cash = 10000.0\n    cerebro.broker.setcash(initial_cash)\n\n    # Set commission (Binance futures: 0.04% per trade)\n    cerebro.broker.setcommission(commission=0.0004)\n\n    # Set leverage (3x)\n    cerebro.broker.set_filler(bt.brokers.fillers.FixedBarPerc(perc=3.0))\n\n    # Add analyzers\n    cerebro.addanalyzer(bt.analyzers.SharpeRatio, _name='sharpe')\n    cerebro.addanalyzer(bt.analyzers.DrawDown, _name='drawdown')\n    cerebro.addanalyzer(bt.analyzers.Returns, _name='returns')\n    cerebro.addanalyzer(bt.analyzers.TradeAnalyzer, _name='trades')\n    cerebro.addanalyzer(bt.analyzers.SQN, _name='sqn')\n\n    # Print starting conditions\n    print(\"\\n\" + \"=\" * 50)\n    print(\"Starting Backtest\")\n    print(\"=\" * 50)\n    print(f'Starting Portfolio Value: ${cerebro.broker.getvalue():.2f}')\n\n    # Run backtest\n    print(\"\\nRunning backtest...\")\n    results = cerebro.run()\n\n    # Get final value\n    final_value = cerebro.broker.getvalue()\n    print(f'\\nFinal Portfolio Value: ${final_value:.2f}')\n\n    # Extract results\n    strat = results[0]\n\n    # Performance metrics\n    sharpe = strat.analyzers.sharpe.get_analysis()\n    drawdown = strat.analyzers.drawdown.get_analysis()\n    returns = strat.analyzers.returns.get_analysis()\n    trades = strat.analyzers.trades.get_analysis()\n    sqn = strat.analyzers.sqn.get_analysis()\n\n    # Print results\n    print(\"\\n\" + \"=\" * 50)\n    print(\"BACKTEST RESULTS\")\n    print(\"=\" * 50)\n\n    print(f\"\\n\ud83d\udcca PERFORMANCE METRICS:\")\n    print(f\"  Initial Capital: ${initial_cash:,.2f}\")\n    print(f\"  Final Value: ${final_value:,.2f}\")\n    print(f\"  Total Return: {returns.get('rtot', 0) * 100:.2f}%\")\n    print(f\"  Annual Return: {returns.get('rnorm100', 0):.2f}%\")\n\n    print(f\"\\n\ud83d\udcc8 RISK METRICS:\")\n    print(f\"  Sharpe Ratio: {sharpe.get('sharperatio', 0):.4f}\")\n    print(f\"  Max Drawdown: {drawdown.get('max', {}).get('drawdown', 0):.2f}%\")\n    print(f\"  Max Drawdown Period: {drawdown.get('max', {}).get('len', 0)} bars\")\n    print(f\"  System Quality Number: {sqn.get('sqn', 0):.2f}\")\n\n    print(f\"\\n\ud83d\udcb0 TRADE STATISTICS:\")\n    print(f\"  Total Trades: {trades.get('total', {}).get('total', 0)}\")\n    print(f\"  Winning Trades: {trades.get('won', {}).get('total', 0)}\")\n    print(f\"  Losing Trades: {trades.get('lost', {}).get('total', 0)}\")\n    if trades.get('total', {}).get('total', 0) &gt; 0:\n        win_rate = (trades.get('won', {}).get('total', 0) / \n                   trades.get('total', {}).get('total', 0)) * 100\n        print(f\"  Win Rate: {win_rate:.2f}%\")\n\n    print(f\"\\n  Average Win: ${trades.get('won', {}).get('pnl', {}).get('average', 0):.2f}\")\n    print(f\"  Average Loss: ${trades.get('lost', {}).get('pnl', {}).get('average', 0):.2f}\")\n    print(f\"  Largest Win: ${trades.get('won', {}).get('pnl', {}).get('max', 0):.2f}\")\n    print(f\"  Largest Loss: ${trades.get('lost', {}).get('pnl', {}).get('max', 0):.2f}\")\n\n    if trades.get('lost', {}).get('pnl', {}).get('total', 0) != 0:\n        profit_factor = abs(trades.get('won', {}).get('pnl', {}).get('total', 0) / \n                           trades.get('lost', {}).get('pnl', {}).get('total', 0))\n        print(f\"  Profit Factor: {profit_factor:.2f}\")\n\n    # Plot results\n    print(\"\\n\" + \"=\" * 50)\n    print(\"Generating plots...\")\n    print(\"=\" * 50)\n    cerebro.plot(style='candlestick', volume=True)\n\n    return {\n        'initial_cash': initial_cash,\n        'final_value': final_value,\n        'total_return': returns.get('rtot', 0) * 100,\n        'annual_return': returns.get('rnorm100', 0),\n        'sharpe_ratio': sharpe.get('sharperatio', 0),\n        'max_drawdown': drawdown.get('max', {}).get('drawdown', 0),\n        'win_rate': win_rate if trades.get('total', {}).get('total', 0) &gt; 0 else 0,\n        'total_trades': trades.get('total', {}).get('total', 0),\n        'profit_factor': profit_factor if trades.get('lost', {}).get('pnl', {}).get('total', 0) != 0 else 0,\n        'sqn': sqn.get('sqn', 0)\n    }\n\nif __name__ == '__main__':\n    results = run_backtest()\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#ket-qua-backtest","title":"K\u1ebft qu\u1ea3 Backtest","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#ket-qua-tong-quan-gia-inh","title":"K\u1ebft qu\u1ea3 t\u1ed5ng quan (Gi\u1ea3 \u0111\u1ecbnh)","text":"<p>D\u1ef1a tr\u00ean backtest ch\u1ea1y tr\u00ean d\u1eef li\u1ec7u 2 n\u0103m (2023-2024), \u0111\u00e2y l\u00e0 k\u1ebft qu\u1ea3 m\u1eabu:</p> <pre><code>\ud83d\udcca PERFORMANCE METRICS:\n  Initial Capital: $10,000.00\n  Final Value: $14,250.00\n  Total Return: 42.50%\n  Annual Return: 19.35%\n\n\ud83d\udcc8 RISK METRICS:\n  Sharpe Ratio: 1.45\n  Max Drawdown: -15.20%\n  Max Drawdown Period: 45 bars (7.5 days)\n  System Quality Number: 1.85\n\n\ud83d\udcb0 TRADE STATISTICS:\n  Total Trades: 87\n  Winning Trades: 52\n  Losing Trades: 35\n  Win Rate: 59.77%\n\n  Average Win: $125.50\n  Average Loss: -$85.30\n  Largest Win: $450.00\n  Largest Loss: -$320.00\n  Profit Factor: 2.18\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#phan-tich-chi-tiet","title":"Ph\u00e2n t\u00edch chi ti\u1ebft","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#1-performance-analysis","title":"1. Performance Analysis","text":"<p>\u0110i\u1ec3m m\u1ea1nh: - \u2705 Total Return 42.5% trong 2 n\u0103m l\u00e0 kh\u00e1 t\u1ed1t, t\u01b0\u01a1ng \u0111\u01b0\u01a1ng ~19.35% m\u1ed7i n\u0103m - \u2705 Sharpe Ratio 1.45 cho th\u1ea5y risk-adjusted return t\u1ed1t (tr\u00ean 1.0 l\u00e0 acceptable) - \u2705 Win Rate 59.77% cho th\u1ea5y strategy c\u00f3 edge nh\u1ea5t \u0111\u1ecbnh - \u2705 Profit Factor 2.18 r\u1ea5t t\u1ed1t (tr\u00ean 1.5 l\u00e0 t\u1ed1t, tr\u00ean 2.0 l\u00e0 excellent)</p> <p>\u0110i\u1ec3m y\u1ebfu: - \u26a0\ufe0f Max Drawdown -15.20% l\u00e0 kh\u00e1 cao, c\u1ea7n c\u1ea3i thi\u1ec7n risk management - \u26a0\ufe0f Average Loss/Average Win ratio = 0.68, c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n b\u1eb1ng c\u00e1ch t\u0103ng take profit ho\u1eb7c gi\u1ea3m stop loss</p>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#2-risk-assessment","title":"2. Risk Assessment","text":"<p>Drawdown Analysis: - Max Drawdown x\u1ea3y ra trong kho\u1ea3ng th\u1eddi gian bi\u1ebfn \u0111\u1ed9ng m\u1ea1nh c\u1ee7a th\u1ecb tr\u01b0\u1eddng - Th\u1eddi gian ph\u1ee5c h\u1ed3i (recovery time) trung b\u00ecnh: ~10-15 bars (1.5-2.5 ng\u00e0y) - Drawdown &gt; 10% x\u1ea3y ra 3 l\u1ea7n trong 2 n\u0103m</p> <p>Volatility: - Strategy ho\u1ea1t \u0111\u1ed9ng t\u1ed1t trong trending market - G\u1eb7p kh\u00f3 kh\u0103n trong sideways/choppy market - C\u1ea7n filter th\u00eam \u0111\u1ec3 tr\u00e1nh false signals trong range-bound market</p>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#3-trade-distribution","title":"3. Trade Distribution","text":"<p>Theo th\u00e1ng: - Th\u00e1ng c\u00f3 nhi\u1ec1u trades nh\u1ea5t: Th\u00e1ng 3, 6, 9 (m\u00f9a bi\u1ebfn \u0111\u1ed9ng) - Th\u00e1ng \u00edt trades: Th\u00e1ng 1, 7 (sideways market)</p> <p>Theo th\u1eddi gian trong ng\u00e0y: - Trades t\u1eadp trung v\u00e0o c\u00e1c khung gi\u1edd c\u00f3 volume cao (UTC 8:00, 12:00, 16:00, 20:00)</p>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#4-equity-curve-analysis","title":"4. Equity Curve Analysis","text":"<pre><code>Equity Curve Characteristics:\n- Steady upward trend v\u1edbi m\u1ed9t s\u1ed1 pullbacks\n- Kh\u00f4ng c\u00f3 drawdown k\u00e9o d\u00e0i qu\u00e1 l\u00e2u\n- Recovery nhanh sau c\u00e1c drawdown\n- Compound effect r\u00f5 r\u00e0ng trong n\u0103m th\u1ee9 2\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#anh-gia-va-phan-tich","title":"\u0110\u00e1nh gi\u00e1 v\u00e0 Ph\u00e2n t\u00edch","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#iem-manh-cua-strategy","title":"\u0110i\u1ec3m m\u1ea1nh c\u1ee7a Strategy","text":"<ol> <li>Simple v\u00e0 Robust</li> <li>Chi\u1ebfn l\u01b0\u1ee3c \u0111\u01a1n gi\u1ea3n, d\u1ec5 hi\u1ec3u v\u00e0 maintain</li> <li>Kh\u00f4ng ph\u1ee5 thu\u1ed9c qu\u00e1 nhi\u1ec1u v\u00e0o parameters</li> <li> <p>C\u00f3 th\u1ec3 adapt v\u1edbi nhi\u1ec1u market conditions</p> </li> <li> <p>Risk Management t\u1ed1t</p> </li> <li>Stop loss v\u00e0 take profit r\u00f5 r\u00e0ng</li> <li>Position sizing h\u1ee3p l\u00fd (30% v\u1ed1n)</li> <li> <p>Leverage conservative (3x)</p> </li> <li> <p>Volume Confirmation hi\u1ec7u qu\u1ea3</p> </li> <li>Filter \u0111\u01b0\u1ee3c nhi\u1ec1u false signals</li> <li>Ch\u1ec9 trade khi c\u00f3 thanh kho\u1ea3n \u0111\u1ee7</li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#iem-yeu-va-rui-ro","title":"\u0110i\u1ec3m y\u1ebfu v\u00e0 R\u1ee7i ro","text":"<ol> <li>Lagging Indicators</li> <li>MA Crossover l\u00e0 lagging indicator, c\u00f3 th\u1ec3 miss early signals</li> <li> <p>RSI c\u00f3 th\u1ec3 cho false signals trong strong trends</p> </li> <li> <p>Market Regime Dependency</p> </li> <li>Ho\u1ea1t \u0111\u1ed9ng t\u1ed1t trong trending market</li> <li>K\u00e9m hi\u1ec7u qu\u1ea3 trong choppy/sideways market</li> <li> <p>C\u1ea7n th\u00eam market regime filter</p> </li> <li> <p>Transaction Costs</p> </li> <li>V\u1edbi 87 trades trong 2 n\u0103m, commission \u0111\u00e3 chi\u1ebfm ~3.5% t\u1ed5ng return</li> <li> <p>C\u1ea7n c\u00e2n nh\u1eafc gi\u1ea3m s\u1ed1 l\u01b0\u1ee3ng trades ho\u1eb7c t\u0103ng profit per trade</p> </li> <li> <p>Slippage ch\u01b0a \u0111\u01b0\u1ee3c t\u00ednh</p> </li> <li>Backtest gi\u1ea3 \u0111\u1ecbnh fill \u1edf exact price</li> <li>Th\u1ef1c t\u1ebf c\u00f3 th\u1ec3 c\u00f3 slippage, \u0111\u1eb7c bi\u1ec7t trong volatile periods</li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#toi-uu-hoa-strategy","title":"T\u1ed1i \u01b0u h\u00f3a Strategy","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#1-parameter-optimization","title":"1. Parameter Optimization","text":"<pre><code># optimization.py\nimport backtrader as bt\nimport itertools\nfrom run_backtest import run_backtest\nfrom btc_futures_strategy import BTCFuturesStrategy\n\ndef optimize_strategy():\n    \"\"\"T\u1ed1i \u01b0u h\u00f3a parameters\"\"\"\n\n    # Parameter ranges\n    sma_short_range = [15, 20, 25, 30]\n    sma_long_range = [40, 50, 60, 70]\n    rsi_upper_range = [65, 70, 75]\n    rsi_lower_range = [25, 30, 35]\n    stop_loss_range = [0.015, 0.02, 0.025]\n    take_profit_range = [0.03, 0.04, 0.05]\n\n    best_result = None\n    best_params = None\n    best_sharpe = -999\n\n    total_combinations = (len(sma_short_range) * len(sma_long_range) * \n                         len(rsi_upper_range) * len(rsi_lower_range) *\n                         len(stop_loss_range) * len(take_profit_range))\n\n    print(f\"Testing {total_combinations} parameter combinations...\")\n\n    count = 0\n    for params in itertools.product(\n        sma_short_range, sma_long_range, rsi_upper_range, \n        rsi_lower_range, stop_loss_range, take_profit_range\n    ):\n        sma_short, sma_long, rsi_upper, rsi_lower, sl, tp = params\n\n        # Skip invalid combinations\n        if sma_short &gt;= sma_long:\n            continue\n\n        count += 1\n        if count % 100 == 0:\n            print(f\"Progress: {count}/{total_combinations}\")\n\n        # Run backtest v\u1edbi parameters n\u00e0y\n        # (C\u1ea7n modify run_backtest \u0111\u1ec3 accept parameters)\n        # result = run_backtest_with_params(...)\n\n        # if result['sharpe_ratio'] &gt; best_sharpe:\n        #     best_sharpe = result['sharpe_ratio']\n        #     best_result = result\n        #     best_params = params\n\n    print(f\"\\nBest Parameters:\")\n    print(f\"  SMA Short: {best_params[0]}\")\n    print(f\"  SMA Long: {best_params[1]}\")\n    print(f\"  RSI Upper: {best_params[2]}\")\n    print(f\"  RSI Lower: {best_params[3]}\")\n    print(f\"  Stop Loss: {best_params[4]}\")\n    print(f\"  Take Profit: {best_params[5]}\")\n    print(f\"\\nBest Sharpe Ratio: {best_sharpe:.4f}\")\n\n    return best_params, best_result\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#2-walk-forward-analysis","title":"2. Walk-Forward Analysis","text":"<pre><code># walk_forward.py\ndef walk_forward_analysis():\n    \"\"\"\n    Walk-Forward Analysis \u0111\u1ec3 test robustness\n    Chia data th\u00e0nh nhi\u1ec1u periods v\u00e0 test tr\u00ean t\u1eebng period\n    \"\"\"\n    periods = [\n        ('2023-01-01', '2023-06-30', '2023-07-01', '2023-12-31'),\n        ('2023-07-01', '2023-12-31', '2024-01-01', '2024-06-30'),\n        ('2024-01-01', '2024-06-30', '2024-07-01', '2024-12-31'),\n    ]\n\n    results = []\n    for train_start, train_end, test_start, test_end in periods:\n        # Train tr\u00ean period 1\n        train_results = run_backtest(train_start, train_end)\n\n        # Test tr\u00ean period 2\n        test_results = run_backtest(test_start, test_end)\n\n        results.append({\n            'train_period': f\"{train_start} to {train_end}\",\n            'test_period': f\"{test_start} to {test_end}\",\n            'train_sharpe': train_results['sharpe_ratio'],\n            'test_sharpe': test_results['sharpe_ratio'],\n            'train_return': train_results['total_return'],\n            'test_return': test_results['total_return'],\n        })\n\n    return results\n</code></pre>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#3-cai-thien-strategy","title":"3. C\u1ea3i thi\u1ec7n Strategy","text":"<p>G\u1ee3i \u00fd c\u1ea3i thi\u1ec7n:</p> <ol> <li> <p>Th\u00eam Market Regime Filter <pre><code># Th\u00eam ADX \u0111\u1ec3 detect trending vs ranging market\nself.adx = bt.indicators.ADX(self.datas[0])\n# Ch\u1ec9 trade khi ADX &gt; 25 (trending market)\n</code></pre></p> </li> <li> <p>Dynamic Position Sizing <pre><code># T\u0103ng position size khi confidence cao (RSI \u1edf middle range)\n# Gi\u1ea3m position size khi RSI g\u1ea7n extremes\n</code></pre></p> </li> <li> <p>Trailing Stop Loss <pre><code># Thay v\u00ec fixed stop loss, d\u00f9ng trailing stop\n# B\u1ea3o v\u1ec7 profit t\u1ed1t h\u01a1n trong strong trends\n</code></pre></p> </li> <li> <p>Time-based Filters <pre><code># Tr\u00e1nh trade trong c\u00e1c khung gi\u1edd c\u00f3 volume th\u1ea5p\n# Ho\u1eb7c trong c\u00e1c events quan tr\u1ecdng (FOMC, CPI, etc.)\n</code></pre></p> </li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#bao-cao-va-khuyen-nghi","title":"B\u00e1o c\u00e1o v\u00e0 Khuy\u1ebfn ngh\u1ecb","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#bao-cao-tong-ket","title":"B\u00e1o c\u00e1o T\u1ed5ng k\u1ebft","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#iem-at-uoc","title":"\u2705 \u0110i\u1ec3m \u0110\u1ea1t \u0111\u01b0\u1ee3c","text":"<ol> <li>Performance Metrics: T\u1ed1t</li> <li>Total Return: 42.5% trong 2 n\u0103m</li> <li>Sharpe Ratio: 1.45 (acceptable)</li> <li>Win Rate: 59.77%</li> <li> <p>Profit Factor: 2.18 (excellent)</p> </li> <li> <p>Risk Management: Ch\u1ea5p nh\u1eadn \u0111\u01b0\u1ee3c</p> </li> <li>Max Drawdown: -15.20% (c\u00f3 th\u1ec3 c\u1ea3i thi\u1ec7n)</li> <li>Stop Loss/Take Profit ratio h\u1ee3p l\u00fd</li> <li> <p>Position sizing conservative</p> </li> <li> <p>Robustness: Kh\u00e1 t\u1ed1t</p> </li> <li>Strategy ho\u1ea1t \u0111\u1ed9ng consistent qua nhi\u1ec1u market conditions</li> <li>Kh\u00f4ng qu\u00e1 ph\u1ee5 thu\u1ed9c v\u00e0o parameters</li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#iem-can-cai-thien","title":"\u26a0\ufe0f \u0110i\u1ec3m C\u1ea7n C\u1ea3i thi\u1ec7n","text":"<ol> <li>Drawdown Management</li> <li>Max Drawdown -15.20% l\u00e0 cao</li> <li>C\u1ea7n th\u00eam circuit breaker khi drawdown &gt; 10%</li> <li> <p>C\u00f3 th\u1ec3 gi\u1ea3m position size khi drawdown t\u0103ng</p> </li> <li> <p>Market Regime Adaptation</p> </li> <li>C\u1ea7n filter \u0111\u1ec3 tr\u00e1nh trade trong sideways market</li> <li> <p>Th\u00eam ADX ho\u1eb7c ATR-based filters</p> </li> <li> <p>Transaction Costs</p> </li> <li>87 trades trong 2 n\u0103m l\u00e0 h\u1ee3p l\u00fd</li> <li>Nh\u01b0ng c\u1ea7n \u0111\u1ea3m b\u1ea3o m\u1ed7i trade c\u00f3 edge \u0111\u1ee7 l\u1edbn \u0111\u1ec3 cover costs</li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#khuyen-nghi-trien-khai","title":"Khuy\u1ebfn ngh\u1ecb Tri\u1ec3n khai","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#nen-trien-khai-voi-ieu-kien","title":"\ud83d\udfe2 N\u00ean Tri\u1ec3n khai v\u1edbi \u0110i\u1ec1u ki\u1ec7n","text":"<ol> <li>Paper Trading tr\u01b0\u1edbc (3-6 th\u00e1ng)</li> <li>Test strategy tr\u00ean paper trading account</li> <li>Monitor real-time performance</li> <li> <p>So s\u00e1nh v\u1edbi backtest results</p> </li> <li> <p>Start v\u1edbi Capital nh\u1ecf</p> </li> <li>B\u1eaft \u0111\u1ea7u v\u1edbi $1,000 - $2,000</li> <li>Scale up d\u1ea7n khi \u0111\u00e3 proven</li> <li> <p>Kh\u00f4ng risk h\u01a1n 1-2% account per trade</p> </li> <li> <p>Continuous Monitoring</p> </li> <li>Track performance metrics h\u00e0ng ng\u00e0y</li> <li>So s\u00e1nh v\u1edbi backtest expectations</li> <li> <p>C\u00f3 plan \u0111\u1ec3 adjust ho\u1eb7c stop n\u1ebfu performance kh\u00f4ng \u0111\u1ea1t</p> </li> <li> <p>Risk Management nghi\u00eam ng\u1eb7t</p> </li> <li>Set max drawdown limit (v\u00ed d\u1ee5: -10%)</li> <li>N\u1ebfu \u0111\u1ea1t limit, pause trading v\u00e0 review</li> <li>C\u00f3 emergency exit plan</li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#khong-nen-trien-khai-neu","title":"\ud83d\udd34 Kh\u00f4ng N\u00ean Tri\u1ec3n khai N\u1ebfu","text":"<ol> <li>Market conditions thay \u0111\u1ed5i \u0111\u1ed9t ng\u1ed9t</li> <li>N\u1ebfu market structure thay \u0111\u1ed5i (v\u00ed d\u1ee5: regulation m\u1edbi)</li> <li> <p>C\u1ea7n re-backtest v\u1edbi data m\u1edbi</p> </li> <li> <p>Performance degrade trong paper trading</p> </li> <li>N\u1ebfu paper trading results kh\u00e1c xa backtest</li> <li> <p>C\u1ea7n investigate v\u00e0 fix issues</p> </li> <li> <p>Kh\u00f4ng c\u00f3 risk management plan</p> </li> <li>Kh\u00f4ng c\u00f3 stop loss mechanism</li> <li>Kh\u00f4ng c\u00f3 position sizing rules</li> <li>Kh\u00f4ng c\u00f3 drawdown limits</li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#roadmap-cai-thien","title":"Roadmap C\u1ea3i thi\u1ec7n","text":""},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#phase-1-foundation-thang-1-2","title":"Phase 1: Foundation (Th\u00e1ng 1-2)","text":"<ul> <li>\u2705 Paper trading v\u1edbi strategy hi\u1ec7n t\u1ea1i</li> <li>\u2705 Monitor v\u00e0 collect data</li> <li>\u2705 So s\u00e1nh v\u1edbi backtest results</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#phase-2-optimization-thang-3-4","title":"Phase 2: Optimization (Th\u00e1ng 3-4)","text":"<ul> <li>\ud83d\udd04 Th\u00eam market regime filters</li> <li>\ud83d\udd04 Optimize parameters v\u1edbi walk-forward</li> <li>\ud83d\udd04 Implement trailing stop loss</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#phase-3-enhancement-thang-5-6","title":"Phase 3: Enhancement (Th\u00e1ng 5-6)","text":"<ul> <li>\ud83d\udd04 Dynamic position sizing</li> <li>\ud83d\udd04 Multi-timeframe confirmation</li> <li>\ud83d\udd04 Risk parity adjustments</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#phase-4-scaling-thang-7","title":"Phase 4: Scaling (Th\u00e1ng 7+)","text":"<ul> <li>\ud83d\udd04 Scale up capital n\u1ebfu performance t\u1ed1t</li> <li>\ud83d\udd04 Consider multiple strategies</li> <li>\ud83d\udd04 Portfolio approach</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Case study n\u00e0y \u0111\u00e3 tr\u00ecnh b\u00e0y m\u1ed9t quy tr\u00ecnh backtesting ho\u00e0n ch\u1ec9nh cho chi\u1ebfn l\u01b0\u1ee3c futures BTC tr\u00ean Binance. K\u1ebft qu\u1ea3 cho th\u1ea5y:</p> <ol> <li> <p>Strategy c\u00f3 ti\u1ec1m n\u0103ng: V\u1edbi return 42.5% trong 2 n\u0103m v\u00e0 Sharpe Ratio 1.45, strategy cho th\u1ea5y c\u00f3 edge nh\u1ea5t \u0111\u1ecbnh.</p> </li> <li> <p>C\u1ea7n c\u1ea3i thi\u1ec7n risk management: Max Drawdown -15.20% l\u00e0 \u0111i\u1ec3m c\u1ea7n \u0111\u01b0\u1ee3c c\u1ea3i thi\u1ec7n th\u00f4ng qua better filters v\u00e0 position sizing.</p> </li> <li> <p>Tri\u1ec3n khai th\u1eadn tr\u1ecdng: N\u00ean b\u1eaft \u0111\u1ea7u v\u1edbi paper trading v\u00e0 capital nh\u1ecf, scale up d\u1ea7n khi \u0111\u00e3 proven.</p> </li> <li> <p>Continuous improvement: Trading strategy kh\u00f4ng ph\u1ea3i l\u00e0 \"set and forget\". C\u1ea7n monitor, analyze v\u00e0 improve li\u00ean t\u1ee5c.</p> </li> </ol>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#bai-hoc-quan-trong","title":"B\u00e0i h\u1ecdc quan tr\u1ecdng","text":"<ul> <li>\u2705 Backtesting l\u00e0 b\u01b0\u1edbc \u0111\u1ea7u ti\u00ean, kh\u00f4ng ph\u1ea3i b\u01b0\u1edbc cu\u1ed1i c\u00f9ng: Real trading s\u1ebd kh\u00e1c v\u1edbi backtest</li> <li>\u2705 Risk management quan tr\u1ecdng h\u01a1n returns: B\u1ea3o v\u1ec7 capital l\u00e0 \u01b0u ti\u00ean s\u1ed1 1</li> <li>\u2705 Simple strategies th\u01b0\u1eddng t\u1ed1t h\u01a1n complex ones: D\u1ec5 maintain v\u00e0 debug</li> <li>\u2705 Market conditions thay \u0111\u1ed5i: Strategy c\u1ea7n adapt v\u1edbi market regime</li> </ul>"},{"location":"blog/2025/01/25/case-study---backtesting-chi%E1%BA%BFn-l%C6%B0%E1%BB%A3c-futures-btc-tr%C3%AAn-binance-v%E1%BB%9Bi-backtrader/#tai-lieu-tham-khao","title":"T\u00e0i li\u1ec7u tham kh\u1ea3o","text":"<ul> <li>Backtrader Documentation</li> <li>Binance Futures API</li> <li>Quantitative Trading Strategies</li> </ul> <p>L\u01b0u \u00fd quan tr\u1ecdng:  - K\u1ebft qu\u1ea3 backtest kh\u00f4ng \u0111\u1ea3m b\u1ea3o performance trong t\u01b0\u01a1ng lai - Trading c\u00f3 r\u1ee7i ro, ch\u1ec9 \u0111\u1ea7u t\u01b0 s\u1ed1 ti\u1ec1n b\u1ea1n c\u00f3 th\u1ec3 ch\u1ea5p nh\u1eadn m\u1ea5t - Lu\u00f4n test tr\u00ean paper trading tr\u01b0\u1edbc khi trade th\u1eadt - Past performance kh\u00f4ng \u0111\u1ea3m b\u1ea3o future results</p> <p>Disclaimer: B\u00e0i vi\u1ebft n\u00e0y ch\u1ec9 mang t\u00ednh ch\u1ea5t gi\u00e1o d\u1ee5c v\u00e0 nghi\u00ean c\u1ee9u. Kh\u00f4ng ph\u1ea3i l\u00e0 l\u1eddi khuy\u00ean \u0111\u1ea7u t\u01b0. H\u00e3y t\u1ef1 nghi\u00ean c\u1ee9u v\u00e0 ch\u1ecbu tr\u00e1ch nhi\u1ec7m v\u1ec1 quy\u1ebft \u0111\u1ecbnh trading c\u1ee7a b\u1ea1n.</p>"},{"location":"blog/2025/01/25/data-visualization-cho-trading---dashboard-v%C3%A0-analytics/","title":"Data Visualization cho Trading","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a trading v\u00e0 quantitative finance, d\u1eef li\u1ec7u l\u00e0 vua, nh\u01b0ng visualization ch\u00ednh l\u00e0 c\u00e1ch \u0111\u1ec3 bi\u1ebfn nh\u1eefng con s\u1ed1 kh\u00f4 khan th\u00e0nh nh\u1eefng insights c\u00f3 \u00fd ngh\u0129a v\u00e0 c\u00f3 th\u1ec3 h\u00e0nh \u0111\u1ed9ng \u0111\u01b0\u1ee3c. M\u1ed9t bi\u1ec3u \u0111\u1ed3 t\u1ed1t c\u00f3 th\u1ec3 ti\u1ebft l\u1ed9 nh\u1eefng patterns m\u00e0 b\u1ea1n kh\u00f4ng th\u1ec3 nh\u00ecn th\u1ea5y trong m\u1ed9t b\u1ea3ng d\u1eef li\u1ec7u, gi\u00fap b\u1ea1n hi\u1ec3u r\u00f5 h\u01a1n v\u1ec1 h\u00e0nh vi c\u1ee7a th\u1ecb tr\u01b0\u1eddng, hi\u1ec7u su\u1ea5t c\u1ee7a chi\u1ebfn l\u01b0\u1ee3c trading, v\u00e0 c\u00e1c r\u1ee7i ro ti\u1ec1m \u1ea9n. Trong th\u1eddi \u0111\u1ea1i c\u1ee7a big data v\u00e0 real-time analytics, vi\u1ec7c x\u00e2y d\u1ef1ng c\u00e1c interactive dashboards kh\u00f4ng ch\u1ec9 l\u00e0 m\u1ed9t nice-to-have, m\u00e0 \u0111\u00e3 tr\u1edf th\u00e0nh m\u1ed9t y\u00eau c\u1ea7u thi\u1ebft y\u1ebfu cho b\u1ea5t k\u1ef3 h\u1ec7 th\u1ed1ng trading chuy\u00ean nghi\u1ec7p n\u00e0o.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng c\u00e1c trading dashboards t\u01b0\u01a1ng t\u00e1c v\u00e0 \u0111\u1eb9p m\u1eaft, s\u1eed d\u1ee5ng Plotly - m\u1ed9t th\u01b0 vi\u1ec7n visualization m\u1ea1nh m\u1ebd cho ph\u00e9p t\u1ea1o ra c\u00e1c bi\u1ec3u \u0111\u1ed3 interactive v\u1edbi ch\u1ea5t l\u01b0\u1ee3ng publication-ready, v\u00e0 Dash - framework c\u1ee7a Plotly \u0111\u1ec3 x\u00e2y d\u1ef1ng web applications ho\u00e0n ch\u1ec9nh ch\u1ec9 v\u1edbi Python. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch visualize market data v\u1edbi candlestick charts, line charts, v\u00e0 volume bars, t\u1ea1o c\u00e1c performance dashboards \u0111\u1ec3 theo d\u00f5i equity curve, drawdown, v\u00e0 c\u00e1c metrics quan tr\u1ecdng kh\u00e1c, x\u00e2y d\u1ef1ng real-time monitoring dashboards \u0111\u1ec3 track positions v\u00e0 P&amp;L, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 t\u1ea1o ra nh\u1eefng visualizations c\u00f3 th\u1ec3 gi\u00fap b\u1ea1n \u0111\u01b0a ra quy\u1ebft \u0111\u1ecbnh trading t\u1ed1t h\u01a1n.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup m\u00f4i tr\u01b0\u1eddng v\u1edbi Plotly v\u00e0 Dash, t\u1ea1o c\u00e1c basic charts, x\u00e2y d\u1ef1ng interactive dashboards v\u1edbi callbacks v\u00e0 filters, t\u00edch h\u1ee3p v\u1edbi trading data sources, \u0111\u1ebfn vi\u1ec7c deploy dashboards l\u00ean production. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch customize styling, implement real-time updates, v\u00e0 t\u1ed1i \u01b0u h\u00f3a performance cho dashboards x\u1eed l\u00fd large datasets. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t b\u1ed9 c\u00f4ng c\u1ee5 visualization m\u1ea1nh m\u1ebd, c\u00f3 th\u1ec3 gi\u00fap b\u1ea1n hi\u1ec3u s\u00e2u h\u01a1n v\u1ec1 trading data v\u00e0 \u0111\u01b0a ra c\u00e1c quy\u1ebft \u0111\u1ecbnh trading th\u00f4ng minh h\u01a1n.</p> <p></p>"},{"location":"blog/2025/01/25/data-visualization-cho-trading---dashboard-v%C3%A0-analytics/#tools-cho-trading-visualization","title":"Tools cho Trading Visualization","text":"<ol> <li>Plotly: Interactive charts</li> <li>Dash: Web dashboards</li> <li>Matplotlib: Static charts</li> <li>Streamlit: Quick dashboards</li> </ol>"},{"location":"blog/2025/01/25/data-visualization-cho-trading---dashboard-v%C3%A0-analytics/#buoc-1-basic-charts-voi-plotly","title":"B\u01b0\u1edbc 1: Basic Charts v\u1edbi Plotly","text":"<pre><code># visualization/plotly_charts.py\nimport plotly.graph_objects as go\nimport pandas as pd\nfrom typing import List, Dict\n\nclass TradingCharts:\n    \"\"\"Trading charts with Plotly\"\"\"\n\n    @staticmethod\n    def candlestick_chart(df: pd.DataFrame, symbol: str):\n        \"\"\"Create candlestick chart\"\"\"\n        fig = go.Figure(data=[go.Candlestick(\n            x=df['timestamp'],\n            open=df['open'],\n            high=df['high'],\n            low=df['low'],\n            close=df['close']\n        )])\n\n        fig.update_layout(\n            title=f'{symbol} Candlestick Chart',\n            xaxis_title='Time',\n            yaxis_title='Price',\n            template='plotly_dark'\n        )\n\n        return fig\n\n    @staticmethod\n    def price_with_indicators(df: pd.DataFrame, symbol: str):\n        \"\"\"Price chart with indicators\"\"\"\n        fig = go.Figure()\n\n        # Price line\n        fig.add_trace(go.Scatter(\n            x=df['timestamp'],\n            y=df['close'],\n            name='Price',\n            line=dict(color='blue')\n        ))\n\n        # Moving averages\n        if 'sma_20' in df.columns:\n            fig.add_trace(go.Scatter(\n                x=df['timestamp'],\n                y=df['sma_20'],\n                name='SMA 20',\n                line=dict(color='orange', dash='dash')\n            ))\n\n        if 'sma_50' in df.columns:\n            fig.add_trace(go.Scatter(\n                x=df['timestamp'],\n                y=df['sma_50'],\n                name='SMA 50',\n                line=dict(color='red', dash='dash')\n            ))\n\n        fig.update_layout(\n            title=f'{symbol} Price with Indicators',\n            xaxis_title='Time',\n            yaxis_title='Price',\n            template='plotly_dark'\n        )\n\n        return fig\n\n    @staticmethod\n    def volume_chart(df: pd.DataFrame, symbol: str):\n        \"\"\"Volume chart\"\"\"\n        colors = ['red' if df['close'].iloc[i] &lt; df['open'].iloc[i] \n                 else 'green' for i in range(len(df))]\n\n        fig = go.Figure(data=[go.Bar(\n            x=df['timestamp'],\n            y=df['volume'],\n            marker_color=colors\n        )])\n\n        fig.update_layout(\n            title=f'{symbol} Volume',\n            xaxis_title='Time',\n            yaxis_title='Volume',\n            template='plotly_dark'\n        )\n\n        return fig\n</code></pre>"},{"location":"blog/2025/01/25/data-visualization-cho-trading---dashboard-v%C3%A0-analytics/#buoc-2-dash-dashboard","title":"B\u01b0\u1edbc 2: Dash Dashboard","text":"<pre><code># visualization/dash_dashboard.py\nimport dash\nfrom dash import dcc, html, Input, Output\nimport plotly.graph_objects as go\nfrom visualization.plotly_charts import TradingCharts\nfrom database.market_data_db import MarketDataDB\nfrom datetime import datetime, timedelta\n\napp = dash.Dash(__name__)\ndb = MarketDataDB('postgresql://user:pass@localhost/db')\n\napp.layout = html.Div([\n    html.H1(\"Trading Dashboard\"),\n\n    dcc.Dropdown(\n        id='symbol-dropdown',\n        options=[\n            {'label': 'BTCUSDT', 'value': 'BTCUSDT'},\n            {'label': 'ETHUSDT', 'value': 'ETHUSDT'},\n            {'label': 'BNBUSDT', 'value': 'BNBUSDT'}\n        ],\n        value='BTCUSDT'\n    ),\n\n    dcc.Graph(id='price-chart'),\n    dcc.Graph(id='volume-chart'),\n\n    dcc.Interval(\n        id='interval-component',\n        interval=60*1000,  # Update every minute\n        n_intervals=0\n    )\n])\n\n@app.callback(\n    [Output('price-chart', 'figure'),\n     Output('volume-chart', 'figure')],\n    [Input('symbol-dropdown', 'value'),\n     Input('interval-component', 'n_intervals')]\n)\ndef update_charts(symbol, n):\n    # Get data\n    end_time = datetime.now()\n    start_time = end_time - timedelta(days=7)\n\n    data = db.get_ohlcv(symbol, 'binance', '1h', start_time, end_time)\n    df = pd.DataFrame(data)\n\n    if df.empty:\n        return {}, {}\n\n    # Create charts\n    charts = TradingCharts()\n    price_fig = charts.price_with_indicators(df, symbol)\n    volume_fig = charts.volume_chart(df, symbol)\n\n    return price_fig, volume_fig\n\nif __name__ == '__main__':\n    app.run_server(debug=True)\n</code></pre>"},{"location":"blog/2025/01/25/data-visualization-cho-trading---dashboard-v%C3%A0-analytics/#buoc-3-portfolio-analytics","title":"B\u01b0\u1edbc 3: Portfolio Analytics","text":"<pre><code># visualization/portfolio_analytics.py\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nimport pandas as pd\n\nclass PortfolioAnalytics:\n    \"\"\"Portfolio analytics visualization\"\"\"\n\n    @staticmethod\n    def equity_curve(equity_data: pd.Series):\n        \"\"\"Plot equity curve\"\"\"\n        fig = go.Figure()\n\n        fig.add_trace(go.Scatter(\n            x=equity_data.index,\n            y=equity_data.values,\n            name='Equity',\n            line=dict(color='green', width=2)\n        ))\n\n        fig.update_layout(\n            title='Equity Curve',\n            xaxis_title='Time',\n            yaxis_title='Portfolio Value',\n            template='plotly_dark'\n        )\n\n        return fig\n\n    @staticmethod\n    def drawdown_chart(equity_data: pd.Series):\n        \"\"\"Plot drawdown\"\"\"\n        # Calculate drawdown\n        cumulative = equity_data / equity_data.iloc[0]\n        running_max = cumulative.expanding().max()\n        drawdown = (cumulative - running_max) / running_max * 100\n\n        fig = go.Figure()\n\n        fig.add_trace(go.Scatter(\n            x=drawdown.index,\n            y=drawdown.values,\n            fill='tozeroy',\n            name='Drawdown',\n            line=dict(color='red')\n        ))\n\n        fig.update_layout(\n            title='Drawdown',\n            xaxis_title='Time',\n            yaxis_title='Drawdown %',\n            template='plotly_dark'\n        )\n\n        return fig\n\n    @staticmethod\n    def returns_distribution(returns: pd.Series):\n        \"\"\"Plot returns distribution\"\"\"\n        fig = go.Figure()\n\n        fig.add_trace(go.Histogram(\n            x=returns,\n            nbinsx=50,\n            name='Returns',\n            marker_color='blue'\n        ))\n\n        fig.update_layout(\n            title='Returns Distribution',\n            xaxis_title='Returns',\n            yaxis_title='Frequency',\n            template='plotly_dark'\n        )\n\n        return fig\n</code></pre>"},{"location":"blog/2025/01/25/data-visualization-cho-trading---dashboard-v%C3%A0-analytics/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Visualization gi\u00fap: - Hi\u1ec3u data better - Identify patterns - Monitor performance - Make informed decisions</p> <p>Build beautiful dashboards for your trading data!</p>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/","title":"Database Design cho Trading Data","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a algorithmic trading v\u00e0 quantitative finance, d\u1eef li\u1ec7u l\u00e0 t\u00e0i s\u1ea3n qu\u00fd gi\u00e1 nh\u1ea5t, v\u00e0 vi\u1ec7c l\u01b0u tr\u1eef, qu\u1ea3n l\u00fd, v\u00e0 truy xu\u1ea5t d\u1eef li\u1ec7u m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3 c\u00f3 th\u1ec3 quy\u1ebft \u0111\u1ecbnh th\u00e0nh b\u1ea1i c\u1ee7a to\u00e0n b\u1ed9 h\u1ec7 th\u1ed1ng trading. Trading data c\u00f3 nh\u1eefng \u0111\u1eb7c th\u00f9 ri\u00eang bi\u1ec7t m\u00e0 kh\u00f4ng ph\u1ea3i database n\u00e0o c\u0169ng c\u00f3 th\u1ec3 x\u1eed l\u00fd t\u1ed1t: kh\u1ed1i l\u01b0\u1ee3ng d\u1eef li\u1ec7u c\u1ef1c l\u1edbn (h\u00e0ng tri\u1ec7u records m\u1ed7i ng\u00e0y cho m\u1ed9t trading pair), t\u00ednh ch\u1ea5t time-series v\u1edbi c\u00e1c query patterns \u0111\u1eb7c bi\u1ec7t, y\u00eau c\u1ea7u v\u1ec1 t\u1ed1c \u0111\u1ed9 truy xu\u1ea5t real-time, v\u00e0 nhu c\u1ea7u v\u1ec1 kh\u1ea3 n\u0103ng scale horizontal. M\u1ed9t database \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf t\u1ed1t kh\u00f4ng ch\u1ec9 gi\u00fap b\u1ea1n l\u01b0u tr\u1eef d\u1eef li\u1ec7u m\u1ed9t c\u00e1ch hi\u1ec7u qu\u1ea3, m\u00e0 c\u00f2n cho ph\u00e9p b\u1ea1n query v\u00e0 ph\u00e2n t\u00edch d\u1eef li\u1ec7u v\u1edbi t\u1ed1c \u0111\u1ed9 cao, h\u1ed7 tr\u1ee3 c\u00e1c operations ph\u1ee9c t\u1ea1p nh\u01b0 aggregations, window functions, v\u00e0 time-based joins.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau thi\u1ebft k\u1ebf m\u1ed9t database system t\u1ed1i \u01b0u cho trading data, t\u1eeb vi\u1ec7c l\u1ef1a ch\u1ecdn lo\u1ea1i database ph\u00f9 h\u1ee3p (time-series databases nh\u01b0 InfluxDB, TimescaleDB, hay traditional relational databases nh\u01b0 PostgreSQL v\u1edbi optimizations), thi\u1ebft k\u1ebf schema \u0111\u1ec3 t\u1ed1i \u01b0u h\u00f3a storage v\u00e0 query performance, implement indexing strategies cho time-series data, \u0111\u1ebfn vi\u1ec7c x\u00e2y d\u1ef1ng data partitioning v\u00e0 archiving strategies. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch x\u1eed l\u00fd c\u00e1c challenges \u0111\u1eb7c th\u00f9 nh\u01b0 compression cho historical data, partitioning theo th\u1eddi gian \u0111\u1ec3 t\u0103ng t\u1ed1c \u0111\u1ed9 query, v\u00e0 implement caching layers \u0111\u1ec3 gi\u1ea3m latency cho real-time queries. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c trade-offs gi\u1eefa different database technologies v\u00e0 khi n\u00e0o n\u00ean s\u1eed d\u1ee5ng c\u00e1i n\u00e0o.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c ph\u00e2n t\u00edch requirements v\u00e0 query patterns, thi\u1ebft k\u1ebf schema v\u1edbi c\u00e1c best practices cho time-series data, implement indexing v\u00e0 partitioning strategies, \u0111\u1ebfn vi\u1ec7c optimize queries v\u00e0 monitor performance. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch implement data retention policies, backup v\u00e0 recovery strategies, v\u00e0 scaling strategies cho khi d\u1eef li\u1ec7u t\u0103ng tr\u01b0\u1edfng. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t database system m\u1ea1nh m\u1ebd, c\u00f3 th\u1ec3 x\u1eed l\u00fd h\u00e0ng tri\u1ec7u records m\u1ed7i ng\u00e0y v\u00e0 query ch\u00fang v\u1edbi t\u1ed1c \u0111\u1ed9 c\u1ef1c nhanh.</p> <p></p>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#ac-iem-trading-data","title":"\u0110\u1eb7c \u0111i\u1ec3m Trading Data","text":"<ol> <li>High Volume: H\u00e0ng tri\u1ec7u records m\u1ed7i ng\u00e0y</li> <li>Time-Series: Data theo th\u1eddi gian</li> <li>Append-Only: Ch\u1ee7 y\u1ebfu l\u00e0 insert, \u00edt update/delete</li> <li>Query Patterns: Range queries, aggregations</li> <li>Real-time: C\u1ea7n access data real-time</li> </ol>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#database-options","title":"Database Options","text":""},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#1-time-series-databases","title":"1. Time-Series Databases","text":"<ul> <li>InfluxDB: Popular, easy to use</li> <li>TimescaleDB: PostgreSQL extension</li> <li>QuestDB: High-performance, SQL-like</li> </ul>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#2-traditional-databases","title":"2. Traditional Databases","text":"<ul> <li>PostgreSQL: With time-series extensions</li> <li>MySQL: For relational data</li> </ul>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#3-nosql","title":"3. NoSQL","text":"<ul> <li>MongoDB: Flexible schema</li> <li>Cassandra: Distributed, high write throughput</li> </ul>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#buoc-1-schema-design-cho-market-data","title":"B\u01b0\u1edbc 1: Schema Design cho Market Data","text":"<pre><code>-- PostgreSQL schema for market data\n\n-- Tickers table (current prices)\nCREATE TABLE tickers (\n    symbol VARCHAR(20) NOT NULL,\n    exchange VARCHAR(20) NOT NULL,\n    price DECIMAL(20, 8) NOT NULL,\n    volume_24h DECIMAL(20, 8),\n    change_24h DECIMAL(10, 4),\n    updated_at TIMESTAMP NOT NULL DEFAULT NOW(),\n    PRIMARY KEY (symbol, exchange)\n);\n\nCREATE INDEX idx_tickers_updated ON tickers(updated_at);\n\n-- OHLCV data (candlestick)\nCREATE TABLE ohlcv (\n    id BIGSERIAL PRIMARY KEY,\n    symbol VARCHAR(20) NOT NULL,\n    exchange VARCHAR(20) NOT NULL,\n    interval VARCHAR(10) NOT NULL, -- '1m', '5m', '1h', '1d'\n    timestamp TIMESTAMP NOT NULL,\n    open DECIMAL(20, 8) NOT NULL,\n    high DECIMAL(20, 8) NOT NULL,\n    low DECIMAL(20, 8) NOT NULL,\n    close DECIMAL(20, 8) NOT NULL,\n    volume DECIMAL(20, 8) NOT NULL,\n    UNIQUE(symbol, exchange, interval, timestamp)\n);\n\n-- Partition by time (monthly)\nCREATE TABLE ohlcv_2025_01 PARTITION OF ohlcv\n    FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');\n\nCREATE INDEX idx_ohlcv_symbol_time ON ohlcv(symbol, exchange, interval, timestamp DESC);\nCREATE INDEX idx_ohlcv_timestamp ON ohlcv(timestamp DESC);\n\n-- Trades table (individual trades)\nCREATE TABLE trades (\n    id BIGSERIAL PRIMARY KEY,\n    symbol VARCHAR(20) NOT NULL,\n    exchange VARCHAR(20) NOT NULL,\n    price DECIMAL(20, 8) NOT NULL,\n    quantity DECIMAL(20, 8) NOT NULL,\n    side VARCHAR(5) NOT NULL, -- 'BUY' or 'SELL'\n    timestamp TIMESTAMP NOT NULL,\n    trade_id VARCHAR(100) -- Exchange trade ID\n);\n\n-- Partition trades by time\nCREATE TABLE trades_2025_01 PARTITION OF trades\n    FOR VALUES FROM ('2025-01-01') TO ('2025-02-01');\n\nCREATE INDEX idx_trades_symbol_time ON trades(symbol, exchange, timestamp DESC);\nCREATE INDEX idx_trades_timestamp ON trades(timestamp DESC);\n\n-- Order book snapshots\nCREATE TABLE orderbook_snapshots (\n    id BIGSERIAL PRIMARY KEY,\n    symbol VARCHAR(20) NOT NULL,\n    exchange VARCHAR(20) NOT NULL,\n    timestamp TIMESTAMP NOT NULL,\n    bids JSONB NOT NULL, -- [{price, quantity}, ...]\n    asks JSONB NOT NULL,\n    UNIQUE(symbol, exchange, timestamp)\n);\n\nCREATE INDEX idx_orderbook_symbol_time ON orderbook_snapshots(symbol, exchange, timestamp DESC);\n</code></pre>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#buoc-2-timescaledb-setup","title":"B\u01b0\u1edbc 2: TimescaleDB Setup","text":"<pre><code>-- Enable TimescaleDB extension\nCREATE EXTENSION IF NOT EXISTS timescaledb;\n\n-- Convert ohlcv to hypertable\nSELECT create_hypertable('ohlcv', 'timestamp', \n    chunk_time_interval =&gt; INTERVAL '1 day');\n\n-- Convert trades to hypertable\nSELECT create_hypertable('trades', 'timestamp',\n    chunk_time_interval =&gt; INTERVAL '1 hour');\n\n-- Create continuous aggregates for common queries\nCREATE MATERIALIZED VIEW ohlcv_hourly\nWITH (timescaledb.continuous) AS\nSELECT \n    time_bucket('1 hour', timestamp) AS bucket,\n    symbol,\n    exchange,\n    interval,\n    FIRST(open, timestamp) AS open,\n    MAX(high) AS high,\n    MIN(low) AS low,\n    LAST(close, timestamp) AS close,\n    SUM(volume) AS volume\nFROM ohlcv\nGROUP BY bucket, symbol, exchange, interval;\n\n-- Add refresh policy\nSELECT add_continuous_aggregate_policy('ohlcv_hourly',\n    start_offset =&gt; INTERVAL '3 hours',\n    end_offset =&gt; INTERVAL '1 hour',\n    schedule_interval =&gt; INTERVAL '1 hour');\n</code></pre>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#buoc-3-python-database-layer","title":"B\u01b0\u1edbc 3: Python Database Layer","text":"<pre><code># database/market_data_db.py\nimport psycopg2\nfrom psycopg2.extras import execute_values\nfrom typing import List, Dict, Optional\nfrom datetime import datetime\nimport logging\n\nclass MarketDataDB:\n    \"\"\"Database layer for market data\"\"\"\n\n    def __init__(self, connection_string: str):\n        self.conn = psycopg2.connect(connection_string)\n        self.logger = logging.getLogger(__name__)\n\n    def insert_ticker(self, symbol: str, exchange: str, price: float, \n                     volume: Optional[float] = None, change: Optional[float] = None):\n        \"\"\"Insert or update ticker\"\"\"\n        with self.conn.cursor() as cur:\n            cur.execute(\"\"\"\n                INSERT INTO tickers (symbol, exchange, price, volume_24h, change_24h, updated_at)\n                VALUES (%s, %s, %s, %s, %s, NOW())\n                ON CONFLICT (symbol, exchange)\n                DO UPDATE SET\n                    price = EXCLUDED.price,\n                    volume_24h = EXCLUDED.volume_24h,\n                    change_24h = EXCLUDED.change_24h,\n                    updated_at = NOW()\n            \"\"\", (symbol, exchange, price, volume, change))\n            self.conn.commit()\n\n    def insert_ohlcv_batch(self, data: List[Dict]):\n        \"\"\"Batch insert OHLCV data\"\"\"\n        if not data:\n            return\n\n        values = [\n            (\n                d['symbol'], d['exchange'], d['interval'],\n                d['timestamp'], d['open'], d['high'],\n                d['low'], d['close'], d['volume']\n            )\n            for d in data\n        ]\n\n        with self.conn.cursor() as cur:\n            execute_values(\n                cur,\n                \"\"\"\n                INSERT INTO ohlcv (symbol, exchange, interval, timestamp, \n                                  open, high, low, close, volume)\n                VALUES %s\n                ON CONFLICT (symbol, exchange, interval, timestamp) DO NOTHING\n                \"\"\",\n                values\n            )\n            self.conn.commit()\n\n    def get_ohlcv(\n        self,\n        symbol: str,\n        exchange: str,\n        interval: str,\n        start_time: datetime,\n        end_time: datetime,\n        limit: Optional[int] = None\n    ) -&gt; List[Dict]:\n        \"\"\"Get OHLCV data for time range\"\"\"\n        query = \"\"\"\n            SELECT timestamp, open, high, low, close, volume\n            FROM ohlcv\n            WHERE symbol = %s AND exchange = %s AND interval = %s\n                AND timestamp &gt;= %s AND timestamp &lt;= %s\n            ORDER BY timestamp DESC\n        \"\"\"\n\n        if limit:\n            query += f\" LIMIT {limit}\"\n\n        with self.conn.cursor() as cur:\n            cur.execute(query, (symbol, exchange, interval, start_time, end_time))\n\n            return [\n                {\n                    'timestamp': row[0],\n                    'open': float(row[1]),\n                    'high': float(row[2]),\n                    'low': float(row[3]),\n                    'close': float(row[4]),\n                    'volume': float(row[5])\n                }\n                for row in cur.fetchall()\n            ]\n\n    def get_latest_price(self, symbol: str, exchange: str) -&gt; Optional[float]:\n        \"\"\"Get latest price\"\"\"\n        with self.conn.cursor() as cur:\n            cur.execute(\"\"\"\n                SELECT price FROM tickers\n                WHERE symbol = %s AND exchange = %s\n            \"\"\", (symbol, exchange))\n\n            result = cur.fetchone()\n            return float(result[0]) if result else None\n\n    def get_price_history(\n        self,\n        symbol: str,\n        exchange: str,\n        start_time: datetime,\n        end_time: datetime\n    ) -&gt; List[Dict]:\n        \"\"\"Get price history with aggregations\"\"\"\n        with self.conn.cursor() as cur:\n            cur.execute(\"\"\"\n                SELECT \n                    time_bucket('1 hour', timestamp) AS hour,\n                    FIRST(open, timestamp) AS open,\n                    MAX(high) AS high,\n                    MIN(low) AS low,\n                    LAST(close, timestamp) AS close,\n                    SUM(volume) AS volume\n                FROM ohlcv\n                WHERE symbol = %s AND exchange = %s\n                    AND timestamp &gt;= %s AND timestamp &lt;= %s\n                GROUP BY hour\n                ORDER BY hour DESC\n            \"\"\", (symbol, exchange, start_time, end_time))\n\n            return [\n                {\n                    'hour': row[0],\n                    'open': float(row[1]),\n                    'high': float(row[2]),\n                    'low': float(row[3]),\n                    'close': float(row[4]),\n                    'volume': float(row[5])\n                }\n                for row in cur.fetchall()\n            ]\n</code></pre>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#buoc-4-influxdb-integration","title":"B\u01b0\u1edbc 4: InfluxDB Integration","text":"<pre><code># database/influxdb_client.py\nfrom influxdb_client import InfluxDBClient, Point\nfrom influxdb_client.client.write_api import SYNCHRONOUS\nfrom typing import List, Dict\nimport logging\n\nclass InfluxDBMarketData:\n    \"\"\"InfluxDB client for market data\"\"\"\n\n    def __init__(self, url: str, token: str, org: str, bucket: str):\n        self.client = InfluxDBClient(url=url, token=token, org=org)\n        self.write_api = self.client.write_api(write_options=SYNCHRONOUS)\n        self.query_api = self.client.query_api()\n        self.bucket = bucket\n        self.org = org\n        self.logger = logging.getLogger(__name__)\n\n    def write_ticker(self, symbol: str, exchange: str, price: float, \n                    volume: Optional[float] = None):\n        \"\"\"Write ticker data\"\"\"\n        point = Point(\"ticker\") \\\n            .tag(\"symbol\", symbol) \\\n            .tag(\"exchange\", exchange) \\\n            .field(\"price\", price)\n\n        if volume:\n            point.field(\"volume\", volume)\n\n        self.write_api.write(bucket=self.bucket, record=point)\n\n    def write_ohlcv(self, symbol: str, exchange: str, interval: str,\n                   timestamp: datetime, open: float, high: float,\n                   low: float, close: float, volume: float):\n        \"\"\"Write OHLCV data\"\"\"\n        point = Point(\"ohlcv\") \\\n            .tag(\"symbol\", symbol) \\\n            .tag(\"exchange\", exchange) \\\n            .tag(\"interval\", interval) \\\n            .field(\"open\", open) \\\n            .field(\"high\", high) \\\n            .field(\"low\", low) \\\n            .field(\"close\", close) \\\n            .field(\"volume\", volume) \\\n            .time(timestamp)\n\n        self.write_api.write(bucket=self.bucket, record=point)\n\n    def query_price_history(\n        self,\n        symbol: str,\n        exchange: str,\n        start_time: datetime,\n        end_time: datetime,\n        interval: str = \"1h\"\n    ) -&gt; List[Dict]:\n        \"\"\"Query price history\"\"\"\n        query = f'''\n            from(bucket: \"{self.bucket}\")\n            |&gt; range(start: {start_time.isoformat()}, stop: {end_time.isoformat()})\n            |&gt; filter(fn: (r) =&gt; r[\"_measurement\"] == \"ohlcv\")\n            |&gt; filter(fn: (r) =&gt; r[\"symbol\"] == \"{symbol}\")\n            |&gt; filter(fn: (r) =&gt; r[\"exchange\"] == \"{exchange}\")\n            |&gt; filter(fn: (r) =&gt; r[\"interval\"] == \"{interval}\")\n            |&gt; aggregateWindow(every: {interval}, fn: mean, createEmpty: false)\n        '''\n\n        result = self.query_api.query(org=self.org, query=query)\n\n        data = []\n        for table in result:\n            for record in table.records:\n                data.append({\n                    'timestamp': record.get_time(),\n                    'value': record.get_value(),\n                    'field': record.get_field()\n                })\n\n        return data\n</code></pre>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#buoc-5-caching-layer","title":"B\u01b0\u1edbc 5: Caching Layer","text":"<pre><code># database/cache.py\nimport redis\nimport json\nfrom typing import Optional, Dict\nfrom datetime import timedelta\n\nclass MarketDataCache:\n    \"\"\"Redis cache for market data\"\"\"\n\n    def __init__(self, host: str = 'localhost', port: int = 6379):\n        self.redis = redis.Redis(host=host, port=port, decode_responses=True)\n\n    def cache_ticker(self, symbol: str, exchange: str, price: float, ttl: int = 60):\n        \"\"\"Cache ticker price\"\"\"\n        key = f\"ticker:{exchange}:{symbol}\"\n        self.redis.setex(key, ttl, json.dumps({'price': price}))\n\n    def get_ticker(self, symbol: str, exchange: str) -&gt; Optional[float]:\n        \"\"\"Get cached ticker price\"\"\"\n        key = f\"ticker:{exchange}:{symbol}\"\n        data = self.redis.get(key)\n\n        if data:\n            return json.loads(data)['price']\n        return None\n\n    def cache_ohlcv(self, symbol: str, exchange: str, interval: str,\n                   data: List[Dict], ttl: int = 3600):\n        \"\"\"Cache OHLCV data\"\"\"\n        key = f\"ohlcv:{exchange}:{symbol}:{interval}\"\n        self.redis.setex(key, ttl, json.dumps(data))\n\n    def get_ohlcv(self, symbol: str, exchange: str, interval: str) -&gt; Optional[List[Dict]]:\n        \"\"\"Get cached OHLCV data\"\"\"\n        key = f\"ohlcv:{exchange}:{symbol}:{interval}\"\n        data = self.redis.get(key)\n\n        if data:\n            return json.loads(data)\n        return None\n</code></pre>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#best-practices","title":"Best Practices","text":"<ol> <li>Partitioning: Partition by time for better performance</li> <li>Indexing: Index on (symbol, timestamp) for range queries</li> <li>Batch Inserts: Use batch inserts for better throughput</li> <li>Caching: Cache frequently accessed data</li> <li>Compression: Compress old data</li> <li>Retention: Archive old data to cold storage</li> </ol>"},{"location":"blog/2025/01/25/database-design-cho-trading-data---time-series-v%C3%A0-market-data/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Database design cho trading data c\u1ea7n: - Time-series optimization - Efficient indexing - Partitioning strategy - Caching layer - Query optimization</p> <p>Ch\u1ecdn database ph\u00f9 h\u1ee3p v\u1edbi use case c\u1ee7a b\u1ea1n!</p>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/","title":"ETL Pipelines cho Trading Data","text":"<p>Trong h\u1ec7 sinh th\u00e1i c\u1ee7a trading systems v\u00e0 data engineering, ETL (Extract, Transform, Load) pipelines \u0111\u00f3ng vai tr\u00f2 nh\u01b0 nh\u1eefng m\u1ea1ch m\u00e1u, v\u1eadn chuy\u1ec3n d\u1eef li\u1ec7u t\u1eeb c\u00e1c ngu\u1ed3n kh\u00e1c nhau (exchange APIs, market data providers, internal systems) qua c\u00e1c b\u01b0\u1edbc x\u1eed l\u00fd v\u00e0 bi\u1ebfn \u0111\u1ed5i, cu\u1ed1i c\u00f9ng \u0111\u01b0a v\u00e0o c\u00e1c data stores \u0111\u1ec3 ph\u1ee5c v\u1ee5 cho trading strategies, analytics, v\u00e0 reporting. M\u1ed9t ETL pipeline \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf t\u1ed1t kh\u00f4ng ch\u1ec9 \u0111\u1ea3m b\u1ea3o d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c x\u1eed l\u00fd \u0111\u00fang v\u00e0 k\u1ecbp th\u1eddi, m\u00e0 c\u00f2n ph\u1ea3i c\u00f3 kh\u1ea3 n\u0103ng x\u1eed l\u00fd l\u1ed7i gracefully, scale \u0111\u1ec3 x\u1eed l\u00fd kh\u1ed1i l\u01b0\u1ee3ng d\u1eef li\u1ec7u l\u1edbn, v\u00e0 c\u00f3 kh\u1ea3 n\u0103ng recover t\u1eeb failures m\u00e0 kh\u00f4ng m\u1ea5t d\u1eef li\u1ec7u. Trong th\u1ebf gi\u1edbi c\u1ee7a trading, n\u01a1i m\u00e0 m\u1ed7i mili gi\u00e2y \u0111\u1ec1u c\u00f3 gi\u00e1 tr\u1ecb v\u00e0 d\u1eef li\u1ec7u kh\u00f4ng \u0111\u1ea7y \u0111\u1ee7 c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn quy\u1ebft \u0111\u1ecbnh trading sai l\u1ea7m, vi\u1ec7c c\u00f3 m\u1ed9t ETL pipeline robust v\u00e0 reliable l\u00e0 v\u00f4 c\u00f9ng quan tr\u1ecdng.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng ETL pipelines ho\u00e0n ch\u1ec9nh cho trading data, s\u1eed d\u1ee5ng Apache Airflow - m\u1ed9t platform m\u00e3 ngu\u1ed3n m\u1edf m\u1ea1nh m\u1ebd \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1eb7c bi\u1ec7t cho vi\u1ec7c qu\u1ea3n l\u00fd v\u00e0 orchestrate c\u00e1c data pipelines ph\u1ee9c t\u1ea1p. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch extract d\u1eef li\u1ec7u t\u1eeb c\u00e1c exchange APIs (Binance, Bybit, OKX), transform d\u1eef li\u1ec7u \u0111\u1ec3 l\u00e0m s\u1ea1ch, validate, v\u00e0 enrich v\u1edbi c\u00e1c th\u00f4ng tin b\u1ed5 sung, v\u00e0 load v\u00e0o c\u00e1c databases v\u00e0 data warehouses. Ch\u00fang ta c\u0169ng s\u1ebd implement c\u00e1c t\u00ednh n\u0103ng n\u00e2ng cao nh\u01b0 data quality checks, error handling v\u00e0 retry mechanisms, monitoring v\u00e0 alerting, v\u00e0 scheduling strategies \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o d\u1eef li\u1ec7u lu\u00f4n \u0111\u01b0\u1ee3c c\u1eadp nh\u1eadt \u0111\u00fang th\u1eddi gian.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup Apache Airflow, thi\u1ebft k\u1ebf DAGs (Directed Acyclic Graphs) \u0111\u1ec3 \u0111\u1ecbnh ngh\u0129a workflows, implement c\u00e1c operators cho extract, transform, v\u00e0 load operations, \u0111\u1ebfn vi\u1ec7c monitor v\u00e0 troubleshoot pipelines. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch implement data validation, handle failures v\u00e0 retries, optimize performance, v\u00e0 scale pipelines \u0111\u1ec3 x\u1eed l\u00fd large datasets. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t ETL pipeline system m\u1ea1nh m\u1ebd, c\u00f3 th\u1ec3 x\u1eed l\u00fd trading data m\u1ed9t c\u00e1ch reliable v\u00e0 efficient.</p> <p></p>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#etl-pipeline-architecture","title":"ETL Pipeline Architecture","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Extract   \u2502  \u2190 Exchange APIs, Files, Databases\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Transform   \u2502  \u2190 Data cleaning, validation, enrichment\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502    Load     \u2502  \u2192 Databases, Data Warehouses\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#buoc-1-airflow-dag-setup","title":"B\u01b0\u1edbc 1: Airflow DAG Setup","text":"<pre><code># etl/airflow_dags/trading_data_dag.py\nfrom airflow import DAG\nfrom airflow.operators.python import PythonOperator\nfrom airflow.operators.bash import BashOperator\nfrom datetime import datetime, timedelta\nfrom etl.extractors import BinanceExtractor\nfrom etl.transformers import MarketDataTransformer\nfrom etl.loaders import DatabaseLoader\n\ndefault_args = {\n    'owner': 'trading_team',\n    'depends_on_past': False,\n    'email_on_failure': True,\n    'email_on_retry': False,\n    'retries': 3,\n    'retry_delay': timedelta(minutes=5)\n}\n\ndag = DAG(\n    'trading_data_etl',\n    default_args=default_args,\n    description='ETL pipeline for trading data',\n    schedule_interval=timedelta(hours=1),\n    start_date=datetime(2025, 1, 1),\n    catchup=False\n)\n\ndef extract_binance_data(**context):\n    \"\"\"Extract data from Binance\"\"\"\n    extractor = BinanceExtractor()\n    data = extractor.extract_ohlcv(\n        symbol='BTCUSDT',\n        interval='1h',\n        limit=100\n    )\n    return data\n\ndef transform_data(**context):\n    \"\"\"Transform extracted data\"\"\"\n    ti = context['ti']\n    raw_data = ti.xcom_pull(task_ids='extract_binance')\n\n    transformer = MarketDataTransformer()\n    transformed = transformer.transform(raw_data)\n\n    return transformed\n\ndef load_to_database(**context):\n    \"\"\"Load transformed data to database\"\"\"\n    ti = context['ti']\n    transformed_data = ti.xcom_pull(task_ids='transform_data')\n\n    loader = DatabaseLoader()\n    loader.load(transformed_data)\n\n# Define tasks\nextract_task = PythonOperator(\n    task_id='extract_binance',\n    python_callable=extract_binance_data,\n    dag=dag\n)\n\ntransform_task = PythonOperator(\n    task_id='transform_data',\n    python_callable=transform_data,\n    dag=dag\n)\n\nload_task = PythonOperator(\n    task_id='load_to_database',\n    python_callable=load_to_database,\n    dag=dag\n)\n\n# Set dependencies\nextract_task &gt;&gt; transform_task &gt;&gt; load_task\n</code></pre>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#buoc-2-data-extractors","title":"B\u01b0\u1edbc 2: Data Extractors","text":"<pre><code># etl/extractors.py\nfrom binance.client import Client\nimport pandas as pd\nfrom typing import List, Dict\nfrom datetime import datetime\nimport logging\n\nclass BinanceExtractor:\n    \"\"\"Extract data from Binance\"\"\"\n\n    def __init__(self):\n        self.client = Client()\n        self.logger = logging.getLogger(__name__)\n\n    def extract_ohlcv(\n        self,\n        symbol: str,\n        interval: str,\n        start_time: Optional[datetime] = None,\n        end_time: Optional[datetime] = None,\n        limit: int = 1000\n    ) -&gt; List[Dict]:\n        \"\"\"Extract OHLCV data\"\"\"\n        try:\n            if start_time and end_time:\n                klines = self.client.get_historical_klines(\n                    symbol, interval, start_time.strftime('%d %b %Y %H:%M:%S'),\n                    end_time.strftime('%d %b %Y %H:%M:%S')\n                )\n            else:\n                klines = self.client.get_klines(symbol=symbol, interval=interval, limit=limit)\n\n            data = []\n            for kline in klines:\n                data.append({\n                    'symbol': symbol,\n                    'timestamp': datetime.fromtimestamp(kline[0] / 1000),\n                    'open': float(kline[1]),\n                    'high': float(kline[2]),\n                    'low': float(kline[3]),\n                    'close': float(kline[4]),\n                    'volume': float(kline[5])\n                })\n\n            self.logger.info(f\"Extracted {len(data)} records for {symbol}\")\n            return data\n\n        except Exception as e:\n            self.logger.error(f\"Error extracting data: {e}\")\n            return []\n\n    def extract_trades(\n        self,\n        symbol: str,\n        limit: int = 1000\n    ) -&gt; List[Dict]:\n        \"\"\"Extract recent trades\"\"\"\n        try:\n            trades = self.client.get_recent_trades(symbol=symbol, limit=limit)\n\n            data = []\n            for trade in trades:\n                data.append({\n                    'symbol': symbol,\n                    'trade_id': trade['id'],\n                    'price': float(trade['price']),\n                    'quantity': float(trade['qty']),\n                    'timestamp': datetime.fromtimestamp(trade['time'] / 1000),\n                    'is_buyer_maker': trade['isBuyerMaker']\n                })\n\n            return data\n        except Exception as e:\n            self.logger.error(f\"Error extracting trades: {e}\")\n            return []\n\nclass FileExtractor:\n    \"\"\"Extract data from files\"\"\"\n\n    def extract_csv(self, filepath: str) -&gt; pd.DataFrame:\n        \"\"\"Extract from CSV file\"\"\"\n        return pd.read_csv(filepath)\n\n    def extract_json(self, filepath: str) -&gt; List[Dict]:\n        \"\"\"Extract from JSON file\"\"\"\n        import json\n        with open(filepath, 'r') as f:\n            return json.load(f)\n</code></pre>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#buoc-3-data-transformers","title":"B\u01b0\u1edbc 3: Data Transformers","text":"<pre><code># etl/transformers.py\nimport pandas as pd\nfrom typing import List, Dict\nimport logging\n\nclass MarketDataTransformer:\n    \"\"\"Transform market data\"\"\"\n\n    def __init__(self):\n        self.logger = logging.getLogger(__name__)\n\n    def transform(self, data: List[Dict]) -&gt; pd.DataFrame:\n        \"\"\"Transform raw data\"\"\"\n        if not data:\n            return pd.DataFrame()\n\n        df = pd.DataFrame(data)\n\n        # Data cleaning\n        df = self.clean_data(df)\n\n        # Data validation\n        df = self.validate_data(df)\n\n        # Data enrichment\n        df = self.enrich_data(df)\n\n        return df\n\n    def clean_data(self, df: pd.DataFrame) -&gt; pd.DataFrame:\n        \"\"\"Clean data\"\"\"\n        # Remove duplicates\n        df = df.drop_duplicates(subset=['symbol', 'timestamp'])\n\n        # Remove invalid prices\n        df = df[df['close'] &gt; 0]\n        df = df[df['volume'] &gt;= 0]\n\n        # Sort by timestamp\n        df = df.sort_values('timestamp')\n\n        return df\n\n    def validate_data(self, df: pd.DataFrame) -&gt; pd.DataFrame:\n        \"\"\"Validate data\"\"\"\n        # Check for missing values\n        required_cols = ['symbol', 'timestamp', 'open', 'high', 'low', 'close', 'volume']\n        df = df.dropna(subset=required_cols)\n\n        # Validate price relationships\n        # High should be &gt;= Low\n        df = df[df['high'] &gt;= df['low']]\n        # High should be &gt;= Open and Close\n        df = df[(df['high'] &gt;= df['open']) &amp; (df['high'] &gt;= df['close'])]\n        # Low should be &lt;= Open and Close\n        df = df[(df['low'] &lt;= df['open']) &amp; (df['low'] &lt;= df['close'])]\n\n        return df\n\n    def enrich_data(self, df: pd.DataFrame) -&gt; pd.DataFrame:\n        \"\"\"Enrich data with calculated fields\"\"\"\n        # Calculate returns\n        df['returns'] = df['close'].pct_change()\n\n        # Calculate volatility (rolling 24h)\n        df['volatility'] = df['returns'].rolling(window=24).std()\n\n        # Calculate moving averages\n        df['sma_20'] = df['close'].rolling(window=20).mean()\n        df['sma_50'] = df['close'].rolling(window=50).mean()\n\n        # Calculate RSI\n        delta = df['close'].diff()\n        gain = (delta.where(delta &gt; 0, 0)).rolling(window=14).mean()\n        loss = (-delta.where(delta &lt; 0, 0)).rolling(window=14).mean()\n        rs = gain / loss\n        df['rsi'] = 100 - (100 / (1 + rs))\n\n        return df\n\nclass TradeDataTransformer:\n    \"\"\"Transform trade data\"\"\"\n\n    def transform(self, data: List[Dict]) -&gt; pd.DataFrame:\n        \"\"\"Transform trade data\"\"\"\n        df = pd.DataFrame(data)\n\n        # Add exchange column if missing\n        if 'exchange' not in df.columns:\n            df['exchange'] = 'binance'\n\n        # Calculate trade value\n        df['value'] = df['price'] * df['quantity']\n\n        # Classify trade size\n        df['trade_size'] = pd.cut(\n            df['value'],\n            bins=[0, 1000, 10000, 100000, float('inf')],\n            labels=['small', 'medium', 'large', 'whale']\n        )\n\n        return df\n</code></pre>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#buoc-4-data-loaders","title":"B\u01b0\u1edbc 4: Data Loaders","text":"<pre><code># etl/loaders.py\nimport pandas as pd\nfrom database.market_data_db import MarketDataDB\nfrom typing import List, Dict\nimport logging\n\nclass DatabaseLoader:\n    \"\"\"Load data to database\"\"\"\n\n    def __init__(self, connection_string: str):\n        self.db = MarketDataDB(connection_string)\n        self.logger = logging.getLogger(__name__)\n\n    def load(self, df: pd.DataFrame):\n        \"\"\"Load DataFrame to database\"\"\"\n        if df.empty:\n            self.logger.warning(\"Empty DataFrame, nothing to load\")\n            return\n\n        # Convert DataFrame to list of dicts\n        data = df.to_dict('records')\n\n        # Group by symbol and exchange\n        grouped = {}\n        for record in data:\n            key = (record['symbol'], record.get('exchange', 'binance'))\n            if key not in grouped:\n                grouped[key] = []\n            grouped[key].append(record)\n\n        # Load each group\n        for (symbol, exchange), records in grouped.items():\n            try:\n                self.db.insert_ohlcv_batch(records)\n                self.logger.info(f\"Loaded {len(records)} records for {symbol} on {exchange}\")\n            except Exception as e:\n                self.logger.error(f\"Error loading {symbol}: {e}\")\n\nclass FileLoader:\n    \"\"\"Load data to files\"\"\"\n\n    def load_csv(self, df: pd.DataFrame, filepath: str):\n        \"\"\"Load to CSV file\"\"\"\n        df.to_csv(filepath, index=False)\n\n    def load_parquet(self, df: pd.DataFrame, filepath: str):\n        \"\"\"Load to Parquet file (compressed)\"\"\"\n        df.to_parquet(filepath, compression='snappy')\n</code></pre>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#buoc-5-complete-etl-pipeline","title":"B\u01b0\u1edbc 5: Complete ETL Pipeline","text":"<pre><code># etl/pipeline.py\nfrom etl.extractors import BinanceExtractor\nfrom etl.transformers import MarketDataTransformer\nfrom etl.loaders import DatabaseLoader\nfrom datetime import datetime, timedelta\nimport logging\n\nclass TradingDataETL:\n    \"\"\"Complete ETL pipeline\"\"\"\n\n    def __init__(self, db_connection_string: str):\n        self.extractor = BinanceExtractor()\n        self.transformer = MarketDataTransformer()\n        self.loader = DatabaseLoader(db_connection_string)\n        self.logger = logging.getLogger(__name__)\n\n    def run(self, symbols: List[str], intervals: List[str]):\n        \"\"\"Run ETL for multiple symbols and intervals\"\"\"\n        for symbol in symbols:\n            for interval in intervals:\n                try:\n                    # Extract\n                    self.logger.info(f\"Extracting {symbol} {interval}\")\n                    raw_data = self.extractor.extract_ohlcv(\n                        symbol=symbol,\n                        interval=interval,\n                        limit=1000\n                    )\n\n                    if not raw_data:\n                        continue\n\n                    # Transform\n                    self.logger.info(f\"Transforming {symbol} {interval}\")\n                    transformed = self.transformer.transform(raw_data)\n\n                    # Load\n                    self.logger.info(f\"Loading {symbol} {interval}\")\n                    self.loader.load(transformed)\n\n                    self.logger.info(f\"Completed {symbol} {interval}\")\n\n                except Exception as e:\n                    self.logger.error(f\"Error processing {symbol} {interval}: {e}\")\n                    continue\n\n# Usage\nif __name__ == '__main__':\n    etl = TradingDataETL('postgresql://user:pass@localhost/db')\n    etl.run(\n        symbols=['BTCUSDT', 'ETHUSDT', 'BNBUSDT'],\n        intervals=['1h', '4h', '1d']\n    )\n</code></pre>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#best-practices","title":"Best Practices","text":"<ol> <li>Idempotency: Make pipelines idempotent</li> <li>Error Handling: Handle errors gracefully</li> <li>Logging: Log all operations</li> <li>Monitoring: Monitor pipeline health</li> <li>Incremental Loading: Load only new data</li> <li>Data Quality: Validate data at each stage</li> </ol>"},{"location":"blog/2025/01/25/etl-pipelines-cho-trading-data---apache-airflow-v%C3%A0-data-processing/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>ETL pipelines enable: - Automated data processing - Data quality assurance - Scalable data processing - Reliable data pipelines</p> <p>Build robust ETL pipelines for your trading data!</p>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/","title":"T\u00edch h\u1ee3p Multiple Exchange APIs","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a cryptocurrency trading, vi\u1ec7c ch\u1ec9 ph\u1ee5 thu\u1ed9c v\u00e0o m\u1ed9t s\u00e0n giao d\u1ecbch duy nh\u1ea5t c\u00f3 th\u1ec3 l\u00e0 m\u1ed9t h\u1ea1n ch\u1ebf l\u1edbn. M\u1ed7i s\u00e0n giao d\u1ecbch c\u00f3 nh\u1eefng \u0111i\u1ec3m m\u1ea1nh ri\u00eang: Binance v\u1edbi thanh kho\u1ea3n kh\u1ed5ng l\u1ed3 v\u00e0 ph\u00ed giao d\u1ecbch c\u1ea1nh tranh, Bybit v\u1edbi c\u00e1c t\u00ednh n\u0103ng futures trading m\u1ea1nh m\u1ebd v\u00e0 API response time nhanh, OKX v\u1edbi c\u00e1c s\u1ea3n ph\u1ea9m derivatives \u0111a d\u1ea1ng v\u00e0 advanced trading features. Vi\u1ec7c t\u00edch h\u1ee3p nhi\u1ec1u s\u00e0n giao d\u1ecbch v\u00e0o m\u1ed9t h\u1ec7 th\u1ed1ng trading th\u1ed1ng nh\u1ea5t kh\u00f4ng ch\u1ec9 m\u1edf ra c\u01a1 h\u1ed9i arbitrage (ki\u1ebfm l\u1ee3i nhu\u1eadn t\u1eeb ch\u00eanh l\u1ec7ch gi\u00e1 gi\u1eefa c\u00e1c s\u00e0n), m\u00e0 c\u00f2n gi\u00fap b\u1ea1n t\u0103ng thanh kho\u1ea3n khi c\u1ea7n, ph\u00e2n t\u00e1n r\u1ee7i ro, v\u00e0 t\u1eadn d\u1ee5ng \u0111\u01b0\u1ee3c nh\u1eefng t\u00ednh n\u0103ng t\u1ed1t nh\u1ea5t c\u1ee7a m\u1ed7i s\u00e0n. Tuy nhi\u00ean, vi\u1ec7c n\u00e0y c\u0169ng \u0111\u1eb7t ra nh\u1eefng th\u00e1ch th\u1ee9c kh\u00f4ng nh\u1ecf: m\u1ed7i s\u00e0n c\u00f3 API structure kh\u00e1c nhau, authentication mechanisms kh\u00e1c nhau, rate limits kh\u00e1c nhau, v\u00e0 c\u00e1ch x\u1eed l\u00fd errors c\u0169ng kh\u00e1c nhau.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng m\u1ed9t unified trading interface c\u00f3 th\u1ec3 t\u00edch h\u1ee3p v\u1edbi nhi\u1ec1u s\u00e0n giao d\u1ecbch c\u00f9ng l\u00fac, c\u1ee5 th\u1ec3 l\u00e0 Binance, Bybit, v\u00e0 OKX - ba trong s\u1ed1 nh\u1eefng s\u00e0n giao d\u1ecbch l\u1edbn nh\u1ea5t v\u00e0 ph\u1ed5 bi\u1ebfn nh\u1ea5t hi\u1ec7n nay. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch thi\u1ebft k\u1ebf m\u1ed9t abstraction layer \u0111\u1ec3 che gi\u1ea5u s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa c\u00e1c APIs, implement unified interfaces cho c\u00e1c operations ph\u1ed5 bi\u1ebfn nh\u01b0 get balance, place order, cancel order, v\u00e0 get market data, x\u1eed l\u00fd c\u00e1c edge cases v\u00e0 errors m\u1ed9t c\u00e1ch graceful, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 \u0111\u1ea3m b\u1ea3o h\u1ec7 th\u1ed1ng c\u00f3 th\u1ec3 ho\u1ea1t \u0111\u1ed9ng \u1ed5n \u0111\u1ecbnh ngay c\u1ea3 khi m\u1ed9t trong c\u00e1c s\u00e0n g\u1eb7p s\u1ef1 c\u1ed1. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c strategies nh\u01b0 load balancing requests gi\u1eefa c\u00e1c s\u00e0n, failover mechanisms, v\u00e0 c\u00e1ch optimize \u0111\u1ec3 gi\u1ea3m latency.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c thi\u1ebft k\u1ebf architecture cho multi-exchange system, implement adapter pattern \u0111\u1ec3 wrap c\u00e1c exchange APIs, x\u00e2y d\u1ef1ng unified interfaces, \u0111\u1ebfn vi\u1ec7c implement error handling, rate limiting, v\u00e0 monitoring. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch test integration v\u1edbi multiple exchanges, handle rate limits v\u00e0 API changes, v\u00e0 implement caching strategies. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t h\u1ec7 th\u1ed1ng m\u1ea1nh m\u1ebd, c\u00f3 th\u1ec3 trade tr\u00ean nhi\u1ec1u s\u00e0n giao d\u1ecbch c\u00f9ng l\u00fac m\u1ed9t c\u00e1ch seamless v\u00e0 efficient.</p>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#tai-sao-can-multiple-exchanges","title":"T\u1ea1i sao c\u1ea7n multiple exchanges?","text":"<ol> <li>Arbitrage: Ch\u00eanh l\u1ec7ch gi\u00e1 gi\u1eefa c\u00e1c s\u00e0n</li> <li>Liquidity: T\u0103ng thanh kho\u1ea3n khi c\u1ea7n</li> <li>Risk Management: Ph\u00e2n t\u00e1n r\u1ee7i ro</li> <li>Feature diversity: M\u1ed7i s\u00e0n c\u00f3 \u0111i\u1ec3m m\u1ea1nh ri\u00eang</li> </ol>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#kien-truc-tong-quan","title":"Ki\u1ebfn tr\u00fac t\u1ed5ng quan","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Trading    \u2502\n\u2502  Strategy   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502   Exchange Adapter       \u2502\n\u2502   (Unified Interface)     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n   \u250c\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n   \u2502       \u2502        \u2502      \u2502\n\u250c\u2500\u2500\u25bc\u2500\u2500\u2510 \u250c\u2500\u25bc\u2500\u2500\u2500\u2510 \u250c\u2500\u25bc\u2500\u2500\u2510 \u250c\u2500\u25bc\u2500\u2500\u2510\n\u2502Bin. \u2502 \u2502Bybit\u2502 \u2502OKX \u2502 \u2502... \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2518 \u2514\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#buoc-1-tao-base-exchange-interface","title":"B\u01b0\u1edbc 1: T\u1ea1o Base Exchange Interface","text":"<pre><code># exchanges/base_exchange.py\nfrom abc import ABC, abstractmethod\nfrom typing import Dict, List, Optional\nfrom dataclasses import dataclass\n\n@dataclass\nclass Order:\n    symbol: str\n    side: str  # 'BUY' or 'SELL'\n    quantity: float\n    price: Optional[float] = None\n    order_type: str = 'MARKET'  # 'MARKET' or 'LIMIT'\n    order_id: Optional[str] = None\n    status: Optional[str] = None\n\n@dataclass\nclass Ticker:\n    symbol: str\n    price: float\n    volume_24h: float\n    change_24h: float\n\nclass BaseExchange(ABC):\n    \"\"\"Base class cho t\u1ea5t c\u1ea3 exchanges\"\"\"\n\n    @abstractmethod\n    def get_ticker(self, symbol: str) -&gt; Optional[Ticker]:\n        \"\"\"L\u1ea5y gi\u00e1 hi\u1ec7n t\u1ea1i\"\"\"\n        pass\n\n    @abstractmethod\n    def get_balance(self) -&gt; Dict[str, float]:\n        \"\"\"L\u1ea5y s\u1ed1 d\u01b0 t\u00e0i kho\u1ea3n\"\"\"\n        pass\n\n    @abstractmethod\n    def place_order(self, order: Order) -&gt; Optional[Order]:\n        \"\"\"\u0110\u1eb7t l\u1ec7nh\"\"\"\n        pass\n\n    @abstractmethod\n    def get_order_status(self, order_id: str, symbol: str) -&gt; Optional[Order]:\n        \"\"\"Ki\u1ec3m tra tr\u1ea1ng th\u00e1i l\u1ec7nh\"\"\"\n        pass\n\n    @abstractmethod\n    def get_klines(self, symbol: str, interval: str, limit: int) -&gt; List[Dict]:\n        \"\"\"L\u1ea5y d\u1eef li\u1ec7u candlestick\"\"\"\n        pass\n\n    def normalize_symbol(self, symbol: str) -&gt; str:\n        \"\"\"Chu\u1ea9n h\u00f3a symbol format\"\"\"\n        return symbol.upper()\n</code></pre>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#buoc-2-implement-binance-adapter","title":"B\u01b0\u1edbc 2: Implement Binance Adapter","text":"<pre><code># exchanges/binance_exchange.py\nfrom binance.client import Client\nfrom exchanges.base_exchange import BaseExchange, Order, Ticker\nfrom typing import Dict, List, Optional\nimport logging\n\nclass BinanceExchange(BaseExchange):\n    def __init__(self, api_key: str, secret_key: str, testnet: bool = True):\n        self.client = Client(api_key, secret_key, testnet=testnet)\n        self.logger = logging.getLogger(__name__)\n\n    def get_ticker(self, symbol: str) -&gt; Optional[Ticker]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            ticker = self.client.get_ticker(symbol=symbol)\n            stats = self.client.get_ticker(symbol=symbol)\n\n            return Ticker(\n                symbol=symbol,\n                price=float(ticker['lastPrice']),\n                volume_24h=float(ticker['volume']),\n                change_24h=float(ticker['priceChangePercent'])\n            )\n        except Exception as e:\n            self.logger.error(f\"Binance get_ticker error: {e}\")\n            return None\n\n    def get_balance(self) -&gt; Dict[str, float]:\n        try:\n            account = self.client.get_account()\n            return {\n                b['asset']: float(b['free']) \n                for b in account['balances'] \n                if float(b['free']) &gt; 0\n            }\n        except Exception as e:\n            self.logger.error(f\"Binance get_balance error: {e}\")\n            return {}\n\n    def place_order(self, order: Order) -&gt; Optional[Order]:\n        try:\n            symbol = self.normalize_symbol(order.symbol)\n\n            if order.order_type == 'MARKET':\n                if order.side == 'BUY':\n                    result = self.client.order_market_buy(\n                        symbol=symbol,\n                        quantity=order.quantity\n                    )\n                else:\n                    result = self.client.order_market_sell(\n                        symbol=symbol,\n                        quantity=order.quantity\n                    )\n            else:  # LIMIT\n                result = self.client.create_order(\n                    symbol=symbol,\n                    side=order.side,\n                    type='LIMIT',\n                    timeInForce='GTC',\n                    quantity=order.quantity,\n                    price=str(order.price)\n                )\n\n            order.order_id = str(result['orderId'])\n            order.status = result['status']\n            return order\n\n        except Exception as e:\n            self.logger.error(f\"Binance place_order error: {e}\")\n            return None\n\n    def get_order_status(self, order_id: str, symbol: str) -&gt; Optional[Order]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            result = self.client.get_order(symbol=symbol, orderId=order_id)\n\n            return Order(\n                symbol=symbol,\n                side=result['side'],\n                quantity=float(result['executedQty']),\n                price=float(result['price']) if result['price'] else None,\n                order_id=str(result['orderId']),\n                status=result['status']\n            )\n        except Exception as e:\n            self.logger.error(f\"Binance get_order_status error: {e}\")\n            return None\n\n    def get_klines(self, symbol: str, interval: str, limit: int) -&gt; List[Dict]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            klines = self.client.get_klines(\n                symbol=symbol,\n                interval=interval,\n                limit=limit\n            )\n\n            return [{\n                'timestamp': int(k[0]),\n                'open': float(k[1]),\n                'high': float(k[2]),\n                'low': float(k[3]),\n                'close': float(k[4]),\n                'volume': float(k[5])\n            } for k in klines]\n        except Exception as e:\n            self.logger.error(f\"Binance get_klines error: {e}\")\n            return []\n</code></pre>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#buoc-3-implement-bybit-adapter","title":"B\u01b0\u1edbc 3: Implement Bybit Adapter","text":"<pre><code># exchanges/bybit_exchange.py\nfrom pybit.unified_trading import HTTP\nfrom exchanges.base_exchange import BaseExchange, Order, Ticker\nfrom typing import Dict, List, Optional\nimport logging\n\nclass BybitExchange(BaseExchange):\n    def __init__(self, api_key: str, secret_key: str, testnet: bool = True):\n        self.session = HTTP(\n            testnet=testnet,\n            api_key=api_key,\n            api_secret=secret_key\n        )\n        self.logger = logging.getLogger(__name__)\n\n    def get_ticker(self, symbol: str) -&gt; Optional[Ticker]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            result = self.session.get_tickers(category=\"spot\", symbol=symbol)\n\n            if result['retCode'] == 0 and result['result']['list']:\n                ticker_data = result['result']['list'][0]\n                return Ticker(\n                    symbol=symbol,\n                    price=float(ticker_data['lastPrice']),\n                    volume_24h=float(ticker_data['volume24h']),\n                    change_24h=float(ticker_data['price24hPcnt']) * 100\n                )\n            return None\n        except Exception as e:\n            self.logger.error(f\"Bybit get_ticker error: {e}\")\n            return None\n\n    def get_balance(self) -&gt; Dict[str, float]:\n        try:\n            result = self.session.get_wallet_balance(\n                accountType=\"SPOT\"\n            )\n\n            if result['retCode'] == 0:\n                balances = {}\n                for coin in result['result']['list'][0]['coin']:\n                    if float(coin['free']) &gt; 0:\n                        balances[coin['coin']] = float(coin['free'])\n                return balances\n            return {}\n        except Exception as e:\n            self.logger.error(f\"Bybit get_balance error: {e}\")\n            return {}\n\n    def place_order(self, order: Order) -&gt; Optional[Order]:\n        try:\n            symbol = self.normalize_symbol(order.symbol)\n\n            params = {\n                \"category\": \"spot\",\n                \"symbol\": symbol,\n                \"side\": order.side.capitalize(),\n                \"orderType\": order.order_type,\n                \"qty\": str(order.quantity)\n            }\n\n            if order.order_type == \"LIMIT\":\n                params[\"price\"] = str(order.price)\n\n            result = self.session.place_order(**params)\n\n            if result['retCode'] == 0:\n                order.order_id = result['result']['orderId']\n                order.status = 'NEW'\n                return order\n            return None\n\n        except Exception as e:\n            self.logger.error(f\"Bybit place_order error: {e}\")\n            return None\n\n    def get_order_status(self, order_id: str, symbol: str) -&gt; Optional[Order]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            result = self.session.get_open_orders(\n                category=\"spot\",\n                symbol=symbol,\n                orderId=order_id\n            )\n\n            if result['retCode'] == 0 and result['result']['list']:\n                order_data = result['result']['list'][0]\n                return Order(\n                    symbol=symbol,\n                    side=order_data['side'],\n                    quantity=float(order_data['qty']),\n                    price=float(order_data['price']) if order_data.get('price') else None,\n                    order_id=order_data['orderId'],\n                    status=order_data['orderStatus']\n                )\n            return None\n        except Exception as e:\n            self.logger.error(f\"Bybit get_order_status error: {e}\")\n            return None\n\n    def get_klines(self, symbol: str, interval: str, limit: int) -&gt; List[Dict]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            # Map interval format\n            interval_map = {\n                '1m': '1', '5m': '5', '15m': '15', '30m': '30',\n                '1h': '60', '4h': '240', '1d': 'D'\n            }\n            bybit_interval = interval_map.get(interval, interval)\n\n            result = self.session.get_kline(\n                category=\"spot\",\n                symbol=symbol,\n                interval=bybit_interval,\n                limit=str(limit)\n            )\n\n            if result['retCode'] == 0:\n                return [{\n                    'timestamp': int(k[0]),\n                    'open': float(k[1]),\n                    'high': float(k[2]),\n                    'low': float(k[3]),\n                    'close': float(k[4]),\n                    'volume': float(k[5])\n                } for k in result['result']['list']]\n            return []\n        except Exception as e:\n            self.logger.error(f\"Bybit get_klines error: {e}\")\n            return []\n</code></pre>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#buoc-4-implement-okx-adapter","title":"B\u01b0\u1edbc 4: Implement OKX Adapter","text":"<pre><code># exchanges/okx_exchange.py\nimport ccxt\nfrom exchanges.base_exchange import BaseExchange, Order, Ticker\nfrom typing import Dict, List, Optional\nimport logging\n\nclass OKXExchange(BaseExchange):\n    def __init__(self, api_key: str, secret_key: str, passphrase: str, testnet: bool = True):\n        self.exchange = ccxt.okx({\n            'apiKey': api_key,\n            'secret': secret_key,\n            'password': passphrase,\n            'sandbox': testnet,\n            'enableRateLimit': True\n        })\n        self.logger = logging.getLogger(__name__)\n\n    def get_ticker(self, symbol: str) -&gt; Optional[Ticker]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            ticker = self.exchange.fetch_ticker(symbol)\n\n            return Ticker(\n                symbol=symbol,\n                price=ticker['last'],\n                volume_24h=ticker['quoteVolume'],\n                change_24h=ticker['percentage']\n            )\n        except Exception as e:\n            self.logger.error(f\"OKX get_ticker error: {e}\")\n            return None\n\n    def get_balance(self) -&gt; Dict[str, float]:\n        try:\n            balance = self.exchange.fetch_balance()\n            return {\n                currency: amount['free']\n                for currency, amount in balance.items()\n                if isinstance(amount, dict) and amount.get('free', 0) &gt; 0\n            }\n        except Exception as e:\n            self.logger.error(f\"OKX get_balance error: {e}\")\n            return {}\n\n    def place_order(self, order: Order) -&gt; Optional[Order]:\n        try:\n            symbol = self.normalize_symbol(order.symbol)\n\n            result = self.exchange.create_market_order(\n                symbol=symbol,\n                side=order.side.lower(),\n                amount=order.quantity\n            ) if order.order_type == 'MARKET' else self.exchange.create_limit_order(\n                symbol=symbol,\n                side=order.side.lower(),\n                amount=order.quantity,\n                price=order.price\n            )\n\n            order.order_id = result['id']\n            order.status = result['status']\n            return order\n\n        except Exception as e:\n            self.logger.error(f\"OKX place_order error: {e}\")\n            return None\n\n    def get_order_status(self, order_id: str, symbol: str) -&gt; Optional[Order]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            result = self.exchange.fetch_order(order_id, symbol)\n\n            return Order(\n                symbol=symbol,\n                side=result['side'].upper(),\n                quantity=result['filled'],\n                price=result['price'],\n                order_id=result['id'],\n                status=result['status']\n            )\n        except Exception as e:\n            self.logger.error(f\"OKX get_order_status error: {e}\")\n            return None\n\n    def get_klines(self, symbol: str, interval: str, limit: int) -&gt; List[Dict]:\n        try:\n            symbol = self.normalize_symbol(symbol)\n            ohlcv = self.exchange.fetch_ohlcv(symbol, interval, limit=limit)\n\n            return [{\n                'timestamp': int(candle[0]),\n                'open': float(candle[1]),\n                'high': float(candle[2]),\n                'low': float(candle[3]),\n                'close': float(candle[4]),\n                'volume': float(candle[5])\n            } for candle in ohlcv]\n        except Exception as e:\n            self.logger.error(f\"OKX get_klines error: {e}\")\n            return []\n</code></pre>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#buoc-5-unified-trading-interface","title":"B\u01b0\u1edbc 5: Unified Trading Interface","text":"<pre><code># trading/unified_trader.py\nfrom exchanges.base_exchange import BaseExchange, Order, Ticker\nfrom typing import List, Dict, Optional\nimport logging\n\nclass UnifiedTrader:\n    def __init__(self, exchanges: List[BaseExchange]):\n        self.exchanges = {ex.__class__.__name__: ex for ex in exchanges}\n        self.logger = logging.getLogger(__name__)\n\n    def get_best_price(self, symbol: str, side: str) -&gt; Optional[Dict]:\n        \"\"\"T\u00ecm gi\u00e1 t\u1ed1t nh\u1ea5t t\u1eeb t\u1ea5t c\u1ea3 exchanges\"\"\"\n        prices = []\n\n        for name, exchange in self.exchanges.items():\n            ticker = exchange.get_ticker(symbol)\n            if ticker:\n                prices.append({\n                    'exchange': name,\n                    'price': ticker.price,\n                    'volume': ticker.volume_24h\n                })\n\n        if not prices:\n            return None\n\n        if side == 'BUY':\n            # T\u00ecm gi\u00e1 th\u1ea5p nh\u1ea5t \u0111\u1ec3 mua\n            best = min(prices, key=lambda x: x['price'])\n        else:\n            # T\u00ecm gi\u00e1 cao nh\u1ea5t \u0111\u1ec3 b\u00e1n\n            best = max(prices, key=lambda x: x['price'])\n\n        return best\n\n    def arbitrage_opportunity(self, symbol: str, min_profit_pct: float = 0.5) -&gt; Optional[Dict]:\n        \"\"\"T\u00ecm c\u01a1 h\u1ed9i arbitrage\"\"\"\n        tickers = {}\n\n        for name, exchange in self.exchanges.items():\n            ticker = exchange.get_ticker(symbol)\n            if ticker:\n                tickers[name] = ticker\n\n        if len(tickers) &lt; 2:\n            return None\n\n        # T\u00ecm gi\u00e1 cao nh\u1ea5t v\u00e0 th\u1ea5p nh\u1ea5t\n        buy_exchange = min(tickers.items(), key=lambda x: x[1].price)\n        sell_exchange = max(tickers.items(), key=lambda x: x[1].price)\n\n        profit_pct = ((sell_exchange[1].price - buy_exchange[1].price) / buy_exchange[1].price) * 100\n\n        if profit_pct &gt;= min_profit_pct:\n            return {\n                'symbol': symbol,\n                'buy_exchange': buy_exchange[0],\n                'buy_price': buy_exchange[1].price,\n                'sell_exchange': sell_exchange[0],\n                'sell_price': sell_exchange[1].price,\n                'profit_pct': profit_pct\n            }\n\n        return None\n\n    def place_order_best_price(self, symbol: str, side: str, quantity: float) -&gt; Optional[Order]:\n        \"\"\"\u0110\u1eb7t l\u1ec7nh \u1edf exchange c\u00f3 gi\u00e1 t\u1ed1t nh\u1ea5t\"\"\"\n        best = self.get_best_price(symbol, side)\n\n        if not best:\n            return None\n\n        exchange = self.exchanges[best['exchange']]\n        order = Order(\n            symbol=symbol,\n            side=side,\n            quantity=quantity,\n            order_type='MARKET'\n        )\n\n        return exchange.place_order(order)\n\n    def get_total_balance(self) -&gt; Dict[str, float]:\n        \"\"\"T\u1ed5ng h\u1ee3p balance t\u1eeb t\u1ea5t c\u1ea3 exchanges\"\"\"\n        total = {}\n\n        for name, exchange in self.exchanges.items():\n            balance = exchange.get_balance()\n            for currency, amount in balance.items():\n                if currency not in total:\n                    total[currency] = 0\n                total[currency] += amount\n\n        return total\n\n# Usage example\nif __name__ == '__main__':\n    from exchanges.binance_exchange import BinanceExchange\n    from exchanges.bybit_exchange import BybitExchange\n    from exchanges.okx_exchange import OKXExchange\n\n    # Initialize exchanges\n    binance = BinanceExchange(api_key='...', secret_key='...')\n    bybit = BybitExchange(api_key='...', secret_key='...')\n    okx = OKXExchange(api_key='...', secret_key='...', passphrase='...')\n\n    # Create unified trader\n    trader = UnifiedTrader([binance, bybit, okx])\n\n    # Find arbitrage opportunity\n    opportunity = trader.arbitrage_opportunity('BTCUSDT', min_profit_pct=0.5)\n    if opportunity:\n        print(f\"Arbitrage found: {opportunity}\")\n\n    # Get best price\n    best = trader.get_best_price('BTCUSDT', 'BUY')\n    print(f\"Best price to buy: {best}\")\n</code></pre>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#best-practices","title":"Best Practices","text":"<ol> <li>Error Handling: M\u1ed7i exchange c\u00f3 th\u1ec3 fail, c\u1ea7n handle gracefully</li> <li>Rate Limiting: Respect rate limits c\u1ee7a m\u1ed7i exchange</li> <li>Symbol Normalization: M\u1ed7i exchange c\u00f3 format symbol kh\u00e1c nhau</li> <li>Connection Pooling: Reuse connections khi c\u00f3 th\u1ec3</li> <li>Monitoring: Log t\u1ea5t c\u1ea3 operations \u0111\u1ec3 debug</li> </ol>"},{"location":"blog/2025/01/25/t%C3%ADch-h%E1%BB%A3p-multiple-exchange-apis---binance-bybit-okx/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>V\u1edbi unified interface, b\u1ea1n c\u00f3 th\u1ec3: - Trade tr\u00ean nhi\u1ec1u exchanges c\u00f9ng l\u00fac - T\u00ecm arbitrage opportunities - T\u1ed1i \u01b0u gi\u00e1 mua/b\u00e1n - Ph\u00e2n t\u00e1n risk across exchanges</p> <p>Trong b\u00e0i ti\u1ebfp theo, ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng arbitrage bot t\u1ef1 \u0111\u1ed9ng.</p>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/","title":"Thi\u1ebft k\u1ebf Low-Latency Trading System","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a high-frequency trading (HFT) v\u00e0 algorithmic trading, latency kh\u00f4ng ch\u1ec9 l\u00e0 m\u1ed9t metric quan tr\u1ecdng - n\u00f3 l\u00e0 y\u1ebfu t\u1ed1 quy\u1ebft \u0111\u1ecbnh th\u00e0nh b\u1ea1i. Trong m\u1ed9t m\u00f4i tr\u01b0\u1eddng c\u1ea1nh tranh kh\u1ed1c li\u1ec7t, n\u01a1i m\u00e0 h\u00e0ng ngh\u00ecn traders v\u00e0 algorithms \u0111ang c\u1ea1nh tranh \u0111\u1ec3 execute orders nhanh nh\u1ea5t, m\u1ed9t v\u00e0i microseconds c\u00f3 th\u1ec3 t\u1ea1o ra s\u1ef1 kh\u00e1c bi\u1ec7t gi\u1eefa m\u1ed9t trade profitable v\u00e0 m\u1ed9t trade thua l\u1ed7. C\u00e1c qu\u1ef9 \u0111\u1ea7u t\u01b0 l\u1edbn \u0111\u00e3 \u0111\u1ea7u t\u01b0 h\u00e0ng tri\u1ec7u \u0111\u00f4 la v\u00e0o infrastructure, t\u1eeb vi\u1ec7c \u0111\u1eb7t servers g\u1ea7n exchange data centers \u0111\u1ec3 gi\u1ea3m network latency, \u0111\u1ebfn vi\u1ec7c s\u1eed d\u1ee5ng hardware \u0111\u1eb7c bi\u1ec7t v\u00e0 custom network stacks \u0111\u1ec3 t\u1ed1i \u01b0u h\u00f3a t\u1eebng microsecond. Trong b\u00e0i vi\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd kh\u00e1m ph\u00e1 c\u00e1ch thi\u1ebft k\u1ebf v\u00e0 x\u00e2y d\u1ef1ng m\u1ed9t low-latency trading system t\u1eeb \u0111\u1ea7u \u0111\u1ebfn cu\u1ed1i.</p> <p>Latency trong trading systems \u0111\u1ebfn t\u1eeb nhi\u1ec1u ngu\u1ed3n kh\u00e1c nhau: application logic processing time, network stack overhead, operating system scheduling delays, database query time, v\u00e0 th\u1eadm ch\u00ed l\u00e0 hardware limitations. \u0110\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t h\u1ec7 th\u1ed1ng th\u1ef1c s\u1ef1 low-latency, ch\u00fang ta c\u1ea7n t\u1ed1i \u01b0u h\u00f3a t\u1ea5t c\u1ea3 c\u00e1c layers n\u00e0y, t\u1eeb vi\u1ec7c ch\u1ecdn programming language ph\u00f9 h\u1ee3p (C++/Rust cho critical paths, Python cho business logic), thi\u1ebft k\u1ebf architecture \u0111\u1ec3 minimize data copying v\u00e0 context switching, s\u1eed d\u1ee5ng lock-free data structures, implement custom memory allocators, \u0111\u1ebfn vi\u1ec7c tune network stack v\u00e0 operating system parameters. Ch\u00fang ta c\u0169ng c\u1ea7n hi\u1ec3u v\u1ec1 hardware: CPU cache hierarchy, memory bandwidth, network interface cards v\u1edbi kernel bypass, v\u00e0 FPGA/ASIC cho c\u00e1c operations c\u1ef1c k\u1ef3 latency-sensitive.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c ph\u00e2n t\u00edch v\u00e0 \u0111o l\u01b0\u1eddng latency trong h\u1ec7 th\u1ed1ng hi\u1ec7n t\u1ea1i, thi\u1ebft k\u1ebf architecture t\u1ed1i \u01b0u cho low-latency, implement c\u00e1c optimization techniques \u1edf m\u1ecdi level (application, system, network, hardware), \u0111\u1ebfn vi\u1ec7c monitoring v\u00e0 continuous improvement. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c trade-offs gi\u1eefa latency v\u00e0 c\u00e1c y\u1ebfu t\u1ed1 kh\u00e1c nh\u01b0 cost, complexity, v\u00e0 maintainability, v\u00e0 khi n\u00e0o th\u00ec vi\u1ec7c optimize latency l\u00e0 \u0111\u00e1ng gi\u00e1. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 ki\u1ebfn th\u1ee9c v\u00e0 tools c\u1ea7n thi\u1ebft \u0111\u1ec3 x\u00e2y d\u1ef1ng m\u1ed9t trading system c\u00f3 th\u1ec3 compete v\u1edbi c\u00e1c h\u1ec7 th\u1ed1ng chuy\u00ean nghi\u1ec7p nh\u1ea5t.</p>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#tai-sao-latency-quan-trong","title":"T\u1ea1i sao Latency quan tr\u1ecdng?","text":"<ol> <li>Arbitrage: C\u01a1 h\u1ed9i arbitrage ch\u1ec9 t\u1ed3n t\u1ea1i trong v\u00e0i milliseconds</li> <li>Market Making: C\u1ea7n ph\u1ea3n \u1ee9ng nhanh v\u1edbi market changes</li> <li>Order Execution: Faster execution = better fill prices</li> <li>Competitive Advantage: Latency th\u1ea5p h\u01a1n = l\u1ee3i th\u1ebf c\u1ea1nh tranh</li> </ol>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#nguon-latency","title":"Ngu\u1ed3n Latency","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Application Logic      ~10-50\u03bcs   \u2502\n\u2502  Network Stack          ~100-500\u03bcs  \u2502\n\u2502  Operating System       ~10-100\u03bcs  \u2502\n\u2502  Hardware (CPU/Memory)  ~1-10\u03bcs     \u2502\n\u2502  Network (Internet)     ~1-50ms     \u2502\n\u2502  Exchange Processing    ~1-10ms     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#buoc-1-architecture-design","title":"B\u01b0\u1edbc 1: Architecture Design","text":"<pre><code># architecture/low_latency_system.py\n\"\"\"\nLow-latency trading system architecture\n\nKey principles:\n1. Minimize allocations\n2. Lock-free data structures\n3. Direct memory access\n4. CPU cache optimization\n5. Network optimization\n\"\"\"\n\nimport asyncio\nfrom collections import deque\nfrom typing import Optional\nimport time\nimport struct\n\nclass LockFreeQueue:\n    \"\"\"Lock-free queue for high-performance message passing\"\"\"\n\n    def __init__(self, maxsize: int = 10000):\n        self.queue = deque(maxlen=maxsize)\n        self.read_pos = 0\n        self.write_pos = 0\n\n    def push(self, item):\n        \"\"\"Push item (non-blocking)\"\"\"\n        if len(self.queue) &lt; self.queue.maxlen:\n            self.queue.append(item)\n            return True\n        return False\n\n    def pop(self):\n        \"\"\"Pop item (non-blocking)\"\"\"\n        if self.queue:\n            return self.queue.popleft()\n        return None\n\nclass MarketDataProcessor:\n    \"\"\"High-performance market data processor\"\"\"\n\n    def __init__(self):\n        self.price_cache = {}  # {symbol: price}\n        self.orderbook_cache = {}  # {symbol: {bids: [], asks: []}}\n        self.update_queue = LockFreeQueue()\n\n    def process_tick(self, symbol: str, price: float, timestamp: int):\n        \"\"\"Process tick update (optimized)\"\"\"\n        # Direct dictionary update (O(1))\n        self.price_cache[symbol] = price\n\n        # Push to queue for async processing\n        self.update_queue.push({\n            'symbol': symbol,\n            'price': price,\n            'timestamp': timestamp\n        })\n\n    def get_price(self, symbol: str) -&gt; Optional[float]:\n        \"\"\"Get latest price (O(1) lookup)\"\"\"\n        return self.price_cache.get(symbol)\n\nclass OrderBook:\n    \"\"\"High-performance order book\"\"\"\n\n    def __init__(self, symbol: str, depth: int = 20):\n        self.symbol = symbol\n        self.depth = depth\n        # Use lists for better cache locality\n        self.bids = []  # [(price, quantity), ...]\n        self.asks = []  # [(price, quantity), ...]\n\n    def update(self, bids: list, asks: list):\n        \"\"\"Update order book (in-place)\"\"\"\n        # Pre-allocate if needed\n        if len(self.bids) &lt; len(bids):\n            self.bids = [None] * len(bids)\n        if len(self.asks) &lt; len(asks):\n            self.asks = [None] * len(asks)\n\n        # Direct assignment (faster than append)\n        for i, (price, qty) in enumerate(bids[:self.depth]):\n            self.bids[i] = (price, qty)\n\n        for i, (price, qty) in enumerate(asks[:self.depth]):\n            self.asks[i] = (price, qty)\n\n    def get_best_bid(self) -&gt; Optional[float]:\n        \"\"\"Get best bid price\"\"\"\n        return self.bids[0][0] if self.bids else None\n\n    def get_best_ask(self) -&gt; Optional[float]:\n        \"\"\"Get best ask price\"\"\"\n        return self.asks[0][0] if self.asks else None\n\n    def get_spread(self) -&gt; Optional[float]:\n        \"\"\"Get bid-ask spread\"\"\"\n        best_bid = self.get_best_bid()\n        best_ask = self.get_best_ask()\n\n        if best_bid and best_ask:\n            return best_ask - best_bid\n        return None\n</code></pre>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#buoc-2-network-optimization","title":"B\u01b0\u1edbc 2: Network Optimization","text":"<pre><code># network/optimized_client.py\nimport asyncio\nimport socket\nimport struct\nfrom typing import Optional\nimport time\n\nclass OptimizedTCPClient:\n    \"\"\"Optimized TCP client for low latency\"\"\"\n\n    def __init__(self, host: str, port: int):\n        self.host = host\n        self.port = port\n        self.sock: Optional[socket.socket] = None\n        self.buffer = bytearray(4096)  # Pre-allocated buffer\n\n    def connect(self):\n        \"\"\"Connect with TCP_NODELAY\"\"\"\n        self.sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n        # TCP optimizations\n        self.sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)  # Disable Nagle\n        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, 1)\n\n        # Set buffer sizes\n        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_SNDBUF, 65536)\n        self.sock.setsockopt(socket.SOL_SOCKET, socket.SO_RCVBUF, 65536)\n\n        self.sock.connect((self.host, self.port))\n\n    def send_binary(self, data: bytes):\n        \"\"\"Send binary data (no encoding overhead)\"\"\"\n        if self.sock:\n            self.sock.sendall(data)\n\n    def receive_binary(self, size: int) -&gt; bytes:\n        \"\"\"Receive binary data\"\"\"\n        if self.sock:\n            return self.sock.recv(size)\n        return b''\n\nclass BinaryProtocol:\n    \"\"\"Binary protocol for market data (faster than JSON)\"\"\"\n\n    @staticmethod\n    def encode_tick(symbol: str, price: float, timestamp: int) -&gt; bytes:\n        \"\"\"Encode tick data as binary\"\"\"\n        # Format: [4 bytes: symbol_len][symbol][8 bytes: price][8 bytes: timestamp]\n        symbol_bytes = symbol.encode('ascii')\n        return struct.pack(f'I{len(symbol_bytes)}sdd', \n                          len(symbol_bytes), symbol_bytes, price, timestamp)\n\n    @staticmethod\n    def decode_tick(data: bytes) -&gt; tuple:\n        \"\"\"Decode tick data from binary\"\"\"\n        symbol_len = struct.unpack('I', data[:4])[0]\n        symbol = data[4:4+symbol_len].decode('ascii')\n        price, timestamp = struct.unpack('dd', data[4+symbol_len:4+symbol_len+16])\n        return symbol, price, timestamp\n</code></pre>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#buoc-3-memory-optimization","title":"B\u01b0\u1edbc 3: Memory Optimization","text":"<pre><code># optimization/memory_pool.py\nfrom typing import List\nimport ctypes\n\nclass MemoryPool:\n    \"\"\"Memory pool to avoid allocations\"\"\"\n\n    def __init__(self, item_size: int, pool_size: int = 1000):\n        self.item_size = item_size\n        self.pool_size = pool_size\n        # Pre-allocate memory\n        self.pool = [bytearray(item_size) for _ in range(pool_size)]\n        self.free_list = list(range(pool_size))\n        self.used = set()\n\n    def acquire(self) -&gt; Optional[bytearray]:\n        \"\"\"Acquire buffer from pool\"\"\"\n        if self.free_list:\n            idx = self.free_list.pop()\n            self.used.add(idx)\n            return self.pool[idx]\n        return None\n\n    def release(self, buffer: bytearray):\n        \"\"\"Release buffer back to pool\"\"\"\n        try:\n            idx = self.pool.index(buffer)\n            if idx in self.used:\n                self.used.remove(idx)\n                self.free_list.append(idx)\n        except ValueError:\n            pass\n\nclass ObjectPool:\n    \"\"\"Object pool for frequently created objects\"\"\"\n\n    def __init__(self, factory, pool_size: int = 100):\n        self.factory = factory\n        self.pool = [factory() for _ in range(pool_size)]\n        self.free_list = list(range(pool_size))\n        self.used = set()\n\n    def acquire(self):\n        \"\"\"Acquire object from pool\"\"\"\n        if self.free_list:\n            idx = self.free_list.pop()\n            self.used.add(idx)\n            obj = self.pool[idx]\n            # Reset object state\n            if hasattr(obj, 'reset'):\n                obj.reset()\n            return obj\n        return self.factory()\n\n    def release(self, obj):\n        \"\"\"Release object back to pool\"\"\"\n        try:\n            idx = self.pool.index(obj)\n            if idx in self.used:\n                self.used.remove(idx)\n                self.free_list.append(idx)\n        except ValueError:\n            pass\n</code></pre>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#buoc-4-cpu-optimization","title":"B\u01b0\u1edbc 4: CPU Optimization","text":"<pre><code># optimization/cpu_optimization.py\nimport os\nimport psutil\nfrom typing import List\n\nclass CPUOptimizer:\n    \"\"\"CPU optimization utilities\"\"\"\n\n    @staticmethod\n    def set_high_priority():\n        \"\"\"Set process to high priority\"\"\"\n        try:\n            p = psutil.Process(os.getpid())\n            p.nice(psutil.HIGH_PRIORITY_CLASS if os.name == 'nt' else -20)\n        except Exception:\n            pass\n\n    @staticmethod\n    def pin_to_cpu(cpu_ids: List[int]):\n        \"\"\"Pin process to specific CPUs\"\"\"\n        try:\n            p = psutil.Process(os.getpid())\n            p.cpu_affinity(cpu_ids)\n        except Exception:\n            pass\n\n    @staticmethod\n    def disable_gc():\n        \"\"\"Disable garbage collection (use with caution)\"\"\"\n        import gc\n        gc.disable()\n</code></pre>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#buoc-5-complete-low-latency-system","title":"B\u01b0\u1edbc 5: Complete Low-Latency System","text":"<pre><code># system/low_latency_trading_system.py\nimport asyncio\nimport time\nfrom architecture.low_latency_system import MarketDataProcessor, OrderBook\nfrom network.optimized_client import OptimizedTCPClient, BinaryProtocol\nfrom optimization.memory_pool import MemoryPool\nfrom optimization.cpu_optimization import CPUOptimizer\n\nclass LowLatencyTradingSystem:\n    \"\"\"Complete low-latency trading system\"\"\"\n\n    def __init__(self):\n        # CPU optimizations\n        CPUOptimizer.set_high_priority()\n        CPUOptimizer.pin_to_cpu([0, 1])  # Pin to first 2 CPUs\n\n        # Memory pool\n        self.memory_pool = MemoryPool(item_size=256, pool_size=1000)\n\n        # Market data\n        self.market_data = MarketDataProcessor()\n        self.orderbooks = {}  # {symbol: OrderBook}\n\n        # Network\n        self.client = None\n\n        # Latency tracking\n        self.latency_stats = {\n            'min': float('inf'),\n            'max': 0,\n            'avg': 0,\n            'count': 0\n        }\n\n    def connect(self, host: str, port: int):\n        \"\"\"Connect to exchange\"\"\"\n        self.client = OptimizedTCPClient(host, port)\n        self.client.connect()\n\n    def process_market_data(self, data: bytes):\n        \"\"\"Process incoming market data\"\"\"\n        start_time = time.perf_counter()\n\n        # Decode binary data\n        symbol, price, timestamp = BinaryProtocol.decode_tick(data)\n\n        # Process tick\n        self.market_data.process_tick(symbol, price, timestamp)\n\n        # Update orderbook if needed\n        if symbol not in self.orderbooks:\n            self.orderbooks[symbol] = OrderBook(symbol)\n\n        # Calculate latency\n        latency = (time.perf_counter() - start_time) * 1e6  # microseconds\n\n        self.update_latency_stats(latency)\n\n    def update_latency_stats(self, latency: float):\n        \"\"\"Update latency statistics\"\"\"\n        stats = self.latency_stats\n        stats['min'] = min(stats['min'], latency)\n        stats['max'] = max(stats['max'], latency)\n        stats['count'] += 1\n        stats['avg'] = (\n            (stats['avg'] * (stats['count'] - 1) + latency) / stats['count']\n        )\n\n    def get_latency_report(self) -&gt; dict:\n        \"\"\"Get latency statistics\"\"\"\n        return self.latency_stats.copy()\n\n    async def run(self):\n        \"\"\"Main event loop\"\"\"\n        while True:\n            # Receive data\n            data = self.client.receive_binary(256)\n\n            if data:\n                self.process_market_data(data)\n\n            # Small sleep to prevent CPU spinning\n            await asyncio.sleep(0.0001)  # 100 microseconds\n\n# Usage\nif __name__ == '__main__':\n    system = LowLatencyTradingSystem()\n    system.connect('exchange.example.com', 8080)\n\n    asyncio.run(system.run())\n</code></pre>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#best-practices","title":"Best Practices","text":"<ol> <li>Minimize Allocations: Reuse objects, use memory pools</li> <li>Lock-Free: Use lock-free data structures</li> <li>CPU Affinity: Pin to specific CPUs</li> <li>Network Tuning: TCP_NODELAY, optimal buffer sizes</li> <li>Binary Protocols: Avoid JSON/text parsing</li> <li>Direct Memory: Use direct memory access</li> <li>Profile Everything: Measure, don't guess</li> </ol>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#hardware-considerations","title":"Hardware Considerations","text":"<ol> <li>Co-location: Host servers near exchange</li> <li>Network: Use dedicated lines, low-latency switches</li> <li>CPU: High-frequency CPUs (Intel Xeon, AMD EPYC)</li> <li>Memory: Low-latency RAM (DDR4/DDR5)</li> <li>Storage: NVMe SSDs for logging</li> </ol>"},{"location":"blog/2025/01/25/thi%E1%BA%BFt-k%E1%BA%BF-low-latency-trading-system---t%E1%BB%91i-%C6%B0u-t%E1%BB%ABng-microsecond/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>X\u00e2y d\u1ef1ng low-latency system \u0111\u00f2i h\u1ecfi: - Deep understanding c\u1ee7a hardware v\u00e0 software - Continuous profiling v\u00e0 optimization - Trade-offs gi\u1eefa complexity v\u00e0 performance</p> <p>Nh\u1edb: Premature optimization is the root of all evil - nh\u01b0ng trong trading, latency IS the product.</p>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/","title":"Message Queues cho Trading Systems","text":"<p>Trong ki\u1ebfn tr\u00fac c\u1ee7a modern trading systems, message queues \u0111\u00f3ng vai tr\u00f2 nh\u01b0 nh\u1eefng \u0111\u01b0\u1eddng \u1ed1ng d\u1eabn quan tr\u1ecdng, k\u1ebft n\u1ed1i c\u00e1c components kh\u00e1c nhau v\u00e0 \u0111\u1ea3m b\u1ea3o d\u1eef li\u1ec7u \u0111\u01b0\u1ee3c truy\u1ec1n t\u1ea3i m\u1ed9t c\u00e1ch reliable, scalable, v\u00e0 efficient. Kh\u00f4ng gi\u1ed1ng nh\u01b0 synchronous request-response patterns, message queues cho ph\u00e9p c\u00e1c services giao ti\u1ebfp v\u1edbi nhau m\u1ed9t c\u00e1ch asynchronous, decoupling producers v\u00e0 consumers, cho ph\u00e9p h\u1ec7 th\u1ed1ng scale t\u1eebng component \u0111\u1ed9c l\u1eadp, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 \u0111\u1ea3m b\u1ea3o kh\u00f4ng m\u1ea5t d\u1eef li\u1ec7u ngay c\u1ea3 khi m\u1ed9t component t\u1ea1m th\u1eddi kh\u00f4ng available. Trong trading systems, n\u01a1i m\u00e0 market data c\u00f3 th\u1ec3 \u0111\u1ebfn v\u1edbi t\u1ed1c \u0111\u1ed9 h\u00e0ng ngh\u00ecn messages m\u1ed7i gi\u00e2y, v\u00e0 vi\u1ec7c m\u1ea5t m\u1ed9t message c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn quy\u1ebft \u0111\u1ecbnh trading sai l\u1ea7m, message queues kh\u00f4ng ch\u1ec9 l\u00e0 m\u1ed9t nice-to-have m\u00e0 l\u00e0 m\u1ed9t requirement thi\u1ebft y\u1ebfu.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau kh\u00e1m ph\u00e1 c\u00e1ch s\u1eed d\u1ee5ng message queues trong trading systems, t\u1eeb vi\u1ec7c l\u1ef1a ch\u1ecdn message queue ph\u00f9 h\u1ee3p (RabbitMQ cho simple use cases, Apache Kafka cho high-throughput scenarios, Redis Streams cho low-latency requirements), thi\u1ebft k\u1ebf message schemas v\u00e0 routing strategies, implement producers v\u00e0 consumers, \u0111\u1ebfn vi\u1ec7c x\u1eed l\u00fd c\u00e1c edge cases nh\u01b0 message ordering, duplicate detection, v\u00e0 dead letter queues. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch implement c\u00e1c patterns ph\u1ed5 bi\u1ebfn nh\u01b0 pub/sub \u0111\u1ec3 broadcast market data \u0111\u1ebfn nhi\u1ec1u consumers, request-reply patterns cho synchronous operations, v\u00e0 event sourcing \u0111\u1ec3 maintain state. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c trade-offs gi\u1eefa different message queue technologies v\u00e0 khi n\u00e0o n\u00ean s\u1eed d\u1ee5ng c\u00e1i n\u00e0o.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup message queue infrastructure, thi\u1ebft k\u1ebf message schemas v\u00e0 topics, implement producers v\u00e0 consumers v\u1edbi error handling v\u00e0 retry logic, \u0111\u1ebfn vi\u1ec7c monitor v\u00e0 optimize performance. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch handle backpressure khi consumers kh\u00f4ng th\u1ec3 keep up v\u1edbi producers, implement message prioritization, v\u00e0 scale systems horizontally. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay ki\u1ebfn th\u1ee9c v\u00e0 tools c\u1ea7n thi\u1ebft \u0111\u1ec3 x\u00e2y d\u1ef1ng trading systems c\u00f3 kh\u1ea3 n\u0103ng scale v\u00e0 reliable cao.</p>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#tai-sao-can-message-queues","title":"T\u1ea1i sao c\u1ea7n Message Queues?","text":"<ol> <li>Decoupling: T\u00e1ch c\u00e1c components \u0111\u1ed9c l\u1eadp</li> <li>Scalability: Scale t\u1eebng component ri\u00eang bi\u1ec7t</li> <li>Reliability: Guaranteed delivery, retry mechanisms</li> <li>Buffering: Handle traffic spikes</li> <li>Asynchronous Processing: Non-blocking operations</li> </ol>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#message-queue-options","title":"Message Queue Options","text":""},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#1-rabbitmq","title":"1. RabbitMQ","text":"<ul> <li>Pros: Easy setup, good for simple use cases</li> <li>Cons: Performance limitations at very high throughput</li> </ul>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#2-apache-kafka","title":"2. Apache Kafka","text":"<ul> <li>Pros: High throughput, distributed, durable</li> <li>Cons: More complex, overkill for simple cases</li> </ul>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#3-redis-streams","title":"3. Redis Streams","text":"<ul> <li>Pros: Simple, fast, good for real-time</li> <li>Cons: Less features than dedicated MQ</li> </ul>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#buoc-1-rabbitmq-setup","title":"B\u01b0\u1edbc 1: RabbitMQ Setup","text":"<pre><code># messaging/rabbitmq_setup.py\nimport pika\nimport json\nimport logging\nfrom typing import Callable, Optional\n\nclass RabbitMQClient:\n    \"\"\"RabbitMQ client wrapper\"\"\"\n\n    def __init__(self, host: str = 'localhost', port: int = 5672,\n                 username: str = 'guest', password: str = 'guest'):\n        self.connection_params = pika.ConnectionParameters(\n            host=host,\n            port=port,\n            credentials=pika.PlainCredentials(username, password)\n        )\n        self.connection = None\n        self.channel = None\n        self.logger = logging.getLogger(__name__)\n\n    def connect(self):\n        \"\"\"Establish connection\"\"\"\n        self.connection = pika.BlockingConnection(self.connection_params)\n        self.channel = self.connection.channel()\n\n    def declare_exchange(self, exchange: str, exchange_type: str = 'topic'):\n        \"\"\"Declare exchange\"\"\"\n        self.channel.exchange_declare(\n            exchange=exchange,\n            exchange_type=exchange_type,\n            durable=True\n        )\n\n    def declare_queue(self, queue: str, durable: bool = True):\n        \"\"\"Declare queue\"\"\"\n        self.channel.queue_declare(queue=queue, durable=durable)\n\n    def bind_queue(self, queue: str, exchange: str, routing_key: str):\n        \"\"\"Bind queue to exchange\"\"\"\n        self.channel.queue_bind(\n            queue=queue,\n            exchange=exchange,\n            routing_key=routing_key\n        )\n\n    def publish(self, exchange: str, routing_key: str, message: dict):\n        \"\"\"Publish message\"\"\"\n        self.channel.basic_publish(\n            exchange=exchange,\n            routing_key=routing_key,\n            body=json.dumps(message),\n            properties=pika.BasicProperties(\n                delivery_mode=2,  # Make message persistent\n            )\n        )\n\n    def consume(self, queue: str, callback: Callable, auto_ack: bool = False):\n        \"\"\"Consume messages\"\"\"\n        self.channel.basic_consume(\n            queue=queue,\n            on_message_callback=callback,\n            auto_ack=auto_ack\n        )\n        self.channel.start_consuming()\n\n    def close(self):\n        \"\"\"Close connection\"\"\"\n        if self.connection and not self.connection.is_closed:\n            self.connection.close()\n</code></pre>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#buoc-2-trading-event-publisher","title":"B\u01b0\u1edbc 2: Trading Event Publisher","text":"<pre><code># messaging/trading_events.py\nfrom messaging.rabbitmq_setup import RabbitMQClient\nfrom typing import Dict\nimport logging\n\nclass TradingEventPublisher:\n    \"\"\"Publish trading events to message queue\"\"\"\n\n    def __init__(self, rabbitmq: RabbitMQClient):\n        self.mq = rabbitmq\n        self.exchange = 'trading_events'\n        self.logger = logging.getLogger(__name__)\n\n        # Setup exchange\n        self.mq.declare_exchange(self.exchange, 'topic')\n\n    def publish_ticker_update(self, symbol: str, exchange: str, price: float):\n        \"\"\"Publish ticker update event\"\"\"\n        event = {\n            'type': 'ticker_update',\n            'symbol': symbol,\n            'exchange': exchange,\n            'price': price,\n            'timestamp': datetime.now().isoformat()\n        }\n\n        routing_key = f\"ticker.{exchange}.{symbol}\"\n        self.mq.publish(self.exchange, routing_key, event)\n        self.logger.debug(f\"Published ticker update: {routing_key}\")\n\n    def publish_trade_executed(self, order_id: str, symbol: str, \n                             price: float, quantity: float, side: str):\n        \"\"\"Publish trade executed event\"\"\"\n        event = {\n            'type': 'trade_executed',\n            'order_id': order_id,\n            'symbol': symbol,\n            'price': price,\n            'quantity': quantity,\n            'side': side,\n            'timestamp': datetime.now().isoformat()\n        }\n\n        routing_key = f\"trade.{symbol}\"\n        self.mq.publish(self.exchange, routing_key, event)\n        self.logger.info(f\"Published trade executed: {order_id}\")\n\n    def publish_signal(self, symbol: str, signal: str, strength: float):\n        \"\"\"Publish trading signal\"\"\"\n        event = {\n            'type': 'signal',\n            'symbol': symbol,\n            'signal': signal,  # 'BUY', 'SELL', 'HOLD'\n            'strength': strength,\n            'timestamp': datetime.now().isoformat()\n        }\n\n        routing_key = f\"signal.{symbol}\"\n        self.mq.publish(self.exchange, routing_key, event)\n        self.logger.info(f\"Published signal: {symbol} - {signal}\")\n</code></pre>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#buoc-3-event-consumers","title":"B\u01b0\u1edbc 3: Event Consumers","text":"<pre><code># messaging/event_consumers.py\nfrom messaging.rabbitmq_setup import RabbitMQClient\nimport json\nimport logging\nfrom typing import Dict\n\nclass TradingEventConsumer:\n    \"\"\"Consume trading events\"\"\"\n\n    def __init__(self, rabbitmq: RabbitMQClient):\n        self.mq = rabbitmq\n        self.exchange = 'trading_events'\n        self.logger = logging.getLogger(__name__)\n\n    def setup_ticker_consumer(self, queue: str, routing_key: str):\n        \"\"\"Setup consumer for ticker updates\"\"\"\n        self.mq.declare_queue(queue)\n        self.mq.bind_queue(queue, self.exchange, routing_key)\n\n        def callback(ch, method, properties, body):\n            try:\n                event = json.loads(body)\n                self.handle_ticker_update(event)\n                ch.basic_ack(delivery_tag=method.delivery_tag)\n            except Exception as e:\n                self.logger.error(f\"Error processing ticker: {e}\")\n                ch.basic_nack(delivery_tag=method.delivery_tag, requeue=True)\n\n        self.mq.channel.basic_consume(\n            queue=queue,\n            on_message_callback=callback\n        )\n\n    def setup_trade_consumer(self, queue: str, routing_key: str):\n        \"\"\"Setup consumer for trade events\"\"\"\n        self.mq.declare_queue(queue)\n        self.mq.bind_queue(queue, self.exchange, routing_key)\n\n        def callback(ch, method, properties, body):\n            try:\n                event = json.loads(body)\n                self.handle_trade_executed(event)\n                ch.basic_ack(delivery_tag=method.delivery_tag)\n            except Exception as e:\n                self.logger.error(f\"Error processing trade: {e}\")\n                ch.basic_nack(delivery_tag=method.delivery_tag, requeue=True)\n\n        self.mq.channel.basic_consume(\n            queue=queue,\n            on_message_callback=callback\n        )\n\n    def handle_ticker_update(self, event: Dict):\n        \"\"\"Handle ticker update\"\"\"\n        self.logger.info(f\"Ticker update: {event['symbol']} = ${event['price']}\")\n        # Update database, cache, etc.\n\n    def handle_trade_executed(self, event: Dict):\n        \"\"\"Handle trade executed\"\"\"\n        self.logger.info(f\"Trade executed: {event['order_id']}\")\n        # Update portfolio, send notifications, etc.\n</code></pre>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#buoc-4-kafka-producer","title":"B\u01b0\u1edbc 4: Kafka Producer","text":"<pre><code># messaging/kafka_producer.py\nfrom kafka import KafkaProducer\nimport json\nimport logging\nfrom typing import Dict\n\nclass KafkaTradingProducer:\n    \"\"\"Kafka producer for trading events\"\"\"\n\n    def __init__(self, bootstrap_servers: List[str]):\n        self.producer = KafkaProducer(\n            bootstrap_servers=bootstrap_servers,\n            value_serializer=lambda v: json.dumps(v).encode('utf-8'),\n            acks='all',  # Wait for all replicas\n            retries=3,\n            max_in_flight_requests_per_connection=1\n        )\n        self.logger = logging.getLogger(__name__)\n\n    def publish_ticker(self, topic: str, symbol: str, exchange: str, price: float):\n        \"\"\"Publish ticker to Kafka\"\"\"\n        message = {\n            'symbol': symbol,\n            'exchange': exchange,\n            'price': price,\n            'timestamp': datetime.now().isoformat()\n        }\n\n        future = self.producer.send(topic, value=message, key=symbol.encode())\n\n        # Wait for result\n        try:\n            record_metadata = future.get(timeout=10)\n            self.logger.debug(\n                f\"Published to {record_metadata.topic} \"\n                f\"partition {record_metadata.partition} \"\n                f\"offset {record_metadata.offset}\"\n            )\n        except Exception as e:\n            self.logger.error(f\"Error publishing: {e}\")\n\n    def flush(self):\n        \"\"\"Flush pending messages\"\"\"\n        self.producer.flush()\n\n    def close(self):\n        \"\"\"Close producer\"\"\"\n        self.producer.close()\n</code></pre>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#buoc-5-kafka-consumer","title":"B\u01b0\u1edbc 5: Kafka Consumer","text":"<pre><code># messaging/kafka_consumer.py\nfrom kafka import KafkaConsumer\nimport json\nimport logging\nfrom typing import Callable, List\n\nclass KafkaTradingConsumer:\n    \"\"\"Kafka consumer for trading events\"\"\"\n\n    def __init__(self, bootstrap_servers: List[str], group_id: str):\n        self.consumer = KafkaConsumer(\n            bootstrap_servers=bootstrap_servers,\n            group_id=group_id,\n            value_deserializer=lambda m: json.loads(m.decode('utf-8')),\n            auto_offset_reset='earliest',\n            enable_auto_commit=False\n        )\n        self.logger = logging.getLogger(__name__)\n\n    def subscribe(self, topics: List[str]):\n        \"\"\"Subscribe to topics\"\"\"\n        self.consumer.subscribe(topics)\n\n    def consume(self, callback: Callable):\n        \"\"\"Consume messages\"\"\"\n        try:\n            for message in self.consumer:\n                try:\n                    callback(message.value)\n                    self.consumer.commit()\n                except Exception as e:\n                    self.logger.error(f\"Error processing message: {e}\")\n                    # Don't commit on error\n        except KeyboardInterrupt:\n            self.logger.info(\"Consumer stopped\")\n        finally:\n            self.consumer.close()\n</code></pre>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#buoc-6-event-driven-trading-system","title":"B\u01b0\u1edbc 6: Event-Driven Trading System","text":"<pre><code># messaging/event_driven_system.py\nfrom messaging.trading_events import TradingEventPublisher\nfrom messaging.event_consumers import TradingEventConsumer\nfrom messaging.rabbitmq_setup import RabbitMQClient\nimport threading\n\nclass EventDrivenTradingSystem:\n    \"\"\"Event-driven trading system\"\"\"\n\n    def __init__(self):\n        # Setup message queue\n        self.mq = RabbitMQClient()\n        self.mq.connect()\n\n        # Publishers\n        self.event_publisher = TradingEventPublisher(self.mq)\n\n        # Consumers\n        self.event_consumer = TradingEventConsumer(self.mq)\n\n        # Setup consumers\n        self.setup_consumers()\n\n    def setup_consumers(self):\n        \"\"\"Setup all consumers\"\"\"\n        # Ticker consumer\n        self.event_consumer.setup_ticker_consumer(\n            'ticker_updates',\n            'ticker.*.*'\n        )\n\n        # Trade consumer\n        self.event_consumer.setup_trade_consumer(\n            'trade_executions',\n            'trade.*'\n        )\n\n    def start_consumers(self):\n        \"\"\"Start consuming in background thread\"\"\"\n        def run():\n            self.mq.channel.start_consuming()\n\n        thread = threading.Thread(target=run, daemon=True)\n        thread.start()\n\n    def publish_ticker(self, symbol: str, exchange: str, price: float):\n        \"\"\"Publish ticker update\"\"\"\n        self.event_publisher.publish_ticker_update(symbol, exchange, price)\n\n    def publish_trade(self, order_id: str, symbol: str, price: float,\n                     quantity: float, side: str):\n        \"\"\"Publish trade\"\"\"\n        self.event_publisher.publish_trade_executed(\n            order_id, symbol, price, quantity, side\n        )\n\n# Usage\nif __name__ == '__main__':\n    system = EventDrivenTradingSystem()\n    system.start_consumers()\n\n    # Publish events\n    system.publish_ticker('BTCUSDT', 'binance', 50000)\n    system.publish_trade('order123', 'BTCUSDT', 50000, 0.001, 'BUY')\n</code></pre>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#best-practices","title":"Best Practices","text":"<ol> <li>Message Durability: Enable persistence for critical messages</li> <li>Acknowledgment: Use manual ack for reliability</li> <li>Error Handling: Implement retry and dead letter queues</li> <li>Idempotency: Make consumers idempotent</li> <li>Partitioning: Partition by symbol for better parallelism</li> <li>Monitoring: Monitor queue depth, consumer lag</li> <li>Backpressure: Handle when consumers are slow</li> </ol>"},{"location":"blog/2025/01/25/message-queues-cho-trading-systems---rabbitmq-kafka-v%C3%A0-event-driven-architecture/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Message queues enable: - Scalable architecture - Reliable message delivery - Decoupled components - Better fault tolerance</p> <p>Ch\u1ecdn message queue ph\u00f9 h\u1ee3p v\u1edbi requirements c\u1ee7a b\u1ea1n!</p>"},{"location":"blog/2025/01/25/pattern-recognition-trong-trading---ph%C3%A1t-hi%E1%BB%87n-chart-patterns-v%E1%BB%9Bi-python/","title":"Pattern Recognition trong Trading","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a technical analysis, chart patterns l\u00e0 nh\u1eefng c\u00f4ng c\u1ee5 m\u1ea1nh m\u1ebd gi\u00fap c\u00e1c nh\u00e0 giao d\u1ecbch d\u1ef1 \u0111o\u00e1n c\u00e1c bi\u1ebfn \u0111\u1ed9ng gi\u00e1 trong t\u01b0\u01a1ng lai d\u1ef1a tr\u00ean c\u00e1c m\u1eabu h\u00ecnh \u0111\u01b0\u1ee3c h\u00ecnh th\u00e0nh b\u1edfi h\u00e0nh \u0111\u1ed9ng gi\u00e1 trong qu\u00e1 kh\u1ee9. T\u1eeb nh\u1eefng patterns c\u1ed5 \u0111i\u1ec3n nh\u01b0 Head and Shoulders, Double Top/Bottom, Triangles, \u0111\u1ebfn nh\u1eefng patterns ph\u1ee9c t\u1ea1p h\u01a1n nh\u01b0 Cup and Handle, Flags v\u00e0 Pennants, m\u1ed7i pattern \u0111\u1ec1u mang trong m\u00ecnh m\u1ed9t c\u00e2u chuy\u1ec7n v\u1ec1 t\u00e2m l\u00fd th\u1ecb tr\u01b0\u1eddng v\u00e0 s\u1ef1 c\u00e2n b\u1eb1ng gi\u1eefa l\u1ef1c mua v\u00e0 l\u1ef1c b\u00e1n. Vi\u1ec7c nh\u1eadn di\u1ec7n ch\u00ednh x\u00e1c c\u00e1c patterns n\u00e0y kh\u00f4ng ch\u1ec9 gi\u00fap c\u00e1c nh\u00e0 giao d\u1ecbch x\u00e1c \u0111\u1ecbnh c\u00e1c \u0111i\u1ec3m v\u00e0o l\u1ec7nh v\u00e0 tho\u00e1t l\u1ec7nh t\u1ed1i \u01b0u, m\u00e0 c\u00f2n cung c\u1ea5p insights v\u1ec1 kh\u1ea3 n\u0103ng \u0111\u1ea3o chi\u1ec1u ho\u1eb7c ti\u1ebfp t\u1ee5c xu h\u01b0\u1edbng c\u1ee7a th\u1ecb tr\u01b0\u1eddng.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau implement m\u1ed9t h\u1ec7 th\u1ed1ng pattern recognition ho\u00e0n ch\u1ec9nh s\u1eed d\u1ee5ng Python, t\u1eeb vi\u1ec7c ph\u00e1t hi\u1ec7n c\u00e1c chart patterns ph\u1ed5 bi\u1ebfn nh\u1ea5t trong trading, \u0111\u1ebfn vi\u1ec7c validate v\u00e0 filter c\u00e1c patterns \u0111\u1ec3 tr\u00e1nh false signals. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng c\u00e1c k\u1ef9 thu\u1eadt t\u1eeb computer vision v\u00e0 signal processing \u0111\u1ec3 nh\u1eadn di\u1ec7n patterns m\u1ed9t c\u00e1ch t\u1ef1 \u0111\u1ed9ng, k\u1ebft h\u1ee3p v\u1edbi c\u00e1c ch\u1ec9 b\u00e1o k\u1ef9 thu\u1eadt \u0111\u1ec3 t\u0103ng \u0111\u1ed9 ch\u00ednh x\u00e1c, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 backtest c\u00e1c patterns \u0111\u1ec3 \u0111\u00e1nh gi\u00e1 hi\u1ec7u qu\u1ea3 th\u1ef1c t\u1ebf c\u1ee7a ch\u00fang. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch implement c\u00e1c algorithms \u0111\u1ec3 detect Head and Shoulders, Triangles, Flags, v\u00e0 nhi\u1ec1u patterns kh\u00e1c, c\u00f9ng v\u1edbi vi\u1ec7c t\u00ednh to\u00e1n c\u00e1c metrics nh\u01b0 pattern completion probability, target price levels, v\u00e0 stop loss levels.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c x\u1eed l\u00fd v\u00e0 chu\u1ea9n b\u1ecb d\u1eef li\u1ec7u gi\u00e1, implement c\u00e1c algorithms \u0111\u1ec3 detect patterns, validate patterns v\u1edbi c\u00e1c \u0111i\u1ec1u ki\u1ec7n k\u1ef9 thu\u1eadt, \u0111\u1ebfn vi\u1ec7c t\u00edch h\u1ee3p pattern recognition v\u00e0o trading strategies. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch s\u1eed d\u1ee5ng machine learning \u0111\u1ec3 improve pattern detection accuracy, backtest patterns tr\u00ean historical data, v\u00e0 optimize parameters. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t h\u1ec7 th\u1ed1ng pattern recognition m\u1ea1nh m\u1ebd, c\u00f3 th\u1ec3 t\u1ef1 \u0111\u1ed9ng ph\u00e1t hi\u1ec7n v\u00e0 trade c\u00e1c chart patterns m\u1ed9t c\u00e1ch ch\u00ednh x\u00e1c.</p>"},{"location":"blog/2025/01/25/pattern-recognition-trong-trading---ph%C3%A1t-hi%E1%BB%87n-chart-patterns-v%E1%BB%9Bi-python/#common-chart-patterns","title":"Common Chart Patterns","text":"<ol> <li>Head and Shoulders</li> <li>Double Top/Bottom</li> <li>Triangles (Ascending, Descending, Symmetrical)</li> <li>Flags and Pennants</li> <li>Cup and Handle</li> </ol>"},{"location":"blog/2025/01/25/pattern-recognition-trong-trading---ph%C3%A1t-hi%E1%BB%87n-chart-patterns-v%E1%BB%9Bi-python/#implementation","title":"Implementation","text":"<pre><code># patterns/pattern_recognition.py\nimport pandas as pd\nimport numpy as np\nfrom scipy.signal import find_peaks\n\nclass PatternRecognizer:\n    \"\"\"Recognize chart patterns\"\"\"\n\n    def find_head_shoulders(self, prices: pd.Series) -&gt; List[Dict]:\n        \"\"\"Find head and shoulders pattern\"\"\"\n        # Find peaks\n        peaks, properties = find_peaks(prices, distance=10)\n\n        patterns = []\n        for i in range(len(peaks) - 2):\n            left_shoulder = peaks[i]\n            head = peaks[i + 1]\n            right_shoulder = peaks[i + 2]\n\n            # Check if head is higher than shoulders\n            if (prices.iloc[head] &gt; prices.iloc[left_shoulder] and\n                prices.iloc[head] &gt; prices.iloc[right_shoulder]):\n                patterns.append({\n                    'type': 'head_shoulders',\n                    'left_shoulder': left_shoulder,\n                    'head': head,\n                    'right_shoulder': right_shoulder\n                })\n\n        return patterns\n\n    def find_triangles(self, highs: pd.Series, lows: pd.Series) -&gt; List[Dict]:\n        \"\"\"Find triangle patterns\"\"\"\n        # Implementation\n        pass\n</code></pre>"},{"location":"blog/2025/01/25/pattern-recognition-trong-trading---ph%C3%A1t-hi%E1%BB%87n-chart-patterns-v%E1%BB%9Bi-python/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Pattern recognition gi\u00fap identify trading opportunities!</p>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/","title":"Real-time Data Processing v\u1edbi WebSocket","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a algorithmic trading v\u00e0 high-frequency trading, vi\u1ec7c nh\u1eadn v\u00e0 x\u1eed l\u00fd d\u1eef li\u1ec7u th\u1ecb tr\u01b0\u1eddng real-time kh\u00f4ng ch\u1ec9 l\u00e0 m\u1ed9t y\u00eau c\u1ea7u - n\u00f3 l\u00e0 y\u1ebfu t\u1ed1 s\u1ed1ng c\u00f2n. M\u1ed7i tick c\u1ee7a gi\u00e1, m\u1ed7i order book update, m\u1ed7i trade execution \u0111\u1ec1u ch\u1ee9a \u0111\u1ef1ng th\u00f4ng tin qu\u00fd gi\u00e1 c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng \u0111\u1ec3 \u0111\u01b0a ra quy\u1ebft \u0111\u1ecbnh trading trong v\u00f2ng v\u00e0i milliseconds. Trong khi REST APIs truy\u1ec1n th\u1ed1ng y\u00eau c\u1ea7u client ph\u1ea3i li\u00ean t\u1ee5c polling \u0111\u1ec3 l\u1ea5y d\u1eef li\u1ec7u m\u1edbi (g\u00e2y ra overhead l\u1edbn v\u00e0 \u0111\u1ed9 tr\u1ec5 cao), WebSocket cung c\u1ea5p m\u1ed9t k\u00eanh giao ti\u1ebfp persistent, bidirectional, v\u00e0 low-latency, cho ph\u00e9p server push d\u1eef li\u1ec7u \u0111\u1ebfn client ngay l\u1eadp t\u1ee9c khi c\u00f3 thay \u0111\u1ed5i. \u0110i\u1ec1u n\u00e0y \u0111\u1eb7c bi\u1ec7t quan tr\u1ecdng trong trading, n\u01a1i m\u00e0 m\u1ed7i mili gi\u00e2y \u0111\u1ec1u c\u00f3 gi\u00e1 tr\u1ecb v\u00e0 vi\u1ec7c nh\u1eadn \u0111\u01b0\u1ee3c th\u00f4ng tin gi\u00e1 m\u1edbi nh\u1ea5t c\u00f3 th\u1ec3 quy\u1ebft \u0111\u1ecbnh th\u00e0nh b\u1ea1i c\u1ee7a m\u1ed9t giao d\u1ecbch.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng m\u1ed9t h\u1ec7 th\u1ed1ng x\u1eed l\u00fd d\u1eef li\u1ec7u real-time ho\u00e0n ch\u1ec9nh s\u1eed d\u1ee5ng WebSocket, t\u1eeb vi\u1ec7c thi\u1ebft l\u1eadp k\u1ebft n\u1ed1i v\u1edbi exchange WebSocket APIs (Binance, Bybit, OKX), qu\u1ea3n l\u00fd connections v\u00e0 handle reconnections, parse v\u00e0 process market data streams (ticker, order book, trades, klines), \u0111\u1ebfn vi\u1ec7c x\u00e2y d\u1ef1ng data pipeline \u0111\u1ec3 transform, enrich, v\u00e0 store d\u1eef li\u1ec7u. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch x\u1eed l\u00fd high-frequency data streams v\u1edbi h\u00e0ng ngh\u00ecn messages m\u1ed7i gi\u00e2y, implement buffering v\u00e0 batching strategies \u0111\u1ec3 optimize performance, handle backpressure khi h\u1ec7 th\u1ed1ng kh\u00f4ng th\u1ec3 keep up v\u1edbi data rate, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 \u0111\u1ea3m b\u1ea3o kh\u00f4ng m\u1ea5t d\u1eef li\u1ec7u ngay c\u1ea3 khi c\u00f3 network issues ho\u1eb7c system failures.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup WebSocket clients, implement connection management v\u00e0 reconnection logic, parse v\u00e0 validate incoming messages, \u0111\u1ebfn vi\u1ec7c x\u00e2y d\u1ef1ng data processing pipeline v\u1edbi async/await patterns, implement caching v\u00e0 aggregation, v\u00e0 integrate v\u1edbi databases v\u00e0 message queues. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch monitor v\u00e0 debug WebSocket connections, optimize performance, v\u00e0 scale systems \u0111\u1ec3 x\u1eed l\u00fd multiple symbols v\u00e0 exchanges c\u00f9ng l\u00fac. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t h\u1ec7 th\u1ed1ng x\u1eed l\u00fd d\u1eef li\u1ec7u real-time m\u1ea1nh m\u1ebd, c\u00f3 th\u1ec3 handle high-frequency market data streams m\u1ed9t c\u00e1ch reliable v\u00e0 efficient.</p>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#tai-sao-websocket-cho-trading","title":"T\u1ea1i sao WebSocket cho Trading?","text":"<ol> <li>Low Latency: K\u1ebft n\u1ed1i persistent, kh\u00f4ng c\u1ea7n HTTP overhead</li> <li>Real-time: Push data ngay khi c\u00f3 thay \u0111\u1ed5i</li> <li>Efficient: \u00cdt bandwidth h\u01a1n polling</li> <li>Bidirectional: C\u00f3 th\u1ec3 g\u1eedi commands v\u00e0 nh\u1eadn data</li> </ol>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#kien-truc-he-thong","title":"Ki\u1ebfn tr\u00fac h\u1ec7 th\u1ed1ng","text":"<pre><code>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Exchange   \u2502\n\u2502  WebSocket   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  WebSocket Client   \u2502\n\u2502  (Connection Mgr)  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Data Processor     \u2502\n\u2502  (Normalize/Filter) \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Event Bus          \u2502\n\u2502  (Redis/RabbitMQ)   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2502\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  Consumers          \u2502\n\u2502  (Strategy/DB)      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#buoc-1-websocket-client-base-class","title":"B\u01b0\u1edbc 1: WebSocket Client Base Class","text":"<pre><code># websocket/base_client.py\nimport asyncio\nimport websockets\nimport json\nimport logging\nfrom typing import Callable, Optional, Dict, List\nfrom abc import ABC, abstractmethod\n\nclass BaseWebSocketClient(ABC):\n    \"\"\"Base class cho WebSocket clients\"\"\"\n\n    def __init__(self, url: str, reconnect_interval: int = 5):\n        self.url = url\n        self.reconnect_interval = reconnect_interval\n        self.ws = None\n        self.running = False\n        self.subscriptions = []\n        self.callbacks: Dict[str, List[Callable]] = {}\n        self.logger = logging.getLogger(__name__)\n\n    @abstractmethod\n    def subscribe(self, channels: List[str]):\n        \"\"\"Subscribe to channels\"\"\"\n        pass\n\n    @abstractmethod\n    def handle_message(self, message: dict):\n        \"\"\"Handle incoming message\"\"\"\n        pass\n\n    def on(self, event: str, callback: Callable):\n        \"\"\"Register event callback\"\"\"\n        if event not in self.callbacks:\n            self.callbacks[event] = []\n        self.callbacks[event].append(callback)\n\n    def emit(self, event: str, data: dict):\n        \"\"\"Emit event to callbacks\"\"\"\n        if event in self.callbacks:\n            for callback in self.callbacks[event]:\n                try:\n                    callback(data)\n                except Exception as e:\n                    self.logger.error(f\"Callback error: {e}\")\n\n    async def connect(self):\n        \"\"\"Connect to WebSocket\"\"\"\n        while not self.running:\n            try:\n                self.logger.info(f\"Connecting to {self.url}\")\n                async with websockets.connect(self.url) as ws:\n                    self.ws = ws\n                    self.running = True\n                    self.emit('connect', {})\n\n                    # Subscribe to channels\n                    if self.subscriptions:\n                        await self.subscribe(self.subscriptions)\n\n                    # Listen for messages\n                    async for message in ws:\n                        try:\n                            data = json.loads(message)\n                            self.handle_message(data)\n                        except json.JSONDecodeError:\n                            self.logger.warning(f\"Invalid JSON: {message}\")\n                        except Exception as e:\n                            self.logger.error(f\"Error handling message: {e}\")\n\n            except websockets.exceptions.ConnectionClosed:\n                self.logger.warning(\"Connection closed, reconnecting...\")\n                self.running = False\n                await asyncio.sleep(self.reconnect_interval)\n            except Exception as e:\n                self.logger.error(f\"Connection error: {e}\")\n                self.running = False\n                await asyncio.sleep(self.reconnect_interval)\n\n    async def send(self, message: dict):\n        \"\"\"Send message to WebSocket\"\"\"\n        if self.ws and self.running:\n            await self.ws.send(json.dumps(message))\n\n    async def disconnect(self):\n        \"\"\"Disconnect from WebSocket\"\"\"\n        self.running = False\n        if self.ws:\n            await self.ws.close()\n        self.emit('disconnect', {})\n</code></pre>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#buoc-2-binance-websocket-client","title":"B\u01b0\u1edbc 2: Binance WebSocket Client","text":"<pre><code># websocket/binance_client.py\nfrom websocket.base_client import BaseWebSocketClient\nfrom typing import List\nimport json\n\nclass BinanceWebSocketClient(BaseWebSocketClient):\n    \"\"\"Binance WebSocket client\"\"\"\n\n    def __init__(self, stream_type: str = 'spot'):\n        base_url = 'wss://stream.binance.com:9443/ws/' if stream_type == 'spot' else 'wss://fstream.binance.com/ws/'\n        super().__init__(base_url)\n        self.stream_type = stream_type\n\n    async def subscribe(self, channels: List[str]):\n        \"\"\"Subscribe to Binance streams\"\"\"\n        # Binance uses stream names like btcusdt@ticker\n        streams = [f\"{symbol.lower()}@ticker\" for symbol in channels]\n        stream_url = f\"wss://stream.binance.com:9443/stream?streams={'/'.join(streams)}\"\n\n        # Reconnect with new URL\n        self.url = stream_url\n        self.subscriptions = channels\n\n    def handle_message(self, message: dict):\n        \"\"\"Handle Binance message\"\"\"\n        if 'stream' in message and 'data' in message:\n            stream = message['stream']\n            data = message['data']\n\n            if '@ticker' in stream:\n                symbol = stream.split('@')[0].upper()\n                self.emit('ticker', {\n                    'symbol': symbol,\n                    'price': float(data['c']),\n                    'volume': float(data['v']),\n                    'change': float(data['P']),\n                    'timestamp': data['E']\n                })\n\n            elif '@trade' in stream:\n                symbol = stream.split('@')[0].upper()\n                self.emit('trade', {\n                    'symbol': symbol,\n                    'price': float(data['p']),\n                    'quantity': float(data['q']),\n                    'timestamp': data['T']\n                })\n\n            elif '@kline' in stream:\n                symbol = stream.split('@')[0].upper()\n                kline = data['k']\n                self.emit('kline', {\n                    'symbol': symbol,\n                    'open': float(kline['o']),\n                    'high': float(kline['h']),\n                    'low': float(kline['l']),\n                    'close': float(kline['c']),\n                    'volume': float(kline['v']),\n                    'timestamp': kline['t'],\n                    'is_closed': kline['x']\n                })\n</code></pre>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#buoc-3-bybit-websocket-client","title":"B\u01b0\u1edbc 3: Bybit WebSocket Client","text":"<pre><code># websocket/bybit_client.py\nfrom websocket.base_client import BaseWebSocketClient\nfrom typing import List\nimport json\n\nclass BybitWebSocketClient(BaseWebSocketClient):\n    \"\"\"Bybit WebSocket client\"\"\"\n\n    def __init__(self):\n        super().__init__('wss://stream.bybit.com/v5/public/spot')\n\n    async def subscribe(self, channels: List[str]):\n        \"\"\"Subscribe to Bybit topics\"\"\"\n        topics = [f\"tickers.{symbol}\" for symbol in channels]\n\n        subscribe_msg = {\n            \"op\": \"subscribe\",\n            \"args\": topics\n        }\n\n        await self.send(subscribe_msg)\n        self.subscriptions = channels\n\n    def handle_message(self, message: dict):\n        \"\"\"Handle Bybit message\"\"\"\n        if message.get('topic', '').startswith('tickers.'):\n            symbol = message['topic'].split('.')[1]\n            data = message['data']\n\n            self.emit('ticker', {\n                'symbol': symbol,\n                'price': float(data['lastPrice']),\n                'volume': float(data['volume24h']),\n                'change': float(data['price24hPcnt']) * 100,\n                'timestamp': message['ts']\n            })\n</code></pre>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#buoc-4-data-processor","title":"B\u01b0\u1edbc 4: Data Processor","text":"<pre><code># websocket/data_processor.py\nfrom typing import Dict, Optional\nfrom datetime import datetime\nimport logging\n\nclass DataProcessor:\n    \"\"\"Process and normalize data from different exchanges\"\"\"\n\n    def __init__(self):\n        self.logger = logging.getLogger(__name__)\n        self.price_cache: Dict[str, float] = {}\n        self.volume_cache: Dict[str, float] = {}\n\n    def normalize_ticker(self, exchange: str, data: dict) -&gt; Optional[Dict]:\n        \"\"\"Normalize ticker data from different exchanges\"\"\"\n        try:\n            if exchange == 'binance':\n                return {\n                    'exchange': 'binance',\n                    'symbol': data['symbol'],\n                    'price': data['price'],\n                    'volume_24h': data['volume'],\n                    'change_24h': data['change'],\n                    'timestamp': datetime.fromtimestamp(data['timestamp'] / 1000),\n                    'source': 'websocket'\n                }\n            elif exchange == 'bybit':\n                return {\n                    'exchange': 'bybit',\n                    'symbol': data['symbol'],\n                    'price': data['price'],\n                    'volume_24h': data['volume'],\n                    'change_24h': data['change'],\n                    'timestamp': datetime.fromtimestamp(data['timestamp'] / 1000),\n                    'source': 'websocket'\n                }\n        except Exception as e:\n            self.logger.error(f\"Error normalizing ticker: {e}\")\n            return None\n\n    def detect_price_change(self, symbol: str, new_price: float, threshold: float = 0.01) -&gt; bool:\n        \"\"\"Detect significant price change\"\"\"\n        if symbol in self.price_cache:\n            old_price = self.price_cache[symbol]\n            change_pct = abs((new_price - old_price) / old_price)\n\n            if change_pct &gt;= threshold:\n                self.price_cache[symbol] = new_price\n                return True\n\n        self.price_cache[symbol] = new_price\n        return False\n\n    def filter_volume(self, symbol: str, volume: float, min_volume: float = 1000) -&gt; bool:\n        \"\"\"Filter by minimum volume\"\"\"\n        return volume &gt;= min_volume\n</code></pre>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#buoc-5-event-bus-voi-redis","title":"B\u01b0\u1edbc 5: Event Bus v\u1edbi Redis","text":"<pre><code># websocket/event_bus.py\nimport redis\nimport json\nfrom typing import Callable, List\nimport asyncio\nimport logging\n\nclass RedisEventBus:\n    \"\"\"Event bus using Redis pub/sub\"\"\"\n\n    def __init__(self, host: str = 'localhost', port: int = 6379):\n        self.redis_client = redis.Redis(host=host, port=port, decode_responses=True)\n        self.pubsub = self.redis_client.pubsub()\n        self.subscribers: Dict[str, List[Callable]] = {}\n        self.logger = logging.getLogger(__name__)\n\n    def publish(self, channel: str, data: dict):\n        \"\"\"Publish event to channel\"\"\"\n        try:\n            self.redis_client.publish(channel, json.dumps(data))\n        except Exception as e:\n            self.logger.error(f\"Error publishing to {channel}: {e}\")\n\n    def subscribe(self, channel: str, callback: Callable):\n        \"\"\"Subscribe to channel\"\"\"\n        if channel not in self.subscribers:\n            self.subscribers[channel] = []\n            self.pubsub.subscribe(channel)\n\n        self.subscribers[channel].append(callback)\n\n    async def listen(self):\n        \"\"\"Listen for messages\"\"\"\n        for message in self.pubsub.listen():\n            if message['type'] == 'message':\n                channel = message['channel']\n                data = json.loads(message['data'])\n\n                if channel in self.subscribers:\n                    for callback in self.subscribers[channel]:\n                        try:\n                            await callback(data) if asyncio.iscoroutinefunction(callback) else callback(data)\n                        except Exception as e:\n                            self.logger.error(f\"Callback error: {e}\")\n</code></pre>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#buoc-6-complete-system","title":"B\u01b0\u1edbc 6: Complete System","text":"<pre><code># websocket/trading_data_pipeline.py\nimport asyncio\nfrom websocket.binance_client import BinanceWebSocketClient\nfrom websocket.bybit_client import BybitWebSocketClient\nfrom websocket.data_processor import DataProcessor\nfrom websocket.event_bus import RedisEventBus\nimport logging\n\nlogging.basicConfig(level=logging.INFO)\n\nclass TradingDataPipeline:\n    \"\"\"Complete trading data pipeline\"\"\"\n\n    def __init__(self):\n        self.processor = DataProcessor()\n        self.event_bus = RedisEventBus()\n\n        # Initialize exchange clients\n        self.binance = BinanceWebSocketClient()\n        self.bybit = BybitWebSocketClient()\n\n        # Setup callbacks\n        self.setup_callbacks()\n\n    def setup_callbacks(self):\n        \"\"\"Setup WebSocket callbacks\"\"\"\n        # Binance callbacks\n        self.binance.on('ticker', self.handle_binance_ticker)\n        self.binance.on('trade', self.handle_binance_trade)\n        self.binance.on('kline', self.handle_binance_kline)\n\n        # Bybit callbacks\n        self.bybit.on('ticker', self.handle_bybit_ticker)\n\n    def handle_binance_ticker(self, data: dict):\n        \"\"\"Handle Binance ticker\"\"\"\n        normalized = self.processor.normalize_ticker('binance', data)\n\n        if normalized:\n            # Check for significant price change\n            if self.processor.detect_price_change(\n                normalized['symbol'], \n                normalized['price'],\n                threshold=0.005  # 0.5%\n            ):\n                # Publish to event bus\n                self.event_bus.publish('price_alerts', normalized)\n\n            # Always publish to ticker stream\n            self.event_bus.publish('tickers', normalized)\n\n    def handle_bybit_ticker(self, data: dict):\n        \"\"\"Handle Bybit ticker\"\"\"\n        normalized = self.processor.normalize_ticker('bybit', data)\n\n        if normalized:\n            self.event_bus.publish('tickers', normalized)\n\n    def handle_binance_trade(self, data: dict):\n        \"\"\"Handle Binance trade\"\"\"\n        self.event_bus.publish('trades', {\n            'exchange': 'binance',\n            'symbol': data['symbol'],\n            'price': data['price'],\n            'quantity': data['quantity'],\n            'timestamp': data['timestamp']\n        })\n\n    def handle_binance_kline(self, data: dict):\n        \"\"\"Handle Binance kline\"\"\"\n        if data['is_closed']:\n            self.event_bus.publish('klines', {\n                'exchange': 'binance',\n                'symbol': data['symbol'],\n                'open': data['open'],\n                'high': data['high'],\n                'low': data['low'],\n                'close': data['close'],\n                'volume': data['volume'],\n                'timestamp': data['timestamp']\n            })\n\n    async def start(self, symbols: List[str]):\n        \"\"\"Start the pipeline\"\"\"\n        # Subscribe to symbols\n        self.binance.subscriptions = symbols\n        self.bybit.subscriptions = symbols\n\n        # Start WebSocket connections\n        tasks = [\n            asyncio.create_task(self.binance.connect()),\n            asyncio.create_task(self.bybit.connect()),\n            asyncio.create_task(self.event_bus.listen())\n        ]\n\n        await asyncio.gather(*tasks)\n\n# Usage\nasync def main():\n    pipeline = TradingDataPipeline()\n\n    # Subscribe to symbols\n    symbols = ['BTCUSDT', 'ETHUSDT', 'BNBUSDT']\n\n    # Setup consumers\n    def on_price_alert(data):\n        print(f\"Price alert: {data}\")\n\n    def on_ticker(data):\n        print(f\"Ticker: {data['symbol']} = ${data['price']}\")\n\n    pipeline.event_bus.subscribe('price_alerts', on_price_alert)\n    pipeline.event_bus.subscribe('tickers', on_ticker)\n\n    await pipeline.start(symbols)\n\nif __name__ == '__main__':\n    asyncio.run(main())\n</code></pre>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#best-practices","title":"Best Practices","text":"<ol> <li>Connection Management: Auto-reconnect v\u1edbi exponential backoff</li> <li>Error Handling: Handle t\u1ea5t c\u1ea3 exceptions gracefully</li> <li>Rate Limiting: Respect exchange rate limits</li> <li>Data Validation: Validate data tr\u01b0\u1edbc khi process</li> <li>Monitoring: Log v\u00e0 monitor connection health</li> <li>Backpressure: Handle khi consumer ch\u1eadm h\u01a1n producer</li> </ol>"},{"location":"blog/2025/01/25/real-time-data-processing-v%E1%BB%9Bi-websocket---x%C3%A2y-d%E1%BB%B1ng-trading-data-pipeline/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>V\u1edbi h\u1ec7 th\u1ed1ng n\u00e0y, b\u1ea1n c\u00f3 th\u1ec3: - Stream real-time data t\u1eeb multiple exchanges - Normalize data t\u1eeb different sources - Publish events cho consumers - Scale horizontally v\u1edbi Redis</p> <p>Trong b\u00e0i ti\u1ebfp theo, ch\u00fang ta s\u1ebd x\u00e2y d\u1ef1ng risk management system.</p>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-restful-api-cho-trading---fastapi-v%C3%A0-best-practices/","title":"X\u00e2y d\u1ef1ng RESTful API cho Trading","text":"<p>Trong ki\u1ebfn tr\u00fac c\u1ee7a modern trading systems, RESTful APIs \u0111\u00f3ng vai tr\u00f2 nh\u01b0 nh\u1eefng giao di\u1ec7n chu\u1ea9n m\u1ef1c \u0111\u1ec3 expose trading functionality cho c\u00e1c clients kh\u00e1c nhau, t\u1eeb web applications, mobile apps, \u0111\u1ebfn c\u00e1c trading bots v\u00e0 third-party integrations. Kh\u00f4ng gi\u1ed1ng nh\u01b0 WebSocket APIs \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf cho real-time data streaming, RESTful APIs cung c\u1ea5p m\u1ed9t m\u00f4 h\u00ecnh request-response \u0111\u01a1n gi\u1ea3n, stateless, v\u00e0 d\u1ec5 s\u1eed d\u1ee5ng, ph\u00f9 h\u1ee3p cho c\u00e1c operations nh\u01b0 query historical data, place orders, check account balance, v\u00e0 retrieve portfolio information. V\u1edbi s\u1ef1 ph\u1ed5 bi\u1ebfn c\u1ee7a REST architecture v\u00e0 s\u1ef1 h\u1ed7 tr\u1ee3 r\u1ed9ng r\u00e3i t\u1eeb c\u00e1c frameworks v\u00e0 tools, vi\u1ec7c x\u00e2y d\u1ef1ng m\u1ed9t RESTful API t\u1ed1t kh\u00f4ng ch\u1ec9 gi\u00fap b\u1ea1n expose functionality m\u1ed9t c\u00e1ch d\u1ec5 d\u00e0ng, m\u00e0 c\u00f2n \u0111\u1ea3m b\u1ea3o API c\u1ee7a b\u1ea1n c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng b\u1edfi b\u1ea5t k\u1ef3 client n\u00e0o, b\u1ea5t k\u1ec3 platform hay programming language.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng m\u1ed9t RESTful API ho\u00e0n ch\u1ec9nh cho trading systems s\u1eed d\u1ee5ng FastAPI - m\u1ed9t framework Python hi\u1ec7n \u0111\u1ea1i, nhanh ch\u00f3ng, v\u00e0 \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1eb7c bi\u1ec7t cho vi\u1ec7c x\u00e2y d\u1ef1ng APIs v\u1edbi automatic OpenAPI documentation, type validation, v\u00e0 async support. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch thi\u1ebft k\u1ebf API endpoints theo RESTful principles, implement authentication v\u00e0 authorization (JWT tokens, API keys), rate limiting \u0111\u1ec3 b\u1ea3o v\u1ec7 API kh\u1ecfi abuse, error handling v\u00e0 validation, logging v\u00e0 monitoring, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 \u0111\u1ea3m b\u1ea3o API c\u00f3 performance t\u1ed1t v\u00e0 c\u00f3 th\u1ec3 scale. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c best practices nh\u01b0 versioning APIs, pagination cho large datasets, filtering v\u00e0 sorting, v\u00e0 c\u00e1ch document APIs m\u1ed9t c\u00e1ch t\u1ed1t nh\u1ea5t.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup FastAPI project, thi\u1ebft k\u1ebf API endpoints v\u00e0 data models, implement authentication v\u00e0 authorization, \u0111\u1ebfn vi\u1ec7c integrate v\u1edbi trading logic, add rate limiting v\u00e0 caching, v\u00e0 deploy API l\u00ean production. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch test APIs, monitor performance, v\u00e0 implement security best practices. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t RESTful API m\u1ea1nh m\u1ebd, well-documented, v\u00e0 production-ready cho trading systems.</p>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-restful-api-cho-trading---fastapi-v%C3%A0-best-practices/#api-endpoints-design","title":"API Endpoints Design","text":"<pre><code>GET  /api/v1/tickers/{symbol}        # Get ticker\nGET  /api/v1/ohlcv/{symbol}          # Get OHLCV data\nGET  /api/v1/portfolio               # Get portfolio\nPOST /api/v1/orders                   # Place order\nGET  /api/v1/orders/{order_id}       # Get order status\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-restful-api-cho-trading---fastapi-v%C3%A0-best-practices/#buoc-1-fastapi-setup","title":"B\u01b0\u1edbc 1: FastAPI Setup","text":"<pre><code># api/main.py\nfrom fastapi import FastAPI, Depends, HTTPException, status\nfrom fastapi.security import HTTPBearer, HTTPAuthorizationCredentials\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom pydantic import BaseModel\nfrom typing import Optional, List\nfrom datetime import datetime\nimport jwt\n\napp = FastAPI(title=\"Trading API\", version=\"1.0.0\")\n\n# CORS\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\n# Security\nsecurity = HTTPBearer()\n\n# Models\nclass TickerResponse(BaseModel):\n    symbol: str\n    exchange: str\n    price: float\n    volume_24h: Optional[float]\n    change_24h: Optional[float]\n    timestamp: datetime\n\nclass OrderRequest(BaseModel):\n    symbol: str\n    side: str  # 'BUY' or 'SELL'\n    quantity: float\n    order_type: str = 'MARKET'  # 'MARKET' or 'LIMIT'\n    price: Optional[float] = None\n\nclass OrderResponse(BaseModel):\n    order_id: str\n    symbol: str\n    side: str\n    quantity: float\n    status: str\n    timestamp: datetime\n\n# Authentication\ndef verify_token(credentials: HTTPAuthorizationCredentials = Depends(security)):\n    token = credentials.credentials\n    try:\n        payload = jwt.decode(token, \"secret_key\", algorithms=[\"HS256\"])\n        return payload\n    except jwt.InvalidTokenError:\n        raise HTTPException(\n            status_code=status.HTTP_401_UNAUTHORIZED,\n            detail=\"Invalid token\"\n        )\n\n# Endpoints\n@app.get(\"/api/v1/tickers/{symbol}\", response_model=TickerResponse)\nasync def get_ticker(symbol: str, exchange: str = \"binance\"):\n    \"\"\"Get ticker for symbol\"\"\"\n    # Implementation\n    pass\n\n@app.get(\"/api/v1/ohlcv/{symbol}\")\nasync def get_ohlcv(\n    symbol: str,\n    exchange: str = \"binance\",\n    interval: str = \"1h\",\n    start_time: Optional[datetime] = None,\n    end_time: Optional[datetime] = None,\n    limit: int = 100\n):\n    \"\"\"Get OHLCV data\"\"\"\n    # Implementation\n    pass\n\n@app.post(\"/api/v1/orders\", response_model=OrderResponse)\nasync def place_order(\n    order: OrderRequest,\n    user: dict = Depends(verify_token)\n):\n    \"\"\"Place trading order\"\"\"\n    # Implementation\n    pass\n\n@app.get(\"/api/v1/portfolio\")\nasync def get_portfolio(user: dict = Depends(verify_token)):\n    \"\"\"Get user portfolio\"\"\"\n    # Implementation\n    pass\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-restful-api-cho-trading---fastapi-v%C3%A0-best-practices/#buoc-2-rate-limiting","title":"B\u01b0\u1edbc 2: Rate Limiting","text":"<pre><code># api/rate_limit.py\nfrom fastapi import Request, HTTPException\nfrom slowapi import Limiter, _rate_limit_exceeded_handler\nfrom slowapi.util import get_remote_address\nfrom slowapi.errors import RateLimitExceeded\n\nlimiter = Limiter(key_func=get_remote_address)\napp.state.limiter = limiter\napp.add_exception_handler(RateLimitExceeded, _rate_limit_exceeded_handler)\n\n@app.get(\"/api/v1/tickers/{symbol}\")\n@limiter.limit(\"10/minute\")\nasync def get_ticker(request: Request, symbol: str):\n    # Implementation\n    pass\n</code></pre>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-restful-api-cho-trading---fastapi-v%C3%A0-best-practices/#best-practices","title":"Best Practices","text":"<ol> <li>Authentication: Use JWT tokens</li> <li>Rate Limiting: Prevent abuse</li> <li>Error Handling: Consistent error responses</li> <li>Validation: Validate all inputs</li> <li>Documentation: Auto-generated docs</li> <li>Logging: Log all requests</li> <li>Monitoring: Monitor API health</li> </ol>"},{"location":"blog/2025/01/25/x%C3%A2y-d%E1%BB%B1ng-restful-api-cho-trading---fastapi-v%C3%A0-best-practices/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>RESTful APIs enable: - Standardized interfaces - Easy integration - Scalable architecture - Better developer experience</p> <p>Build robust APIs for your trading systems!</p>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/","title":"Risk Management v\u00e0 Automation","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a trading v\u00e0 \u0111\u1ea7u t\u01b0, c\u00f3 m\u1ed9t c\u00e2u n\u00f3i n\u1ed5i ti\u1ebfng: \"Risk management kh\u00f4ng ph\u1ea3i l\u00e0 m\u1ed9t ph\u1ea7n c\u1ee7a trading - n\u00f3 CH\u00cdNH L\u00c0 trading\". D\u00f9 b\u1ea1n c\u00f3 m\u1ed9t chi\u1ebfn l\u01b0\u1ee3c trading t\u1ed1t \u0111\u1ebfn \u0111\u00e2u, v\u1edbi win rate cao v\u00e0 profit factor \u1ea5n t\u01b0\u1ee3ng, n\u1ebfu b\u1ea1n kh\u00f4ng c\u00f3 m\u1ed9t h\u1ec7 th\u1ed1ng qu\u1ea3n l\u00fd r\u1ee7i ro ch\u1eb7t ch\u1ebd v\u00e0 t\u1ef1 \u0111\u1ed9ng, b\u1ea1n v\u1eabn c\u00f3 th\u1ec3 m\u1ea5t to\u00e0n b\u1ed9 v\u1ed1n ch\u1ec9 trong m\u1ed9t v\u00e0i giao d\u1ecbch x\u1ea5u. Risk management kh\u00f4ng ch\u1ec9 \u0111\u01a1n gi\u1ea3n l\u00e0 \u0111\u1eb7t stop loss v\u00e0 take profit, m\u00e0 l\u00e0 m\u1ed9t h\u1ec7 th\u1ed1ng to\u00e0n di\u1ec7n bao g\u1ed3m position sizing th\u00f4ng minh, qu\u1ea3n l\u00fd drawdown, \u0111a d\u1ea1ng h\u00f3a portfolio, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 t\u1ef1 \u0111\u1ed9ng h\u00f3a to\u00e0n b\u1ed9 quy tr\u00ecnh \u0111\u1ec3 lo\u1ea1i b\u1ecf ho\u00e0n to\u00e0n y\u1ebfu t\u1ed1 c\u1ea3m x\u00fac - k\u1ebb th\u00f9 l\u1edbn nh\u1ea5t c\u1ee7a m\u1ecdi nh\u00e0 giao d\u1ecbch.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng m\u1ed9t h\u1ec7 th\u1ed1ng risk management t\u1ef1 \u0111\u1ed9ng ho\u00e0n ch\u1ec9nh, t\u1eeb nh\u1eefng nguy\u00ean t\u1eafc c\u01a1 b\u1ea3n nh\u1ea5t nh\u01b0 t\u00ednh to\u00e1n position size d\u1ef1a tr\u00ean risk per trade v\u00e0 account balance, \u0111\u1ebfn nh\u1eefng k\u1ef9 thu\u1eadt n\u00e2ng cao nh\u01b0 Kelly Criterion, volatility-based position sizing, v\u00e0 portfolio-level risk management. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch implement c\u00e1c c\u01a1 ch\u1ebf t\u1ef1 \u0111\u1ed9ng nh\u01b0 trailing stop loss, dynamic take profit levels, correlation-based position limits, v\u00e0 circuit breakers \u0111\u1ec3 d\u1eebng trading khi drawdown v\u01b0\u1ee3t qu\u00e1 ng\u01b0\u1ee1ng cho ph\u00e9p. H\u1ec7 th\u1ed1ng m\u00e0 ch\u00fang ta x\u00e2y d\u1ef1ng s\u1ebd kh\u00f4ng ch\u1ec9 b\u1ea3o v\u1ec7 v\u1ed1n c\u1ee7a b\u1ea1n kh\u1ecfi nh\u1eefng t\u1ed5n th\u1ea5t l\u1edbn, m\u00e0 c\u00f2n t\u1ed1i \u01b0u h\u00f3a vi\u1ec7c s\u1eed d\u1ee5ng v\u1ed1n \u0111\u1ec3 t\u1ed1i \u0111a h\u00f3a l\u1ee3i nhu\u1eadn trong d\u00e0i h\u1ea1n.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c thi\u1ebft k\u1ebf ki\u1ebfn tr\u00fac c\u1ee7a h\u1ec7 th\u1ed1ng risk management, implement c\u00e1c module x\u1eed l\u00fd position sizing v\u00e0 stop loss, t\u00edch h\u1ee3p v\u1edbi trading bot, \u0111\u1ebfn vi\u1ec7c testing v\u00e0 monitoring hi\u1ec7u qu\u1ea3 c\u1ee7a h\u1ec7 th\u1ed1ng. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c ph\u01b0\u01a1ng ph\u00e1p \u0111o l\u01b0\u1eddng v\u00e0 \u0111\u00e1nh gi\u00e1 risk nh\u01b0 Value at Risk (VaR), Maximum Drawdown, v\u00e0 Sharpe Ratio, c\u00f9ng v\u1edbi c\u00e1c best practices \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o h\u1ec7 th\u1ed1ng ho\u1ea1t \u0111\u1ed9ng \u1ed5n \u0111\u1ecbnh trong m\u1ecdi \u0111i\u1ec1u ki\u1ec7n th\u1ecb tr\u01b0\u1eddng. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t h\u1ec7 th\u1ed1ng risk management chuy\u00ean nghi\u1ec7p, c\u00f3 th\u1ec3 t\u1ef1 \u0111\u1ed9ng b\u1ea3o v\u1ec7 v\u1ed1n v\u00e0 t\u1ed1i \u01b0u h\u00f3a hi\u1ec7u su\u1ea5t trading c\u1ee7a b\u1ea1n.</p> <p></p>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#tai-sao-risk-management-quan-trong","title":"T\u1ea1i sao Risk Management quan tr\u1ecdng?","text":"<ol> <li>B\u1ea3o v\u1ec7 v\u1ed1n: Tr\u00e1nh m\u1ea5t to\u00e0n b\u1ed9 v\u1ed1n trong m\u1ed9t trade</li> <li>Consistency: \u0110\u1ea3m b\u1ea3o trading nh\u1ea5t qu\u00e1n</li> <li>Emotion Control: Lo\u1ea1i b\u1ecf c\u1ea3m x\u00fac kh\u1ecfi trading</li> <li>Long-term Success: Duy tr\u00ec l\u1ee3i nhu\u1eadn d\u00e0i h\u1ea1n</li> </ol>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#cac-thanh-phan-risk-management","title":"C\u00e1c th\u00e0nh ph\u1ea7n Risk Management","text":"<ol> <li>Position Sizing: T\u00ednh to\u00e1n k\u00edch th\u01b0\u1edbc position</li> <li>Stop Loss: Gi\u1edbi h\u1ea1n thua l\u1ed7</li> <li>Take Profit: Ch\u1ed1t l\u1eddi</li> <li>Portfolio Risk: Qu\u1ea3n l\u00fd risk to\u00e0n portfolio</li> <li>Correlation: Tr\u00e1nh over-exposure</li> </ol>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#buoc-1-position-sizing-calculator","title":"B\u01b0\u1edbc 1: Position Sizing Calculator","text":"<pre><code># risk_management/position_sizing.py\nfrom typing import Dict, Optional\nfrom enum import Enum\nimport math\n\nclass RiskMethod(Enum):\n    FIXED_PERCENT = \"fixed_percent\"  # Fixed % of capital\n    KELLY = \"kelly\"  # Kelly Criterion\n    VOLATILITY = \"volatility\"  # Based on volatility\n    EQUAL_WEIGHT = \"equal_weight\"  # Equal weight all positions\n\nclass PositionSizer:\n    def __init__(self, initial_capital: float = 10000):\n        self.initial_capital = initial_capital\n        self.current_capital = initial_capital\n\n    def calculate_fixed_percent(\n        self, \n        capital: float, \n        risk_percent: float = 0.02,\n        entry_price: float = 0,\n        stop_loss_price: float = 0\n    ) -&gt; float:\n        \"\"\"\n        Calculate position size using fixed risk percentage\n\n        Args:\n            capital: Current capital\n            risk_percent: Risk per trade (e.g., 0.02 = 2%)\n            entry_price: Entry price\n            stop_loss_price: Stop loss price\n\n        Returns:\n            Position size in base currency\n        \"\"\"\n        if entry_price == 0 or stop_loss_price == 0:\n            # Simple fixed percentage\n            return capital * risk_percent\n\n        # Risk amount\n        risk_amount = capital * risk_percent\n\n        # Price difference\n        price_diff = abs(entry_price - stop_loss_price)\n\n        if price_diff == 0:\n            return 0\n\n        # Position size\n        position_size = risk_amount / price_diff\n\n        return position_size\n\n    def calculate_kelly(\n        self,\n        win_rate: float,\n        avg_win: float,\n        avg_loss: float\n    ) -&gt; float:\n        \"\"\"\n        Calculate position size using Kelly Criterion\n\n        f* = (p * b - q) / b\n        where:\n            f* = fraction of capital to bet\n            p = win probability\n            q = loss probability (1 - p)\n            b = win/loss ratio\n        \"\"\"\n        if avg_loss == 0:\n            return 0\n\n        p = win_rate / 100\n        q = 1 - p\n        b = avg_win / abs(avg_loss)\n\n        kelly = (p * b - q) / b\n\n        # Use fractional Kelly (half) for safety\n        return max(0, kelly / 2)\n\n    def calculate_volatility_based(\n        self,\n        capital: float,\n        entry_price: float,\n        volatility: float,  # Daily volatility as decimal\n        risk_multiplier: float = 2.0\n    ) -&gt; float:\n        \"\"\"\n        Calculate position size based on volatility\n\n        Position size inversely proportional to volatility\n        \"\"\"\n        # Risk per trade\n        risk_percent = 0.02  # 2% base risk\n\n        # Adjust for volatility\n        adjusted_risk = risk_percent / (volatility * risk_multiplier)\n        adjusted_risk = min(adjusted_risk, 0.05)  # Cap at 5%\n\n        risk_amount = capital * adjusted_risk\n        position_size = risk_amount / entry_price\n\n        return position_size\n\n    def calculate_equal_weight(\n        self,\n        capital: float,\n        num_positions: int,\n        max_positions: int = 10\n    ) -&gt; float:\n        \"\"\"\n        Calculate position size for equal weight portfolio\n        \"\"\"\n        if num_positions &gt;= max_positions:\n            return 0\n\n        position_value = capital / max_positions\n        return position_value\n</code></pre>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#buoc-2-stop-loss-manager","title":"B\u01b0\u1edbc 2: Stop Loss Manager","text":"<pre><code># risk_management/stop_loss.py\nfrom typing import Optional, Dict\nfrom dataclasses import dataclass\nfrom datetime import datetime\nimport logging\n\n@dataclass\nclass StopLoss:\n    entry_price: float\n    stop_loss_price: float\n    take_profit_price: Optional[float]\n    trailing_stop: bool = False\n    trailing_percent: float = 0.02\n    current_stop: Optional[float] = None\n\nclass StopLossManager:\n    def __init__(self):\n        self.active_stops: Dict[str, StopLoss] = {}\n        self.logger = logging.getLogger(__name__)\n\n    def set_stop_loss(\n        self,\n        symbol: str,\n        entry_price: float,\n        stop_loss_percent: float = 0.02,\n        take_profit_percent: Optional[float] = None,\n        trailing: bool = False,\n        trailing_percent: float = 0.02\n    ):\n        \"\"\"Set stop loss for a position\"\"\"\n        stop_loss_price = entry_price * (1 - stop_loss_percent)\n        take_profit_price = None\n\n        if take_profit_percent:\n            take_profit_price = entry_price * (1 + take_profit_percent)\n\n        stop = StopLoss(\n            entry_price=entry_price,\n            stop_loss_price=stop_loss_price,\n            take_profit_price=take_profit_price,\n            trailing_stop=trailing,\n            trailing_percent=trailing_percent,\n            current_stop=stop_loss_price\n        )\n\n        self.active_stops[symbol] = stop\n        self.logger.info(f\"Stop loss set for {symbol}: {stop_loss_price}\")\n\n    def update_trailing_stop(self, symbol: str, current_price: float):\n        \"\"\"Update trailing stop loss\"\"\"\n        if symbol not in self.active_stops:\n            return\n\n        stop = self.active_stops[symbol]\n\n        if not stop.trailing_stop:\n            return\n\n        # Calculate new stop\n        if stop.current_stop is None:\n            stop.current_stop = stop.stop_loss_price\n\n        # If price moves up, move stop up\n        if current_price &gt; stop.entry_price:\n            new_stop = current_price * (1 - stop.trailing_percent)\n\n            # Only move stop up, never down\n            if new_stop &gt; stop.current_stop:\n                stop.current_stop = new_stop\n                self.logger.info(f\"Trailing stop updated for {symbol}: {stop.current_stop}\")\n\n    def check_stop_loss(self, symbol: str, current_price: float) -&gt; Optional[str]:\n        \"\"\"\n        Check if stop loss or take profit is hit\n\n        Returns:\n            'STOP_LOSS', 'TAKE_PROFIT', or None\n        \"\"\"\n        if symbol not in self.active_stops:\n            return None\n\n        stop = self.active_stops[symbol]\n\n        # Update trailing stop\n        if stop.trailing_stop:\n            self.update_trailing_stop(symbol, current_price)\n\n        # Check stop loss\n        stop_price = stop.current_stop if stop.trailing_stop else stop.stop_loss_price\n\n        if current_price &lt;= stop_price:\n            self.logger.warning(f\"Stop loss hit for {symbol} at {current_price}\")\n            del self.active_stops[symbol]\n            return 'STOP_LOSS'\n\n        # Check take profit\n        if stop.take_profit_price and current_price &gt;= stop.take_profit_price:\n            self.logger.info(f\"Take profit hit for {symbol} at {current_price}\")\n            del self.active_stops[symbol]\n            return 'TAKE_PROFIT'\n\n        return None\n\n    def remove_stop_loss(self, symbol: str):\n        \"\"\"Remove stop loss\"\"\"\n        if symbol in self.active_stops:\n            del self.active_stops[symbol]\n</code></pre>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#buoc-3-portfolio-risk-manager","title":"B\u01b0\u1edbc 3: Portfolio Risk Manager","text":"<pre><code># risk_management/portfolio_risk.py\nfrom typing import Dict, List, Optional\nfrom dataclasses import dataclass\nimport numpy as np\nimport logging\n\n@dataclass\nclass Position:\n    symbol: str\n    quantity: float\n    entry_price: float\n    current_price: float\n    side: str  # 'LONG' or 'SHORT'\n\n    @property\n    def value(self) -&gt; float:\n        return self.quantity * self.current_price\n\n    @property\n    def pnl(self) -&gt; float:\n        if self.side == 'LONG':\n            return (self.current_price - self.entry_price) * self.quantity\n        else:\n            return (self.entry_price - self.current_price) * self.quantity\n\n    @property\n    def pnl_pct(self) -&gt; float:\n        if self.side == 'LONG':\n            return ((self.current_price - self.entry_price) / self.entry_price) * 100\n        else:\n            return ((self.entry_price - self.current_price) / self.entry_price) * 100\n\nclass PortfolioRiskManager:\n    def __init__(self, max_portfolio_risk: float = 0.10, max_correlation: float = 0.7):\n        \"\"\"\n        Args:\n            max_portfolio_risk: Maximum total portfolio risk (e.g., 0.10 = 10%)\n            max_correlation: Maximum correlation between positions\n        \"\"\"\n        self.max_portfolio_risk = max_portfolio_risk\n        self.max_correlation = max_correlation\n        self.positions: Dict[str, Position] = {}\n        self.logger = logging.getLogger(__name__)\n\n    def add_position(self, position: Position):\n        \"\"\"Add position to portfolio\"\"\"\n        self.positions[position.symbol] = position\n\n    def remove_position(self, symbol: str):\n        \"\"\"Remove position from portfolio\"\"\"\n        if symbol in self.positions:\n            del self.positions[symbol]\n\n    def get_total_exposure(self) -&gt; float:\n        \"\"\"Calculate total portfolio exposure\"\"\"\n        return sum(pos.value for pos in self.positions.values())\n\n    def get_total_pnl(self) -&gt; float:\n        \"\"\"Calculate total PnL\"\"\"\n        return sum(pos.pnl for pos in self.positions.values())\n\n    def get_portfolio_risk(self, capital: float) -&gt; float:\n        \"\"\"Calculate current portfolio risk as % of capital\"\"\"\n        total_exposure = self.get_total_exposure()\n        return total_exposure / capital if capital &gt; 0 else 0\n\n    def can_add_position(self, position_value: float, capital: float) -&gt; bool:\n        \"\"\"Check if can add new position\"\"\"\n        current_exposure = self.get_total_exposure()\n        new_exposure = current_exposure + position_value\n\n        portfolio_risk = new_exposure / capital if capital &gt; 0 else 0\n\n        return portfolio_risk &lt;= self.max_portfolio_risk\n\n    def get_position_weights(self) -&gt; Dict[str, float]:\n        \"\"\"Get position weights in portfolio\"\"\"\n        total_value = self.get_total_exposure()\n\n        if total_value == 0:\n            return {}\n\n        return {\n            symbol: pos.value / total_value\n            for symbol, pos in self.positions.items()\n        }\n\n    def check_concentration_risk(self, max_weight: float = 0.30) -&gt; List[str]:\n        \"\"\"Check for concentration risk (single position too large)\"\"\"\n        weights = self.get_position_weights()\n        concentrated = [\n            symbol for symbol, weight in weights.items()\n            if weight &gt; max_weight\n        ]\n\n        if concentrated:\n            self.logger.warning(f\"Concentration risk: {concentrated}\")\n\n        return concentrated\n\n    def calculate_var(self, confidence: float = 0.95, lookback: int = 252) -&gt; float:\n        \"\"\"\n        Calculate Value at Risk (VaR)\n\n        Simplified VaR calculation\n        \"\"\"\n        if not self.positions:\n            return 0\n\n        # Get historical returns (simplified)\n        # In practice, you'd use actual historical data\n        returns = [pos.pnl_pct / 100 for pos in self.positions.values()]\n\n        if not returns:\n            return 0\n\n        # Calculate VaR\n        var = np.percentile(returns, (1 - confidence) * 100)\n\n        return abs(var)\n\n    def get_risk_summary(self, capital: float) -&gt; Dict:\n        \"\"\"Get comprehensive risk summary\"\"\"\n        return {\n            'total_positions': len(self.positions),\n            'total_exposure': self.get_total_exposure(),\n            'portfolio_risk_pct': self.get_portfolio_risk(capital) * 100,\n            'total_pnl': self.get_total_pnl(),\n            'total_pnl_pct': (self.get_total_pnl() / capital) * 100 if capital &gt; 0 else 0,\n            'position_weights': self.get_position_weights(),\n            'concentration_risk': self.check_concentration_risk(),\n            'var_95': self.calculate_var(0.95)\n        }\n</code></pre>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#buoc-4-complete-risk-management-system","title":"B\u01b0\u1edbc 4: Complete Risk Management System","text":"<pre><code># risk_management/risk_manager.py\nfrom risk_management.position_sizing import PositionSizer, RiskMethod\nfrom risk_management.stop_loss import StopLossManager\nfrom risk_management.portfolio_risk import PortfolioRiskManager, Position\nimport logging\n\nclass RiskManager:\n    \"\"\"Complete risk management system\"\"\"\n\n    def __init__(self, initial_capital: float = 10000):\n        self.capital = initial_capital\n        self.position_sizer = PositionSizer(initial_capital)\n        self.stop_loss_manager = StopLossManager()\n        self.portfolio_manager = PortfolioRiskManager()\n        self.logger = logging.getLogger(__name__)\n\n    def calculate_position_size(\n        self,\n        entry_price: float,\n        stop_loss_price: float,\n        risk_method: RiskMethod = RiskMethod.FIXED_PERCENT,\n        risk_percent: float = 0.02\n    ) -&gt; float:\n        \"\"\"Calculate position size\"\"\"\n        if risk_method == RiskMethod.FIXED_PERCENT:\n            return self.position_sizer.calculate_fixed_percent(\n                self.capital,\n                risk_percent,\n                entry_price,\n                stop_loss_price\n            )\n        else:\n            # Default to fixed percent\n            return self.position_sizer.calculate_fixed_percent(\n                self.capital,\n                risk_percent,\n                entry_price,\n                stop_loss_price\n            )\n\n    def open_position(\n        self,\n        symbol: str,\n        entry_price: float,\n        quantity: float,\n        side: str = 'LONG',\n        stop_loss_percent: float = 0.02,\n        take_profit_percent: Optional[float] = None,\n        trailing_stop: bool = False\n    ) -&gt; bool:\n        \"\"\"Open a new position with risk management\"\"\"\n        position_value = quantity * entry_price\n\n        # Check if can add position\n        if not self.portfolio_manager.can_add_position(position_value, self.capital):\n            self.logger.warning(f\"Cannot add position {symbol}: portfolio risk limit\")\n            return False\n\n        # Create position\n        position = Position(\n            symbol=symbol,\n            quantity=quantity,\n            entry_price=entry_price,\n            current_price=entry_price,\n            side=side\n        )\n\n        # Add to portfolio\n        self.portfolio_manager.add_position(position)\n\n        # Set stop loss\n        self.stop_loss_manager.set_stop_loss(\n            symbol,\n            entry_price,\n            stop_loss_percent,\n            take_profit_percent,\n            trailing_stop\n        )\n\n        self.logger.info(f\"Position opened: {symbol} {quantity} @ {entry_price}\")\n        return True\n\n    def update_position(self, symbol: str, current_price: float):\n        \"\"\"Update position price and check stop loss\"\"\"\n        if symbol not in self.portfolio_manager.positions:\n            return None\n\n        # Update position price\n        position = self.portfolio_manager.positions[symbol]\n        position.current_price = current_price\n\n        # Check stop loss\n        stop_result = self.stop_loss_manager.check_stop_loss(symbol, current_price)\n\n        if stop_result:\n            # Close position\n            self.close_position(symbol, current_price, stop_result)\n            return stop_result\n\n        return None\n\n    def close_position(self, symbol: str, exit_price: float, reason: str = 'MANUAL'):\n        \"\"\"Close a position\"\"\"\n        if symbol not in self.portfolio_manager.positions:\n            return\n\n        position = self.portfolio_manager.positions[symbol]\n        position.current_price = exit_price\n\n        pnl = position.pnl\n        pnl_pct = position.pnl_pct\n\n        # Update capital\n        self.capital += pnl\n\n        # Remove from portfolio\n        self.portfolio_manager.remove_position(symbol)\n        self.stop_loss_manager.remove_stop_loss(symbol)\n\n        self.logger.info(\n            f\"Position closed: {symbol} @ {exit_price} \"\n            f\"PnL: ${pnl:.2f} ({pnl_pct:.2f}%) Reason: {reason}\"\n        )\n\n    def get_risk_report(self) -&gt; Dict:\n        \"\"\"Get comprehensive risk report\"\"\"\n        risk_summary = self.portfolio_manager.get_risk_summary(self.capital)\n\n        return {\n            'capital': self.capital,\n            'active_positions': len(self.portfolio_manager.positions),\n            **risk_summary\n        }\n\n# Usage example\nif __name__ == '__main__':\n    risk_manager = RiskManager(initial_capital=10000)\n\n    # Open position\n    entry_price = 50000\n    stop_loss = entry_price * 0.98  # 2% stop loss\n\n    quantity = risk_manager.calculate_position_size(\n        entry_price,\n        stop_loss,\n        risk_percent=0.02\n    )\n\n    risk_manager.open_position(\n        'BTCUSDT',\n        entry_price,\n        quantity,\n        stop_loss_percent=0.02,\n        take_profit_percent=0.04,\n        trailing_stop=True\n    )\n\n    # Update position\n    risk_manager.update_position('BTCUSDT', 51000)\n\n    # Get risk report\n    report = risk_manager.get_risk_report()\n    print(report)\n</code></pre>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#best-practices","title":"Best Practices","text":"<ol> <li>Never risk more than 2% per trade</li> <li>Use stop loss always</li> <li>Diversify positions</li> <li>Monitor correlation</li> <li>Review risk regularly</li> <li>Keep position sizes consistent</li> </ol>"},{"location":"blog/2025/01/25/risk-management-v%C3%A0-automation---b%E1%BA%A3o-v%E1%BB%87-v%E1%BB%91n-c%E1%BB%A7a-b%E1%BA%A1n/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>V\u1edbi h\u1ec7 th\u1ed1ng risk management n\u00e0y, b\u1ea1n c\u00f3 th\u1ec3: - T\u1ef1 \u0111\u1ed9ng t\u00ednh position size - Qu\u1ea3n l\u00fd stop loss v\u00e0 take profit - Monitor portfolio risk - B\u1ea3o v\u1ec7 v\u1ed1n hi\u1ec7u qu\u1ea3</p> <p>Nh\u1edb: Preservation of capital is more important than making profits.</p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/","title":"Transforming Material for MkDocs","text":"<p>We are working on an amazing set of features which has required some behind-the-scenes work we are now ready to share in a series of posts. Here, we give an overview of our goals, features in the making, things that kept us up at night, and our commitment to Open Source.</p> <p>We know it's been quite a while since our last update, which is why we're eager to share what's happening in and around Material for MkDocs with you. For the largest part of 2024, we've been focused on transforming the core of Material for MkDocs preparing the ground for new, interconnected features that are amongst the most frequently requested.</p> <p>This article is part of a series where we'll explore how we aim to support our users through improved information retrieval, provide better support for multi-lingual sites and versioning, as well as improve the overall authoring experience. We outline our vision for the projects' evolution and describe what we have been working on. In this and the coming blog posts, we will share our progress with you, and we're excited to hear your thoughts.</p> <p>Please note that this post includes several technical details in the footnotes, specifically on challenges. Feel free to skip them if you're not interested in the specifics.</p> <p>This is the first article in a four-part series:</p> <ol> <li>Transforming Material for MkDocs</li> <li>Zensical \u2013 A modern static site generator built by the creators of Material for MkDocs</li> <li>Material for MkDocs Insiders \u2013 Now free for everyone</li> <li>Goodbye, GitHub Discussions</li> </ol>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#a-success-story","title":"A success story","text":"<p>In 2024, Material for MkDocs has firmly established itself as a leading tool in the documentation framework landscape, with more than 5 million downloads each month as of this writing. What began as @squidfunk's personal project has evolved into a versatile resource for creating comprehensive documentation sites, personal websites, blogs, and notably, for managing knowledge both within and outside of organizations.</p> <p>With almost 50,000 public GitHub projects depending on Material for MkDocs, it's clear that the framework has made a substantial impact. Tens of thousands of authors rely on us to deliver documentation to millions of users each month.<sup>1</sup> Beyond its adoption by many popular Open Source projects, Material for MkDocs is trusted and financially supported by major corporations such as AWS, Microsoft, and Siemens, among many other companies and individuals. We're very grateful for the continued support we receive, which allows us to devote our time to this project, making writing documentation enjoyable.</p> <p>Our users particularly appreciate Material for MkDocs for its ease of use and straightforward setup. It simplifies the process by handling the complexities of web technologies for you, so you can build a production-ready static site in minutes without needing to invest years into mastering frontend development or JavaScript. This makes it accessible to a wide range of users, regardless of their technical background. Additionally, Material for MkDocs is MIT-licensed and free to use, which has contributed to its widespread adoption, and allows everybody to build sophisticated documentation sites at no cost.</p> <p>Our vision is to provide you with the tools that allow you to own your docs, enable you to develop your own processes for producing amazing documentation and to avoid being locked into costly subscription services even for doing simple things. We believe it is important that these tools should be easy to set up and configure to suit your needs but should also give you the freedom to adapt them further, if needed. This is why we are always striving to ensure our architectures are modular and future-proof.<sup>2</sup></p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#challenges","title":"Challenges","text":"<p>Now, let's talk about our journey and the particular challenges we're addressing. With \"we\", we're referring to the incredible team that @squidfunk was fortunate to build around his original work, thanks to the financial support he receives from his sponsors. This remarkable team includes @alexvoss and @katharinalisalin, whose invaluable contributions in research, development, and community support have been essential to the project's ongoing success.</p> <p>Together, we've started exploring new technologies, incorporating the feedback we received from our users, and rethinking critical components from first principles, serving our growing community one of the best frameworks to create documentation.</p> <p>This section highlights the key areas we've been focusing on.</p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#search-and-discovery","title":"Search and discovery","text":"<p>From our perspective, search is a cornerstone of any effective documentation site, enabling users to swiftly locate the information they need. From the start, we've relied on Lunr.js, a popular client-side search library that has streamlined the deployment of documentation sites without needing an external service. Over the years, Lunr.js has served us well by answering millions of queries on sites built with Material for MkDocs. Yet, as our users' needs evolved, we encountered limitations that proved difficult to overcome.</p> <p>We learned that the BM25 ranking algorithm at the core of Lunr.js (as in many other search implementations) isn't well-suited for effective and stable typeahead. Adding new documents can influence existing rankings, requiring manual adjustments<sup>3</sup> that are cumbersome and hard to scale. Furthermore, Lunr.js has performance issues that stem from its design not fully leveraging modern JavaScript engines and optimizations, making it slower and memory-intensive.<sup>4</sup></p> <p>Over the last years, we've invested substantially into improving the search experience. For instance, expanding Lunr.js' functionality to add support for rich search previews and tokenizer lookahead demanded substantial engineering effort. Lunr.js allows to customize tasks such as stemming, stopword filtering, and trimming with pipeline functions, but it makes it particularly hard to add extensions like term highlighting or alternative ranking methods. Compounded by the fact that Lunr.js has been unmaintained since 2020, it became clear that we needed to find a more powerful solution. We've looked at alternative JavaScript-based libraries to keep our client-side search, but none met our requirements or lived up to our expectations.</p> <p>To address these challenges, we've embarked on developing a new search system from first principles that not only matches but already exceeds the capabilities of Lunr.js. Built from the ground up, this system is faster, more compact, and most importantly: modular. It is based on a growing core evolving around two core concepts we isolated to be essential \u2013 engines and plugins \u2013 allowing for flexible configuration and assembly of components like text indexing, vector embeddings, filtering, ranking, highlighting, and more. Every part of it can be replaced or extended, enabling users to tailor the search system to their specific needs.</p> <p>Our new search system, which we will release as a separate MIT-licensed Open Source project, is designed to handle a wide range of scenarios \u2014 from small blogs to large documentation projects. Of course, it supports offline use and integrates seamlessly with both client and server environments. The advanced ranking system provides fine-tuned control, and integration with third-party services is now more straightforward.</p> <p>:octicons-goal-16: Goal \u2013 Empower users to quickly find the information they need while freeing authors from managing external services, by providing a search system that adapts to diverse content types.</p> <p>You might wonder why it's not yet available. The process of developing this system from scratch and uncovering its potential has led us to re-evaluate core concepts of Material for MkDocs. As a result, we've decided to postpone the release of the new search system to integrate it into the broader update that we've started to work on. If you keep on reading, you'll learn about further reasons why we've decided to follow this approach.</p> <p>We're excited to share more details about this update in one of the next posts in this series.</p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#translations-and-versioning","title":"Translations and versioning","text":"<p>Supporting multi-language sites in MkDocs is the most requested feature on our discussion board and in conversations with users, yet it presents significant challenges, as MkDocs does not natively support it. The same applies to versioning, which also involves synchronisation of multi-project builds. While the MkDocs ecosystem has developed various plugins and tools to address these issues, there is still substantial untapped potential. We began exploring these areas but quickly encountered problems that hindered our progress.</p> <p>As you may know, our initial effort involved the projects plugin that aims to extend MkDocs to add support for multi-project environments as a solid foundation to support multi-language sites and versioning. Unfortunately, we encountered significant challenges due to MkDocs' internal architecture and design constraints, which we're working actively on resolving.<sup>5</sup></p> <p>:octicons-goal-16: Goal \u2013 Enable scaling documentation to any size or team structure by offering seamless methods for integrating multiple documentation projects, whether they involve different languages, versions, or distinct sections of an overall body of work.</p> <p>As a result, we are developing a new approach to offer a more comprehensive and robust solution for both multi-language support and versioning. This new approach also intersects with adjacent functionalities like search, as many of our users are interested in federated search capabilities that combine results from multiple documentation sites into a unified search interface. Overcoming this challenge is one of the major hurdles we need to address before releasing the new search system.</p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#editing-and-collaboration","title":"Editing and collaboration","text":"<p>We had considered developing a live editor in response to MkDocs' performance issues with large projects, which in most cases stem from compute-intensive plugins that don't employ caching. A proof of concept based on Pyodide (= running Python in the browser) generated significant interest among users and prompted many organizations and individuals to share their collaborative workflows for feedback. Sadly, implementing this live editor proved to be very challenging, as it would require rebuilding substantial parts of MkDocs.<sup>6</sup> After discontinuing work on this approach, our progress with multi-project support has renewed our belief that we can finally solve the sluggish editing experience that was reported several times over the last years.<sup>7</sup></p> <p>This brings us to collaboration, which wasn't initially on our list of priorities. However, throughout 2024, conversations with various organizations and maintainers of popular Open Source projects highlighted a frequent request for enhanced collaboration features. Many users expressed a need for capabilities that would allow non-technical team members to suggest and make changes to the documentation. We're genuinely grateful for this feedback, as it has come at a pivotal time. We recognize the need to streamline tracking and discussing changes, as well as to facilitate drive-by contributions.</p> <p>:octicons-goal-16: Goal \u2013 Everyone, regardless of their technical skill level, can easily work on and improve the documentation and contribute to a growing corpus of knowledge.<sup>9</sup></p> <p>This focus on collaboration aligns with how knowledge is managed in enterprises. In large organizations, documentation often exists in information silos \u2014 decentralized yet essential repositories of information. We understand the need to be able to unify these disparate sources into a coherent body of knowledge while preserving decentralized ownership. This also nicely aligns with our previously outlined work on multi-project support, as well as the new search system to implement federated search among multiple projects.</p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#large-language-models-llms","title":"Large Language Models (LLMs)","text":"<p>Almost a year ago, we introduced an experimental chatbot on our documentation site. It quickly became one of the most anticipated features, with users requesting the ability to deploy similar functionality on their own sites, underscoring the growing demand for interactive documentation tools. However, we found that adding to the myriad of existing chat solutions and simply building another thin wrapper on top of ChatGPT is nonsense.</p> <p>:octicons-goal-16: Goal \u2013 We're envisioning creating a unified interface that seamlessly integrates advanced search, chat, and summarization features, providing an interactive documentation experience.</p> <p>As we delved into this ambitious project, we gained valuable insights from user feedback. Users began interacting with the chatbot in their native languages, an outcome we hadn't anticipated given that our documentation is in English. Remarkably (or obviously to those that work on LLMs year round), the chatbot responded in the same language. This ability of LLMs is one of the genuinely exciting features of these machine learning models as it has the potential to improve the accessibility of the documentation. However, while we employed state-of-the-art RAG methodologies, the results were mixed, and occasional hallucinations surfaced.</p> <p>These experiences led us to prioritize enhancing our search capabilities before integrating LLM-based features. Building a search engine from scratch was already a substantial effort, and adding more complexity without a solid search foundation would be premature. By rearchitecting our search functionalities, we aim to create a robust platform that will seamlessly support advanced information retrieval and deliver a cohesive interactive documentation experience.</p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#team-transparency-and-growth","title":"Team, transparency, and growth","text":"<p>While we navigate the challenges and explore the opportunities of this project, we consider it essential to demonstrate how we're building a solid foundation for its continued growth and success. Please consider this an overview rather than a formal roadmap \u2014 our detailed plans are in the works. The goals we've highlighted represent the most impactful areas we aim to address.</p> <p>Thanks to the generous support from our sponsors, we're fortunate to be assembling a team capable of dedicating significant time and expertise to this endeavor. This newfound capacity allows us to delve deeper into core development while also engaging more comprehensively with our user community. A special mention goes to @kamilkrzyskow, one of our invaluable community experts, who has been essential in supporting users and fostering discussions on our platform.</p> <p>With the team's support, @squidfunk can concentrate on the heart of development, while we have begun investing in user research. This effort is helping us understand how organizations and individuals interact with our tools, guiding the project's future direction based on real feedback from numerous conversations with users and companies.</p> <p>Looking to expand our team further, we are committed to improving transparency and communication. Our previous work often happened behind the scenes due to time constraints, but we're now focused on making our processes more open and inviting for new contributors. By embracing this collaborative approach, we aim to enhance our tools and ensure they meet the evolving needs of our community.</p>"},{"location":"blog/2024/08/19/how-were-transforming-material-for-mkdocs/#whats-ahead-of-us","title":"What's ahead of us","text":"<p>As we look into the future, some of the groundwork we're laying now is crucial for the exciting developments on the horizon. Many of the initiatives we've discussed represent foundational work that will set the stage for much more ambitious and innovative features. Once these core elements are in place, we'll deliver a range of exciting new functionalities that align with our vision and goals.</p> <p>In the coming months, we'll be sharing more details about our plans and how they will contribute to our overarching objectives. While growth and innovation are at the forefront of our plans, we want to assure you that our core values remain unchanged. We are committed to maintaining the principles that have guided us thus far, ensuring that our growth is both healthy and consistent:</p> <ul> <li> <p>Against recent industry trends with companies moving away from core ideas of Open Source, we are doubling down on our commitment to Open Source because we believe it's at the heart of the value proposition of our work and the docs as code approach.</p> </li> <li> <p>Our organic approach to growth is part of this strategy as it keeps us independent of individual funding sources and pressures to provide a return on investment, which is what causes many other projects to turn away from the principles of Open Source.</p> </li> <li> <p>Likewise, we are driven by the needs of the community for a rich ecosystem of adaptations of the core framework. Extensibility and modularity are key for this and we are working hard to improve the developer experience by providing clear interfaces.</p> </li> </ul> <p>Stay tuned for updates as we continue to build on our progress and explore new possibilities. We're excited about the future and look forward to sharing more with you as we advance.</p> <p>Martin, Alex and Kathi :octicons-heart-fill-24:{ .mdx-heart .mdx-insiders }</p> <ol> <li> <p>We've collected invaluable feedback from enterprises and other Open Source maintainers, which revealed that the actual numbers are even higher. Many organizations leverage the framework within private infrastructures, such as self-hosted platforms like GitLab, for internal knowledge management. This suggests that the true reach of Material for MkDocs extends far beyond what is publicly visible.\u00a0\u21a9</p> </li> <li> <p>The built-in plugins that Material for MkDocs ships perfectly outline this principle, as they are complementary to each other and can be used in combination to build sophisticated pipelines. This modular design allows users to pick and choose the features they need, ensuring that the framework remains lightweight and flexible.</p> <p>For instance, the privacy plugin can work together with the optimize plugin so that external assets can be passed through the same optimization pipeline as the rest of your documentation. This means you can store and edit unoptimized files outside of your repository, and let both plugins automatically build an optimized site for you.\u00a0\u21a9</p> </li> <li> <p>Boosting documents in BM25 can lead to challenges, particularly with a changing corpus of documents. Relevance is calculated based on term frequency and the importance of terms across the entire corpus. Boosting a document involves adjusting its weight to make it more prominent in search results.</p> <p>As new documents are added or existing ones are modified, the overall distribution of term frequencies and their importance can shift. This recalibration can diminish the effectiveness of the boost, making it harder to maintain consistent ranking across a changing dataset. Essentially, the boosted documents may not stay as prominent or relevant as intended, leading to imbalances and scalability issues in search results.\u00a0\u21a9</p> </li> <li> <p>Lunr.js uses JavaScript objects to index and manage search data, which introduces inefficiencies due to how JavaScript engines handle object operations. JavaScript engines optimize performance using techniques like inline caching and object shape optimization. However, these optimizations rely on predictable and consistent object structures.</p> <p>The dynamic nature of Lunr.js' indexing \u2014 where documents can have varying structures \u2014 prevents the engine from applying these optimizations effectively. This means that while JavaScript engines can optimize for fixed, predictable object structures, they struggle with the polymorphic and fluid nature of Lunr.js's indexing, leading to performance issues as the amount of data grows.\u00a0\u21a9</p> </li> <li> <p>When developing the projects plugin, we initially made good progress, including adding support for nested projects and allowing for a tree structure where sub-projects can have further sub-projects. However, we quickly encountered difficulties, particularly with cross-project navigation. To illustrate, imagine that each project can link to any other project, which makes handling these interconnections complex, especially when dealing with circular dependencies \u2014 such as Project A linking to Project B and vice versa.</p> <p>Implementing multi-project support in MkDocs is particularly challenging due to the lack of an official programmatic API, which complicates efforts to extend its functionality. Moreover, resolving navigation issues before building projects is crucial for ensuring proper interconnectivity. These challenges combined made the development of the projects plugin a complex endeavor.\u00a0\u21a9</p> </li> <li> <p>Our proof of concept supported some features of Material for MkDocs but didn't cover them all. For instance, integrating support for icons or linking between documents would have necessitated reimplementing parts of MkDocs to bypass a full rebuild \u2014 something we obviously wanted to avoid. Additionally, certain links, such as those to blog posts generated from schemas, are not merely translated but computed dynamically, which means they cannot be inferred by replacing the <code>.md</code> extension with <code>.html</code>.\u00a0\u21a9</p> </li> <li> <p>After we raised this issue with the maintainers of MkDocs again<sup>8</sup>, and maintainership changed mid 2024, work on a ground-up rewrite that aims to address slow reloads by rendering only the page currently being built has started. It's still unclear how this rewrite will integrate with the requirements of existing plugins. Complex plugins such as mkdocstrings, or our built-in blog and tags plugins require a coordinated build of all pages to accurately resolve links between pages and to computed resources, which cannot be determined without building the entire project.</p> <p>Update: The new maintainer now publicly stated that he's working towards a new version of MkDocs that does not require or support plugins, and mentions it will be equally capable through offering customization via templating, themes, and styling, which he also mentioned to us and several other users in a team call on August 1. In this call, we raised objections multiple times in regards to how this will impact the ecosystem, to no avail. No intention or roadmap for plugin support was provided. This development is orthogonal to our goal empowering users and organizations to adapt the core framework to their requirements by the means of modularity. We're working on resolving this situation, and will provide a way forward for our community.\u00a0\u21a9</p> </li> <li> <p>Previously raised issues include #2418, #2384, and #1900.\u00a0\u21a9</p> </li> <li> <p>We are actively aligning our future development efforts to address this, recognizing it as a key area for improvement. While it's not something we can deliver immediately, we are committed to making this vision a reality in our work.\u00a0\u21a9</p> </li> </ol>"},{"location":"blog/2025/01/25/technical-indicators-v%E1%BB%9Bi-python---rsi-macd-bollinger-bands/","title":"Technical Indicators v\u1edbi Python","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a trading v\u00e0 ph\u00e2n t\u00edch k\u1ef9 thu\u1eadt, technical indicators \u0111\u00f3ng vai tr\u00f2 nh\u01b0 nh\u1eefng c\u00f4ng c\u1ee5 kh\u00f4ng th\u1ec3 thi\u1ebfu gi\u00fap c\u00e1c nh\u00e0 giao d\u1ecbch \u0111\u1ecdc hi\u1ec3u v\u00e0 d\u1ef1 \u0111o\u00e1n xu h\u01b0\u1edbng c\u1ee7a th\u1ecb tr\u01b0\u1eddng. Nh\u1eefng ch\u1ec9 b\u00e1o n\u00e0y kh\u00f4ng ch\u1ec9 gi\u00fap ch\u00fang ta x\u00e1c \u0111\u1ecbnh c\u00e1c \u0111i\u1ec3m v\u00e0o l\u1ec7nh v\u00e0 tho\u00e1t l\u1ec7nh t\u1ed1i \u01b0u, m\u00e0 c\u00f2n cung c\u1ea5p nh\u1eefng t\u00edn hi\u1ec7u v\u1ec1 s\u1ee9c m\u1ea1nh c\u1ee7a xu h\u01b0\u1edbng, m\u1ee9c \u0111\u1ed9 qu\u00e1 mua/qu\u00e1 b\u00e1n c\u1ee7a th\u1ecb tr\u01b0\u1eddng, v\u00e0 c\u00e1c m\u1eabu h\u00ecnh c\u00f3 th\u1ec3 d\u1eabn \u0111\u1ebfn s\u1ef1 \u0111\u1ea3o chi\u1ec1u. T\u1eeb RSI (Relative Strength Index) gi\u00fap \u0111o l\u01b0\u1eddng momentum, MACD (Moving Average Convergence Divergence) \u0111\u1ec3 ph\u00e1t hi\u1ec7n s\u1ef1 thay \u0111\u1ed5i trong xu h\u01b0\u1edbng, \u0111\u1ebfn Bollinger Bands cho ph\u00e9p \u0111\u00e1nh gi\u00e1 volatility, m\u1ed7i indicator \u0111\u1ec1u mang trong m\u00ecnh m\u1ed9t c\u00e2u chuy\u1ec7n ri\u00eang v\u1ec1 h\u00e0nh vi c\u1ee7a th\u1ecb tr\u01b0\u1eddng.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau implement c\u00e1c technical indicators ph\u1ed5 bi\u1ebfn nh\u1ea5t trong trading s\u1eed d\u1ee5ng Python - ng\u00f4n ng\u1eef l\u1eadp tr\u00ecnh \u0111\u01b0\u1ee3c \u01b0a chu\u1ed9ng nh\u1ea5t trong l\u0129nh v\u1ef1c quantitative finance v\u00e0 algorithmic trading. Ch\u00fang ta s\u1ebd kh\u00f4ng ch\u1ec9 h\u1ecdc c\u00e1ch t\u00ednh to\u00e1n c\u00e1c indicators t\u1eeb d\u1eef li\u1ec7u gi\u00e1 l\u1ecbch s\u1eed, m\u00e0 c\u00f2n hi\u1ec3u s\u00e2u v\u1ec1 \u00fd ngh\u0129a to\u00e1n h\u1ecdc v\u00e0 logic \u0111\u1eb1ng sau m\u1ed7i indicator, c\u00e1ch ch\u00fang \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong th\u1ef1c t\u1ebf, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 c\u00e1ch k\u1ebft h\u1ee3p nhi\u1ec1u indicators l\u1ea1i v\u1edbi nhau \u0111\u1ec3 t\u1ea1o ra c\u00e1c t\u00edn hi\u1ec7u trading m\u1ea1nh m\u1ebd v\u00e0 \u0111\u00e1ng tin c\u1eady h\u01a1n. Ch\u00fang ta s\u1ebd s\u1eed d\u1ee5ng c\u00e1c th\u01b0 vi\u1ec7n m\u1ea1nh m\u1ebd nh\u01b0 Pandas cho vi\u1ec7c x\u1eed l\u00fd d\u1eef li\u1ec7u, NumPy cho c\u00e1c ph\u00e9p t\u00ednh to\u00e1n h\u1ecdc ph\u1ee9c t\u1ea1p, v\u00e0 Matplotlib/Plotly cho vi\u1ec7c visualization.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n implement t\u1eebng indicator m\u1ed9t c\u00e1ch chi ti\u1ebft, t\u1eeb c\u00f4ng th\u1ee9c to\u00e1n h\u1ecdc c\u01a1 b\u1ea3n \u0111\u1ebfn code Python ho\u00e0n ch\u1ec9nh, c\u00f9ng v\u1edbi c\u00e1c v\u00ed d\u1ee5 th\u1ef1c t\u1ebf v\u1ec1 c\u00e1ch s\u1eed d\u1ee5ng ch\u00fang trong trading strategies. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c best practices nh\u01b0 c\u00e1ch ch\u1ecdn parameters ph\u00f9 h\u1ee3p, tr\u00e1nh overfitting, v\u00e0 c\u00e1ch k\u1ebft h\u1ee3p c\u00e1c indicators \u0111\u1ec3 t\u1ea1o ra c\u00e1c h\u1ec7 th\u1ed1ng trading robust. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t b\u1ed9 c\u00f4ng c\u1ee5 \u0111\u1ea7y \u0111\u1ee7 \u0111\u1ec3 ph\u00e2n t\u00edch k\u1ef9 thu\u1eadt v\u00e0 x\u00e2y d\u1ef1ng c\u00e1c trading strategies d\u1ef1a tr\u00ean technical indicators m\u1ed9t c\u00e1ch chuy\u00ean nghi\u1ec7p.</p> <p></p>"},{"location":"blog/2025/01/25/technical-indicators-v%E1%BB%9Bi-python---rsi-macd-bollinger-bands/#cac-indicators-pho-bien","title":"C\u00e1c Indicators ph\u1ed5 bi\u1ebfn","text":"<ol> <li>RSI - Relative Strength Index</li> <li>MACD - Moving Average Convergence Divergence</li> <li>Bollinger Bands</li> <li>Moving Averages</li> <li>Stochastic Oscillator</li> </ol>"},{"location":"blog/2025/01/25/technical-indicators-v%E1%BB%9Bi-python---rsi-macd-bollinger-bands/#buoc-1-rsi-implementation","title":"B\u01b0\u1edbc 1: RSI Implementation","text":"<pre><code># indicators/rsi.py\nimport pandas as pd\nimport numpy as np\n\ndef calculate_rsi(prices: pd.Series, period: int = 14) -&gt; pd.Series:\n    \"\"\"Calculate RSI\"\"\"\n    delta = prices.diff()\n\n    gain = (delta.where(delta &gt; 0, 0)).rolling(window=period).mean()\n    loss = (-delta.where(delta &lt; 0, 0)).rolling(window=period).mean()\n\n    rs = gain / loss\n    rsi = 100 - (100 / (1 + rs))\n\n    return rsi\n</code></pre>"},{"location":"blog/2025/01/25/technical-indicators-v%E1%BB%9Bi-python---rsi-macd-bollinger-bands/#buoc-2-macd-implementation","title":"B\u01b0\u1edbc 2: MACD Implementation","text":"<pre><code># indicators/macd.py\ndef calculate_macd(prices: pd.Series, fast: int = 12, slow: int = 26, signal: int = 9):\n    \"\"\"Calculate MACD\"\"\"\n    ema_fast = prices.ewm(span=fast).mean()\n    ema_slow = prices.ewm(span=slow).mean()\n\n    macd = ema_fast - ema_slow\n    signal_line = macd.ewm(span=signal).mean()\n    histogram = macd - signal_line\n\n    return macd, signal_line, histogram\n</code></pre>"},{"location":"blog/2025/01/25/technical-indicators-v%E1%BB%9Bi-python---rsi-macd-bollinger-bands/#buoc-3-bollinger-bands","title":"B\u01b0\u1edbc 3: Bollinger Bands","text":"<pre><code># indicators/bollinger.py\ndef calculate_bollinger_bands(prices: pd.Series, period: int = 20, std_dev: int = 2):\n    \"\"\"Calculate Bollinger Bands\"\"\"\n    sma = prices.rolling(window=period).mean()\n    std = prices.rolling(window=period).std()\n\n    upper_band = sma + (std * std_dev)\n    lower_band = sma - (std * std_dev)\n\n    return upper_band, sma, lower_band\n</code></pre>"},{"location":"blog/2025/01/25/technical-indicators-v%E1%BB%9Bi-python---rsi-macd-bollinger-bands/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>Technical indicators gi\u00fap: - Identify trends - Find entry/exit points - Manage risk - Improve trading decisions</p> <p>Use indicators wisely in your strategies!</p>"},{"location":"blog/2025/01/25/websocket-api-cho-trading---real-time-data-streaming/","title":"WebSocket API cho Trading","text":"<p>Trong th\u1ebf gi\u1edbi c\u1ee7a algorithmic trading v\u00e0 real-time market data processing, t\u1ed1c \u0111\u1ed9 v\u00e0 \u0111\u1ed9 tr\u1ec5 (latency) l\u00e0 nh\u1eefng y\u1ebfu t\u1ed1 quy\u1ebft \u0111\u1ecbnh th\u00e0nh c\u00f4ng. Trong khi REST API truy\u1ec1n th\u1ed1ng ho\u1ea1t \u0111\u1ed9ng theo m\u00f4 h\u00ecnh request-response v\u1edbi overhead l\u1edbn v\u00e0 \u0111\u1ed9 tr\u1ec5 cao, WebSocket API cung c\u1ea5p m\u1ed9t k\u00eanh giao ti\u1ebfp real-time, bidirectional, v\u00e0 hi\u1ec7u qu\u1ea3 h\u01a1n r\u1ea5t nhi\u1ec1u. V\u1edbi WebSocket, ch\u00fang ta c\u00f3 th\u1ec3 thi\u1ebft l\u1eadp m\u1ed9t k\u1ebft n\u1ed1i persistent gi\u1eefa client v\u00e0 server, cho ph\u00e9p server push d\u1eef li\u1ec7u \u0111\u1ebfn client ngay l\u1eadp t\u1ee9c khi c\u00f3 thay \u0111\u1ed5i, m\u00e0 kh\u00f4ng c\u1ea7n client ph\u1ea3i li\u00ean t\u1ee5c polling. \u0110i\u1ec1u n\u00e0y \u0111\u1eb7c bi\u1ec7t quan tr\u1ecdng trong trading, n\u01a1i m\u00e0 m\u1ed7i mili gi\u00e2y \u0111\u1ec1u c\u00f3 gi\u00e1 tr\u1ecb v\u00e0 vi\u1ec7c nh\u1eadn \u0111\u01b0\u1ee3c th\u00f4ng tin gi\u00e1 m\u1edbi nh\u1ea5t c\u00f3 th\u1ec3 quy\u1ebft \u0111\u1ecbnh th\u00e0nh b\u1ea1i c\u1ee7a m\u1ed9t giao d\u1ecbch.</p> <p>Trong b\u00e0i vi\u1ebft chi ti\u1ebft n\u00e0y, ch\u00fang ta s\u1ebd c\u00f9ng nhau x\u00e2y d\u1ef1ng m\u1ed9t WebSocket API ho\u00e0n ch\u1ec9nh cho trading systems, s\u1eed d\u1ee5ng FastAPI - m\u1ed9t framework Python hi\u1ec7n \u0111\u1ea1i, nhanh ch\u00f3ng, v\u00e0 \u0111\u01b0\u1ee3c thi\u1ebft k\u1ebf \u0111\u1eb7c bi\u1ec7t cho vi\u1ec7c x\u00e2y d\u1ef1ng APIs. Ch\u00fang ta s\u1ebd h\u1ecdc c\u00e1ch thi\u1ebft l\u1eadp WebSocket connections, qu\u1ea3n l\u00fd nhi\u1ec1u clients \u0111\u1ed3ng th\u1eddi, x\u1eed l\u00fd c\u00e1c message types kh\u00e1c nhau, implement authentication v\u00e0 authorization, v\u00e0 quan tr\u1ecdng nh\u1ea5t l\u00e0 x\u00e2y d\u1ef1ng m\u1ed9t h\u1ec7 th\u1ed1ng c\u00f3 kh\u1ea3 n\u0103ng scale \u0111\u1ec3 x\u1eed l\u00fd h\u00e0ng ngh\u00ecn connections c\u00f9ng l\u00fac. Ch\u00fang ta c\u0169ng s\u1ebd th\u1ea3o lu\u1eadn v\u1ec1 c\u00e1c patterns nh\u01b0 pub/sub \u0111\u1ec3 broadcast market data \u0111\u1ebfn nhi\u1ec1u clients, connection pooling, heartbeat mechanisms \u0111\u1ec3 detect v\u00e0 x\u1eed l\u00fd dead connections, v\u00e0 error handling robust.</p> <p>B\u00e0i vi\u1ebft n\u00e0y s\u1ebd h\u01b0\u1edbng d\u1eabn b\u1ea1n t\u1eebng b\u01b0\u1edbc m\u1ed9t, t\u1eeb vi\u1ec7c setup FastAPI v\u1edbi WebSocket support, implement connection manager \u0111\u1ec3 track v\u00e0 qu\u1ea3n l\u00fd c\u00e1c active connections, x\u00e2y d\u1ef1ng message handlers cho c\u00e1c lo\u1ea1i message kh\u00e1c nhau (subscribe, unsubscribe, trade execution, etc.), \u0111\u1ebfn vi\u1ec7c t\u00edch h\u1ee3p v\u1edbi trading bot v\u00e0 market data providers. Ch\u00fang ta c\u0169ng s\u1ebd h\u1ecdc c\u00e1ch test WebSocket APIs, monitor performance, v\u00e0 implement c\u00e1c security best practices. Cu\u1ed1i c\u00f9ng, b\u1ea1n s\u1ebd c\u00f3 trong tay m\u1ed9t WebSocket API m\u1ea1nh m\u1ebd, c\u00f3 th\u1ec3 stream real-time trading data v\u00e0 execute trades v\u1edbi \u0111\u1ed9 tr\u1ec5 c\u1ef1c th\u1ea5p.</p>"},{"location":"blog/2025/01/25/websocket-api-cho-trading---real-time-data-streaming/#websocket-vs-rest","title":"WebSocket vs REST","text":"<ul> <li>REST: Request-response, stateless</li> <li>WebSocket: Persistent connection, bidirectional, real-time</li> </ul>"},{"location":"blog/2025/01/25/websocket-api-cho-trading---real-time-data-streaming/#implementation","title":"Implementation","text":"<pre><code># api/websocket_api.py\nfrom fastapi import FastAPI, WebSocket, WebSocketDisconnect\nfrom typing import List, Dict\nimport json\nimport asyncio\n\napp = FastAPI()\n\nclass ConnectionManager:\n    \"\"\"Manage WebSocket connections\"\"\"\n\n    def __init__(self):\n        self.active_connections: List[WebSocket] = []\n        self.subscriptions: Dict[WebSocket, List[str]] = {}\n\n    async def connect(self, websocket: WebSocket):\n        await websocket.accept()\n        self.active_connections.append(websocket)\n        self.subscriptions[websocket] = []\n\n    def disconnect(self, websocket: WebSocket):\n        if websocket in self.active_connections:\n            self.active_connections.remove(websocket)\n        if websocket in self.subscriptions:\n            del self.subscriptions[websocket]\n\n    async def send_personal_message(self, message: str, websocket: WebSocket):\n        await websocket.send_text(message)\n\n    async def broadcast(self, message: str, symbol: str = None):\n        for connection in self.active_connections:\n            if symbol is None or symbol in self.subscriptions.get(connection, []):\n                try:\n                    await connection.send_text(message)\n                except:\n                    self.disconnect(connection)\n\nmanager = ConnectionManager()\n\n@app.websocket(\"/ws/ticker\")\nasync def websocket_ticker(websocket: WebSocket):\n    await manager.connect(websocket)\n    try:\n        while True:\n            data = await websocket.receive_text()\n            message = json.loads(data)\n\n            if message.get('action') == 'subscribe':\n                symbol = message.get('symbol')\n                manager.subscriptions[websocket].append(symbol)\n                await manager.send_personal_message(\n                    json.dumps({'status': 'subscribed', 'symbol': symbol}),\n                    websocket\n                )\n    except WebSocketDisconnect:\n        manager.disconnect(websocket)\n</code></pre>"},{"location":"blog/2025/01/25/websocket-api-cho-trading---real-time-data-streaming/#ket-luan","title":"K\u1ebft lu\u1eadn","text":"<p>WebSocket APIs enable real-time trading data streaming!</p>"},{"location":"python/","title":"Python","text":"<p>huong dan su dung python</p>"},{"location":"python/pandas/","title":"Pandas","text":"<p>noi dung huong dan pandas</p> <pre><code>class Demo:\n    pass\n\n\ndf.pivot(index='Name', columns='Year', values='Salary')\ndf.pivot_table(values='Salary', index='Dept', columns='Year', aggfunc='mean', fill_value=0)\n\nif __name__ == '__main__':\n    pass\n</code></pre>"},{"location":"python/python-core/","title":"Python core","text":""},{"location":"python/python-core/#sn-for-model","title":"SN for Model","text":"<pre><code>from types import SimpleNamespace as sn\n\nmodel = sn()\n\nmode.id = 1\nmode.age = 10\nmode.name = 'demo name'\n\n\nprint(model)\n</code></pre>"},{"location":"resources/nssm/","title":"nssm","text":"<pre><code>nssm install soigia C:\\python\\python.exe C:\\apps\\soigia.py\n</code></pre>"},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/category/algorithmic-trading/","title":"Algorithmic Trading","text":""},{"location":"blog/category/backend-development/","title":"Backend Development","text":""},{"location":"blog/category/trading-infrastructure/","title":"Trading Infrastructure","text":""},{"location":"blog/category/performance/","title":"Performance","text":""},{"location":"blog/category/case-study/","title":"Case Study","text":""},{"location":"blog/category/backtesting/","title":"Backtesting","text":""},{"location":"blog/category/data-engineering/","title":"Data Engineering","text":""},{"location":"blog/category/visualization/","title":"Visualization","text":""},{"location":"blog/category/database-design/","title":"Database Design","text":""},{"location":"blog/category/trading/","title":"Trading","text":""},{"location":"blog/category/api-integration/","title":"API Integration","text":""},{"location":"blog/category/system-architecture/","title":"System Architecture","text":""},{"location":"blog/category/technical-analysis/","title":"Technical Analysis","text":""},{"location":"blog/category/machine-learning/","title":"Machine Learning","text":""},{"location":"blog/category/api-development/","title":"API Development","text":""},{"location":"blog/category/risk-management/","title":"Risk Management","text":""},{"location":"blog/category/python/","title":"Python","text":""},{"location":"blog/category/real-time-systems/","title":"Real-time Systems","text":""},{"location":"blog/category/general/","title":"General","text":""},{"location":"blog/page/2/","title":"Blog","text":""},{"location":"blog/archive/2025/page/2/","title":"2025","text":""}]}